\hypertarget{zero__padding__inv__dble__cmplx_8f}{}\doxysection{C\+:/\+Users/\+Owner/\+Education and Research/\+Graduate School/\+Parallelization Module Project/\+E\+Z\+\_\+\+P\+A\+R\+A\+L\+L\+E\+L\+\_\+project/\+E\+Z\+\_\+\+P\+A\+R\+A\+L\+L\+E\+L/zero\+\_\+padding\+\_\+inv\+\_\+dble\+\_\+cmplx.f File Reference}
\label{zero__padding__inv__dble__cmplx_8f}\index{C:/Users/Owner/Education and Research/Graduate School/Parallelization Module Project/EZ\_PARALLEL\_project/EZ\_PARALLEL/zero\_padding\_inv\_dble\_cmplx.f@{C:/Users/Owner/Education and Research/Graduate School/Parallelization Module Project/EZ\_PARALLEL\_project/EZ\_PARALLEL/zero\_padding\_inv\_dble\_cmplx.f}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{zero__padding__inv__dble__cmplx_8f_ac071011cbdba5faa1f193641174ac106}{zero\+\_\+padding\+\_\+inv\+\_\+dble\+\_\+cmplx\+\_\+ezp}} (dim1\+\_\+len, dim2\+\_\+len, matrix, scl\+\_\+dim1\+\_\+len, scl\+\_\+dim2\+\_\+len, scaled\+\_\+matrix, overlap)
\item 
subroutine \mbox{\hyperlink{zero__padding__inv__dble__cmplx_8f_ad50c8135506cbb826872be25c41cfd3b}{serial}} (dim1\+\_\+len, dim2\+\_\+len, matrix, scl\+\_\+dim1\+\_\+len, scl\+\_\+dim2\+\_\+len, scaled\+\_\+matrix)
\item 
subroutine \mbox{\hyperlink{zero__padding__inv__dble__cmplx_8f_a1abd848612c69c336fc6e846cc155bdf}{parallel}} (dim1\+\_\+len, dim2\+\_\+len, matrix, scl\+\_\+dim1\+\_\+len, scl\+\_\+dim2\+\_\+len, scaled\+\_\+matrix, overlap, proc\+\_\+id, proc\+\_\+count)
\item 
subroutine \mbox{\hyperlink{zero__padding__inv__dble__cmplx_8f_a4bad50919c5981674a49998c405a646d}{error\+\_\+handling}} (proc\+\_\+id)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{zero__padding__inv__dble__cmplx_8f_a4bad50919c5981674a49998c405a646d}\label{zero__padding__inv__dble__cmplx_8f_a4bad50919c5981674a49998c405a646d}} 
\index{zero\_padding\_inv\_dble\_cmplx.f@{zero\_padding\_inv\_dble\_cmplx.f}!error\_handling@{error\_handling}}
\index{error\_handling@{error\_handling}!zero\_padding\_inv\_dble\_cmplx.f@{zero\_padding\_inv\_dble\_cmplx.f}}
\doxysubsubsection{\texorpdfstring{error\_handling()}{error\_handling()}}
{\footnotesize\ttfamily subroutine zero\+\_\+padding\+\_\+inv\+\_\+dble\+\_\+cmplx\+\_\+ezp\+::error\+\_\+handling (\begin{DoxyParamCaption}\item[{integer}]{proc\+\_\+id }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{499 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{500 }
\DoxyCodeLine{501 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{502 }
\DoxyCodeLine{503 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{504 }
\DoxyCodeLine{505 \textcolor{keywordtype}{INTEGER} :: proc\_id}
\DoxyCodeLine{506 \textcolor{keywordtype}{LOGICAL} :: proc\_err\_flag, \&}
\DoxyCodeLine{507 \& global\_err\_flag}
\DoxyCodeLine{508 }
\DoxyCodeLine{509 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{510 }
\DoxyCodeLine{511 proc\_err\_flag = .false.}
\DoxyCodeLine{512 global\_err\_flag = .false.}
\DoxyCodeLine{513 }
\DoxyCodeLine{514 \textcolor{comment}{! error 1.}}
\DoxyCodeLine{515 \textcolor{comment}{!IF (error1) THEN}}
\DoxyCodeLine{516 \textcolor{comment}{!  proc\_err\_flag = .TRUE.}}
\DoxyCodeLine{517 \textcolor{comment}{!  PRINT *, 'EZ\_PARALLEL: Issue with processor ', proc\_id, ' in subroutine ', \&}}
\DoxyCodeLine{518 \textcolor{comment}{!  \& 'call SUBROUTINE\_NAME. order: ', order, ' is less ', \&}}
\DoxyCodeLine{519 \textcolor{comment}{!  \& 'than 1. Please increase the order.'}}
\DoxyCodeLine{520 \textcolor{comment}{!END IF}}
\DoxyCodeLine{521 }
\DoxyCodeLine{522 \textcolor{comment}{! STOP all processors if any encounter an error.}}
\DoxyCodeLine{523 \textcolor{keyword}{CALL }mpi\_allreduce(proc\_err\_flag, global\_err\_flag, 1, mpi\_logical, mpi\_lor, \&}
\DoxyCodeLine{524 \& mpi\_comm\_world, ierror)}
\DoxyCodeLine{525 }
\DoxyCodeLine{526 \textcolor{keywordflow}{IF} (global\_err\_flag) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{527   \textcolor{keyword}{CALL }mpi\_finalize(ierror)}
\DoxyCodeLine{528   stop}
\DoxyCodeLine{529 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{530 }
\DoxyCodeLine{531 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{532 }

\end{DoxyCode}
\mbox{\Hypertarget{zero__padding__inv__dble__cmplx_8f_a1abd848612c69c336fc6e846cc155bdf}\label{zero__padding__inv__dble__cmplx_8f_a1abd848612c69c336fc6e846cc155bdf}} 
\index{zero\_padding\_inv\_dble\_cmplx.f@{zero\_padding\_inv\_dble\_cmplx.f}!parallel@{parallel}}
\index{parallel@{parallel}!zero\_padding\_inv\_dble\_cmplx.f@{zero\_padding\_inv\_dble\_cmplx.f}}
\doxysubsubsection{\texorpdfstring{parallel()}{parallel()}}
{\footnotesize\ttfamily subroutine zero\+\_\+padding\+\_\+inv\+\_\+dble\+\_\+cmplx\+\_\+ezp\+::parallel (\begin{DoxyParamCaption}\item[{integer}]{dim1\+\_\+len,  }\item[{integer}]{dim2\+\_\+len,  }\item[{double complex, dimension(\mbox{\hyperlink{cfft2df__unit__test__MATLAB_8m_acb4b6a591c5ad6fc207ef543dc74d1ae}{dim1\+\_\+len}},\mbox{\hyperlink{cfft2df__unit__test__MATLAB_8m_adef80e51b1bb5916dd9410de399f1319}{dim2\+\_\+len}})}]{matrix,  }\item[{integer}]{scl\+\_\+dim1\+\_\+len,  }\item[{integer}]{scl\+\_\+dim2\+\_\+len,  }\item[{double complex, dimension(scl\+\_\+dim1\+\_\+len, scl\+\_\+dim2\+\_\+len)}]{scaled\+\_\+matrix,  }\item[{integer}]{overlap,  }\item[{integer}]{proc\+\_\+id,  }\item[{integer}]{proc\+\_\+count }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{181 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{182 }
\DoxyCodeLine{183 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{184 }
\DoxyCodeLine{185 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{186 }
\DoxyCodeLine{187 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{188 \& dim2\_len, \&}
\DoxyCodeLine{189 \& scl\_dim1\_len, \&}
\DoxyCodeLine{190 \& scl\_dim2\_len, \&}
\DoxyCodeLine{191 \& overlap, \&}
\DoxyCodeLine{192 \& proc\_id, \&}
\DoxyCodeLine{193 \& proc\_count, \&}
\DoxyCodeLine{194 \& ierror, \&}
\DoxyCodeLine{195 \& dim1\_len\_dim1\_slice, \&}
\DoxyCodeLine{196 \& dim2\_len\_dim1\_slice, \&}
\DoxyCodeLine{197 \& dim1\_len\_dim2\_slice, \&}
\DoxyCodeLine{198 \& dim2\_len\_dim2\_slice, \&}
\DoxyCodeLine{199 \& dim1\_len\_scl\_dim1\_slice, \&}
\DoxyCodeLine{200 \& dim2\_len\_scl\_dim1\_slice, \&}
\DoxyCodeLine{201 \& dim1\_len\_scl\_dim2\_slice, \&}
\DoxyCodeLine{202 \& dim2\_len\_scl\_dim2\_slice, \&}
\DoxyCodeLine{203 \& scl\_dim1\_slice\_pos\_wvnm\_low\_ind, \&}
\DoxyCodeLine{204 \& scl\_dim1\_slice\_pos\_wvnm\_high\_ind, \&}
\DoxyCodeLine{205 \& scl\_dim1\_slice\_neg\_wvnm\_low\_ind, \&}
\DoxyCodeLine{206 \& scl\_dim1\_slice\_neg\_wvnm\_high\_ind, \&}
\DoxyCodeLine{207 \& scl\_dim2\_slice\_pos\_wvnm\_low\_ind, \&}
\DoxyCodeLine{208 \& scl\_dim2\_slice\_pos\_wvnm\_high\_ind, \&}
\DoxyCodeLine{209 \& scl\_dim2\_slice\_neg\_wvnm\_low\_ind, \&}
\DoxyCodeLine{210 \& scl\_dim2\_slice\_neg\_wvnm\_high\_ind, \&}
\DoxyCodeLine{211 \& fill\_in\_proc\_trgt, \&}
\DoxyCodeLine{212 \& i, \&}
\DoxyCodeLine{213 \& j, \&}
\DoxyCodeLine{214 \& status(MPI\_STATUS\_SIZE), \&}
\DoxyCodeLine{215 \& dim1\_low\_index\_dim1\_slice, \&}
\DoxyCodeLine{216 \& dim1\_high\_index\_dim1\_slice, \&}
\DoxyCodeLine{217 \& dim2\_low\_index\_dim2\_slice, \&}
\DoxyCodeLine{218 \& dim2\_high\_index\_dim2\_slice}
\DoxyCodeLine{219 \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(proc\_count)} :: dim1\_len\_scl\_dim2\_slice\_list, \&}
\DoxyCodeLine{220 \& dim1\_len\_dim2\_slice\_list, \&}
\DoxyCodeLine{221 \& dim2\_len\_dim1\_slice\_list}
\DoxyCodeLine{222 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(dim1\_len,dim2\_len)} :: matrix}
\DoxyCodeLine{223 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{ALLOCATABLE} :: dim1\_slice, \&}
\DoxyCodeLine{224 \& dim2\_slice, \&}
\DoxyCodeLine{225 \& scl\_dim1\_slice, \&}
\DoxyCodeLine{226 \& scl\_dim2\_slice}
\DoxyCodeLine{227 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(scl\_dim1\_len, scl\_dim2\_len)} :: scaled\_matrix}
\DoxyCodeLine{228 }
\DoxyCodeLine{229 matrix = 0.0}
\DoxyCodeLine{230 \textcolor{comment}{! Obtain the size of the scl\_dim1\_slice (excluding overlap).}}
\DoxyCodeLine{231 dim1\_len\_scl\_dim1\_slice = scl\_dim1\_len}
\DoxyCodeLine{232 \textcolor{comment}{! Middle processor.}}
\DoxyCodeLine{233 \textcolor{keywordflow}{IF} (mod(proc\_id, proc\_count-\/1) .NE. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{234   dim2\_len\_scl\_dim1\_slice = scl\_dim2\_len -\/ 2 * overlap}
\DoxyCodeLine{235 \textcolor{comment}{! Processor 0 or proc\_count-\/1.}}
\DoxyCodeLine{236 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{237   dim2\_len\_scl\_dim1\_slice = scl\_dim2\_len -\/ overlap}
\DoxyCodeLine{238 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{239 \textcolor{comment}{! Obtain the scl\_dim1\_slice entries.}}
\DoxyCodeLine{240 \textcolor{keyword}{ALLOCATE}(scl\_dim1\_slice(dim1\_len\_scl\_dim1\_slice, dim2\_len\_scl\_dim1\_slice))}
\DoxyCodeLine{241 scl\_dim1\_slice = 0.0}
\DoxyCodeLine{242 \textcolor{comment}{! Processor 0, doesn't need last parts of dim2.}}
\DoxyCodeLine{243 \textcolor{keywordflow}{IF} (proc\_id .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{244   scl\_dim1\_slice = scaled\_matrix(:,1:scl\_dim2\_len-\/overlap)}
\DoxyCodeLine{245 \textcolor{comment}{! Last processor, doesn't need first part of dim2.}}
\DoxyCodeLine{246 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (proc\_id .EQ. proc\_count-\/1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{247   scl\_dim1\_slice = scaled\_matrix(:,overlap+1:scl\_dim2\_len)}
\DoxyCodeLine{248 \textcolor{comment}{! Middle processor, doesn't need first or last part of dim2.}}
\DoxyCodeLine{249 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{250   scl\_dim1\_slice = scaled\_matrix(:,overlap+1:scl\_dim2\_len-\/overlap)}
\DoxyCodeLine{251 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{252 }
\DoxyCodeLine{253 \textcolor{comment}{! Scale in the dim1 direction.}}
\DoxyCodeLine{254 dim1\_len\_dim1\_slice = dim1\_len}
\DoxyCodeLine{255 dim2\_len\_dim1\_slice = dim2\_len\_scl\_dim1\_slice}
\DoxyCodeLine{256 \textcolor{keyword}{ALLOCATE}(dim1\_slice(dim1\_len\_dim1\_slice, dim2\_len\_dim1\_slice))}
\DoxyCodeLine{257 dim1\_slice = 0.0}
\DoxyCodeLine{258 \textcolor{comment}{! Determine the indices of scl\_dim1\_slice that dim1\_slice entires go into.}}
\DoxyCodeLine{259 scl\_dim1\_slice\_pos\_wvnm\_low\_ind = 1}
\DoxyCodeLine{260 scl\_dim1\_slice\_pos\_wvnm\_high\_ind = dim1\_len\_dim1\_slice/2 + 1}
\DoxyCodeLine{261 scl\_dim1\_slice\_neg\_wvnm\_high\_ind = dim1\_len\_scl\_dim1\_slice}
\DoxyCodeLine{262 \textcolor{keywordflow}{IF} (mod(dim1\_len\_dim1\_slice, 2) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{263   scl\_dim1\_slice\_neg\_wvnm\_low\_ind = dim1\_len\_dim1\_slice + 2}
\DoxyCodeLine{264 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (mod(dim1\_len\_dim1\_slice, 2) .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{265   scl\_dim1\_slice\_neg\_wvnm\_low\_ind = dim1\_len\_dim1\_slice + 1}
\DoxyCodeLine{266 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{267 }
\DoxyCodeLine{268 \textcolor{comment}{! Fill in dim1\_slice.}}
\DoxyCodeLine{269 dim1\_slice(1:dim1\_len\_dim1\_slice/2 + 1,:) = scl\_dim1\_slice( \&}
\DoxyCodeLine{270   \& scl\_dim1\_slice\_pos\_wvnm\_low\_ind:scl\_dim1\_slice\_pos\_wvnm\_high\_ind,:)}
\DoxyCodeLine{271 dim1\_slice(dim1\_len\_dim1\_slice/2 + 2:dim1\_len\_dim1\_slice,:) = scl\_dim1\_slice( \&}
\DoxyCodeLine{272   \& scl\_dim1\_slice\_neg\_wvnm\_low\_ind:scl\_dim1\_slice\_neg\_wvnm\_high\_ind,:)}
\DoxyCodeLine{273 }
\DoxyCodeLine{274 \textcolor{comment}{! At this point, we've scaled down in dim1. Now we must do the same for dim2.}}
\DoxyCodeLine{275 \textcolor{comment}{! Obtain the size of scl\_dim2\_slice.}}
\DoxyCodeLine{276   \textcolor{comment}{! Divide scl\_dim1\_len as evenly as possible.}}
\DoxyCodeLine{277 dim1\_len\_scl\_dim2\_slice = dim1\_len/proc\_count}
\DoxyCodeLine{278 \textcolor{keywordflow}{DO} i = 1, proc\_count}
\DoxyCodeLine{279   \textcolor{keywordflow}{IF} ((i -\/ 1) .LT. mod(dim1\_len, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{280     dim1\_len\_scl\_dim2\_slice\_list(i) = dim1\_len\_scl\_dim2\_slice + 1}
\DoxyCodeLine{281   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{282     dim1\_len\_scl\_dim2\_slice\_list(i) = dim1\_len\_scl\_dim2\_slice}
\DoxyCodeLine{283 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{284 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{285 dim1\_len\_scl\_dim2\_slice = dim1\_len\_scl\_dim2\_slice\_list(proc\_id + 1)}
\DoxyCodeLine{286 \textcolor{keyword}{CALL }mpi\_allreduce(dim2\_len\_scl\_dim1\_slice, dim2\_len\_scl\_dim2\_slice, 1, \&}
\DoxyCodeLine{287 \& mpi\_integer, mpi\_sum, mpi\_comm\_world, ierror)}
\DoxyCodeLine{288 \textcolor{keyword}{ALLOCATE}(scl\_dim2\_slice(dim1\_len\_scl\_dim2\_slice, dim2\_len\_scl\_dim2\_slice))}
\DoxyCodeLine{289 scl\_dim2\_slice = 0.0}
\DoxyCodeLine{290 }
\DoxyCodeLine{291 \textcolor{comment}{! Obtain dim2\_len\_dim1\_slice\_list for use in filling in scl\_dim2\_slices.}}
\DoxyCodeLine{292 dim2\_len\_dim1\_slice = dim2\_len\_scl\_dim2\_slice/proc\_count}
\DoxyCodeLine{293 \textcolor{keywordflow}{DO} i = 1, proc\_count}
\DoxyCodeLine{294   \textcolor{keywordflow}{IF} ((i -\/ 1) .LT. mod(dim2\_len\_scl\_dim2\_slice, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{295     dim2\_len\_dim1\_slice\_list(i) = dim2\_len\_dim1\_slice + 1}
\DoxyCodeLine{296   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{297     dim2\_len\_dim1\_slice\_list(i) = dim2\_len\_dim1\_slice}
\DoxyCodeLine{298 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{299 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{300 dim2\_len\_dim1\_slice = dim2\_len\_dim1\_slice\_list(proc\_id + 1)}
\DoxyCodeLine{301 }
\DoxyCodeLine{302 \textcolor{comment}{! Fill in scl\_dim2\_slice using sections from the dim1\_slices.}}
\DoxyCodeLine{303 \textcolor{keywordflow}{DO} i = 1, proc\_count}
\DoxyCodeLine{304   fill\_in\_proc\_trgt = mod(proc\_count -\/ proc\_id + i, proc\_count)}
\DoxyCodeLine{305   dim1\_high\_index\_dim1\_slice = \&}
\DoxyCodeLine{306   \& sum(dim1\_len\_scl\_dim2\_slice\_list(1:fill\_in\_proc\_trgt+1))}
\DoxyCodeLine{307   dim1\_low\_index\_dim1\_slice = dim1\_high\_index\_dim1\_slice \&}
\DoxyCodeLine{308   \& -\/ dim1\_len\_scl\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) + 1}
\DoxyCodeLine{309   dim2\_high\_index\_dim2\_slice = \&}
\DoxyCodeLine{310   \& sum(dim2\_len\_dim1\_slice\_list(1:fill\_in\_proc\_trgt+1))}
\DoxyCodeLine{311   dim2\_low\_index\_dim2\_slice = dim2\_high\_index\_dim2\_slice \&}
\DoxyCodeLine{312   \& -\/ dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1) + 1}
\DoxyCodeLine{313 }
\DoxyCodeLine{314   \textcolor{comment}{! If fill\_in\_proc\_trgt < proc\_id, RECV then SEND.}}
\DoxyCodeLine{315   \textcolor{keywordflow}{IF} (fill\_in\_proc\_trgt .LT. proc\_id) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{316 }
\DoxyCodeLine{317     \textcolor{keyword}{CALL }mpi\_recv( \&}
\DoxyCodeLine{318     \& scl\_dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice), \&}
\DoxyCodeLine{319     \& dim1\_len\_scl\_dim2\_slice\_list(proc\_id+1) \&}
\DoxyCodeLine{320     \& * dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1), mpi\_double\_complex, \&}
\DoxyCodeLine{321     \& fill\_in\_proc\_trgt, proc\_id, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{322 }
\DoxyCodeLine{323     \textcolor{keyword}{CALL }mpi\_send( \&}
\DoxyCodeLine{324     \& dim1\_slice(dim1\_low\_index\_dim1\_slice:dim1\_high\_index\_dim1\_slice,:), \&}
\DoxyCodeLine{325     \& dim1\_len\_scl\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) \&}
\DoxyCodeLine{326     \& * dim2\_len\_dim1\_slice\_list(proc\_id+1), mpi\_double\_complex, \&}
\DoxyCodeLine{327     \& fill\_in\_proc\_trgt, fill\_in\_proc\_trgt, mpi\_comm\_world, ierror)}
\DoxyCodeLine{328 }
\DoxyCodeLine{329   \textcolor{comment}{! If fill\_in\_proc\_trgt > proc\_id, SEND then RECV.}}
\DoxyCodeLine{330   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (fill\_in\_proc\_trgt .GT. proc\_id) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{331     \textcolor{keyword}{CALL }mpi\_send( \&}
\DoxyCodeLine{332     \& dim1\_slice(dim1\_low\_index\_dim1\_slice:dim1\_high\_index\_dim1\_slice,:), \&}
\DoxyCodeLine{333     \& dim1\_len\_scl\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) \&}
\DoxyCodeLine{334     \& * dim2\_len\_dim1\_slice\_list(proc\_id+1), mpi\_double\_complex, \&}
\DoxyCodeLine{335     \& fill\_in\_proc\_trgt, fill\_in\_proc\_trgt, mpi\_comm\_world, ierror)}
\DoxyCodeLine{336 }
\DoxyCodeLine{337     \textcolor{keyword}{CALL }mpi\_recv( \&}
\DoxyCodeLine{338     \& scl\_dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice), \&}
\DoxyCodeLine{339     \& dim1\_len\_scl\_dim2\_slice\_list(proc\_id+1) \&}
\DoxyCodeLine{340     \& * dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1), mpi\_double\_complex, \&}
\DoxyCodeLine{341     \& fill\_in\_proc\_trgt, proc\_id, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{342 }
\DoxyCodeLine{343   \textcolor{comment}{! If fill\_in\_proc\_trgt = proc\_id, then fill in dim2\_slice from your}}
\DoxyCodeLine{344   \textcolor{comment}{! dim1\_slice.}}
\DoxyCodeLine{345   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{346     scl\_dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice) = \&}
\DoxyCodeLine{347     \& dim1\_slice(dim1\_low\_index\_dim1\_slice:dim1\_high\_index\_dim1\_slice,:)}
\DoxyCodeLine{348 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{349 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{350 }
\DoxyCodeLine{351 \textcolor{comment}{! Scale the dim2 slice.}}
\DoxyCodeLine{352 dim1\_len\_dim2\_slice = dim1\_len\_scl\_dim2\_slice}
\DoxyCodeLine{353 \textcolor{comment}{! Obtain the size of the dim1\_slice (excluding overlap).}}
\DoxyCodeLine{354 dim2\_len\_dim1\_slice = dim2\_len}
\DoxyCodeLine{355 \textcolor{comment}{! Middle processor.}}
\DoxyCodeLine{356 \textcolor{keywordflow}{IF} (mod(proc\_id, proc\_count-\/1) .NE. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{357   dim2\_len\_dim1\_slice = dim2\_len -\/ 2 * overlap}
\DoxyCodeLine{358 \textcolor{comment}{! Processor 0 or proc\_count-\/1.}}
\DoxyCodeLine{359 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{360   dim2\_len\_dim1\_slice = dim2\_len -\/ overlap}
\DoxyCodeLine{361 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{362 \textcolor{keyword}{CALL }mpi\_allreduce(dim2\_len\_dim1\_slice, dim2\_len\_dim2\_slice, 1, \&}
\DoxyCodeLine{363 \& mpi\_integer, mpi\_sum, mpi\_comm\_world, ierror)}
\DoxyCodeLine{364 \textcolor{keyword}{ALLOCATE}(dim2\_slice(dim1\_len\_dim2\_slice, dim2\_len\_dim2\_slice))}
\DoxyCodeLine{365 dim2\_slice = 0.0}
\DoxyCodeLine{366 }
\DoxyCodeLine{367 \textcolor{comment}{! Determine the indices of scl\_dim2\_slice that go ino dim2\_slice entires.}}
\DoxyCodeLine{368 scl\_dim2\_slice\_pos\_wvnm\_low\_ind = 1}
\DoxyCodeLine{369 scl\_dim2\_slice\_pos\_wvnm\_high\_ind = dim2\_len\_dim2\_slice/2 + 1}
\DoxyCodeLine{370 scl\_dim2\_slice\_neg\_wvnm\_high\_ind = dim2\_len\_scl\_dim2\_slice}
\DoxyCodeLine{371 \textcolor{keywordflow}{IF} (mod(dim2\_len\_dim2\_slice, 2) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{372   scl\_dim2\_slice\_neg\_wvnm\_low\_ind = dim2\_len\_dim2\_slice + 2}
\DoxyCodeLine{373 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (mod(dim2\_len\_dim2\_slice, 2) .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{374   scl\_dim2\_slice\_neg\_wvnm\_low\_ind = dim2\_len\_dim2\_slice + 1}
\DoxyCodeLine{375 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{376 }
\DoxyCodeLine{377 \textcolor{comment}{! Fill in dim2\_slice.}}
\DoxyCodeLine{378 dim2\_slice(:,1:dim2\_len\_dim2\_slice/2 + 1) = scl\_dim2\_slice(:, \&}
\DoxyCodeLine{379   \& scl\_dim2\_slice\_pos\_wvnm\_low\_ind:scl\_dim2\_slice\_pos\_wvnm\_high\_ind)}
\DoxyCodeLine{380 dim2\_slice(:,dim2\_len\_dim2\_slice/2 + 2:dim2\_len\_dim2\_slice) = \&}
\DoxyCodeLine{381 \& scl\_dim2\_slice(:, \&}
\DoxyCodeLine{382   \& scl\_dim2\_slice\_neg\_wvnm\_low\_ind:scl\_dim2\_slice\_neg\_wvnm\_high\_ind)}
\DoxyCodeLine{383 }
\DoxyCodeLine{384 \textcolor{comment}{! We have now scaled down in dim2. Now to construct the dim1 slices and fill in}}
\DoxyCodeLine{385 \textcolor{comment}{! the smaller matix.}}
\DoxyCodeLine{386 \textcolor{comment}{! Reallocate dim1\_slice.}}
\DoxyCodeLine{387 \textcolor{keyword}{DEALLOCATE}(dim1\_slice)}
\DoxyCodeLine{388 dim1\_len\_dim1\_slice = dim1\_len}
\DoxyCodeLine{389 \textcolor{comment}{! Evenly divide dim2\_len of the matrix.}}
\DoxyCodeLine{390 dim2\_len\_dim1\_slice = dim2\_len\_dim2\_slice/proc\_count}
\DoxyCodeLine{391 \textcolor{keywordflow}{DO} i = 1, proc\_count}
\DoxyCodeLine{392   \textcolor{keywordflow}{IF} ((i-\/1) .LT. modulo(dim2\_len\_dim2\_slice, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{393     dim2\_len\_dim1\_slice\_list(i) = dim2\_len\_dim1\_slice + 1}
\DoxyCodeLine{394     \textcolor{comment}{! The indexing is weird here since processors start at index 0 but arrays}}
\DoxyCodeLine{395     \textcolor{comment}{! start at index 1. Thus, entry ii of this corresponds to processor (ii-\/1).}}
\DoxyCodeLine{396   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{397     dim2\_len\_dim1\_slice\_list(i) = dim2\_len\_dim1\_slice}
\DoxyCodeLine{398 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{399 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{400 dim2\_len\_dim1\_slice = dim2\_len\_dim1\_slice\_list(proc\_id + 1)}
\DoxyCodeLine{401 \textcolor{keyword}{ALLOCATE}(dim1\_slice(dim1\_len\_dim1\_slice,dim2\_len\_dim1\_slice))}
\DoxyCodeLine{402 dim1\_slice = 0.0}
\DoxyCodeLine{403 }
\DoxyCodeLine{404 \textcolor{comment}{! Obtain dim1\_len\_dim2\_slice\_list for section communication.}}
\DoxyCodeLine{405 dim1\_len\_dim2\_slice = dim1\_len/proc\_count}
\DoxyCodeLine{406 \textcolor{keywordflow}{DO} i = 1, proc\_count}
\DoxyCodeLine{407   \textcolor{keywordflow}{IF} ((i-\/1) .LT. modulo(dim1\_len, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{408     dim1\_len\_dim2\_slice\_list(i) = dim1\_len\_dim2\_slice + 1}
\DoxyCodeLine{409     \textcolor{comment}{! The indexing is weird here since processors start at index 0 but arrays}}
\DoxyCodeLine{410     \textcolor{comment}{! start at index 1. Thus, entry i of this corresponds to processor (i-\/1).}}
\DoxyCodeLine{411   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{412     dim1\_len\_dim2\_slice\_list(i) = dim1\_len\_dim2\_slice}
\DoxyCodeLine{413 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{414 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{415 dim1\_len\_dim2\_slice = dim1\_len\_dim2\_slice\_list(proc\_id + 1)}
\DoxyCodeLine{416 }
\DoxyCodeLine{417 \textcolor{comment}{! Fill in dim1\_slice using sections from the dim2\_slices.}}
\DoxyCodeLine{418 \textcolor{keywordflow}{DO} i = 1, proc\_count}
\DoxyCodeLine{419   fill\_in\_proc\_trgt = mod(proc\_count -\/ proc\_id + i, proc\_count)}
\DoxyCodeLine{420   dim1\_high\_index\_dim1\_slice = \&}
\DoxyCodeLine{421   \& sum(dim1\_len\_dim2\_slice\_list(1:fill\_in\_proc\_trgt+1))}
\DoxyCodeLine{422   dim1\_low\_index\_dim1\_slice = dim1\_high\_index\_dim1\_slice \&}
\DoxyCodeLine{423   \& -\/ dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) + 1}
\DoxyCodeLine{424   dim2\_high\_index\_dim2\_slice = \&}
\DoxyCodeLine{425   \& sum(dim2\_len\_dim1\_slice\_list(1:fill\_in\_proc\_trgt+1))}
\DoxyCodeLine{426   dim2\_low\_index\_dim2\_slice = dim2\_high\_index\_dim2\_slice \&}
\DoxyCodeLine{427   \& -\/ dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1) + 1}
\DoxyCodeLine{428 }
\DoxyCodeLine{429   \textcolor{comment}{! If fill\_in\_proc\_trgt < proc\_id, RECV then SEND.}}
\DoxyCodeLine{430   \textcolor{keywordflow}{IF} (fill\_in\_proc\_trgt .LT. proc\_id) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{431     \textcolor{keyword}{CALL }mpi\_recv( \&}
\DoxyCodeLine{432     \& dim1\_slice(dim1\_low\_index\_dim1\_slice:dim1\_high\_index\_dim1\_slice,:), \&}
\DoxyCodeLine{433     \& dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) \&}
\DoxyCodeLine{434     \& * dim2\_len\_dim1\_slice\_list(proc\_id+1), mpi\_double\_complex, \&}
\DoxyCodeLine{435     \& fill\_in\_proc\_trgt, proc\_id, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{436 }
\DoxyCodeLine{437     \textcolor{keyword}{CALL }mpi\_send( \&}
\DoxyCodeLine{438     \& dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice), \&}
\DoxyCodeLine{439     \& dim1\_len\_dim2\_slice\_list(proc\_id+1) \&}
\DoxyCodeLine{440     \& * dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1), mpi\_double\_complex, \&}
\DoxyCodeLine{441     \& fill\_in\_proc\_trgt, fill\_in\_proc\_trgt, mpi\_comm\_world, ierror)}
\DoxyCodeLine{442 }
\DoxyCodeLine{443   \textcolor{comment}{! If fill\_in\_proc\_trgt > proc\_id, SEND then RECV.}}
\DoxyCodeLine{444   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (fill\_in\_proc\_trgt .GT. proc\_id) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{445     \textcolor{keyword}{CALL }mpi\_send( \&}
\DoxyCodeLine{446     \& dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice), \&}
\DoxyCodeLine{447     \& dim1\_len\_dim2\_slice\_list(proc\_id+1) \&}
\DoxyCodeLine{448     \& * dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1), mpi\_double\_complex, \&}
\DoxyCodeLine{449     \& fill\_in\_proc\_trgt, fill\_in\_proc\_trgt, mpi\_comm\_world, ierror)}
\DoxyCodeLine{450 }
\DoxyCodeLine{451     \textcolor{keyword}{CALL }mpi\_recv( \&}
\DoxyCodeLine{452     \& dim1\_slice(dim1\_low\_index\_dim1\_slice:dim1\_high\_index\_dim1\_slice,:), \&}
\DoxyCodeLine{453     \& dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) \&}
\DoxyCodeLine{454     \& * dim2\_len\_dim1\_slice\_list(proc\_id+1), mpi\_double\_complex, \&}
\DoxyCodeLine{455     \& fill\_in\_proc\_trgt, proc\_id, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{456 }
\DoxyCodeLine{457   \textcolor{comment}{! If fill\_in\_proc\_trgt = proc\_id, then fill in dim2\_slice from your}}
\DoxyCodeLine{458   \textcolor{comment}{! dim1\_slice.}}
\DoxyCodeLine{459   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{460     dim1\_slice(dim1\_low\_index\_dim1\_slice:dim1\_high\_index\_dim1\_slice,:) = \&}
\DoxyCodeLine{461     \& dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice)}
\DoxyCodeLine{462 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{463 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{464 }
\DoxyCodeLine{465 \textcolor{comment}{! Use dim1\_slices to file in the interiors of matrix, and then call}}
\DoxyCodeLine{466 \textcolor{comment}{! SHARE\_SUBGRID\_BOUNDARIES to fill in the boundaries of the sub-\/grids.}}
\DoxyCodeLine{467 }
\DoxyCodeLine{468 \textcolor{comment}{! Fill in interior of matrix.}}
\DoxyCodeLine{469 \textcolor{keywordflow}{IF} (proc\_id .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{470   \textcolor{comment}{! First processor, fill in all except last part along dimension 2 of matrix.}}
\DoxyCodeLine{471   matrix(:, 1:dim2\_len-\/overlap) = dim1\_slice}
\DoxyCodeLine{472 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (proc\_id .EQ. proc\_count-\/1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{473   \textcolor{comment}{! Last processor, fill in all but first part along dimension 2 of matrix.}}
\DoxyCodeLine{474   matrix(:, 1+overlap:dim2\_len) = dim1\_slice}
\DoxyCodeLine{475 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{476   \textcolor{comment}{! Middle processor, fill in all but first and last part along dimension 2 of}}
\DoxyCodeLine{477   \textcolor{comment}{! matrix.}}
\DoxyCodeLine{478   matrix(:, 1+overlap:dim2\_len-\/overlap) = dim1\_slice}
\DoxyCodeLine{479 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{480 }
\DoxyCodeLine{481 }
\DoxyCodeLine{482 \textcolor{keyword}{CALL }\mbox{\hyperlink{share__subgrid__boundaries__dble__cmplx_8f_ab72aac7a19e9dd8ef60d8f704a8aa7e4}{share\_subgrid\_boundaries\_dble\_cmplx\_ezp}}(dim1\_len, dim2\_len, overlap, matrix)}
\DoxyCodeLine{483 }

\end{DoxyCode}
\mbox{\Hypertarget{zero__padding__inv__dble__cmplx_8f_ad50c8135506cbb826872be25c41cfd3b}\label{zero__padding__inv__dble__cmplx_8f_ad50c8135506cbb826872be25c41cfd3b}} 
\index{zero\_padding\_inv\_dble\_cmplx.f@{zero\_padding\_inv\_dble\_cmplx.f}!serial@{serial}}
\index{serial@{serial}!zero\_padding\_inv\_dble\_cmplx.f@{zero\_padding\_inv\_dble\_cmplx.f}}
\doxysubsubsection{\texorpdfstring{serial()}{serial()}}
{\footnotesize\ttfamily subroutine zero\+\_\+padding\+\_\+inv\+\_\+dble\+\_\+cmplx\+\_\+ezp\+::serial (\begin{DoxyParamCaption}\item[{integer}]{dim1\+\_\+len,  }\item[{integer}]{dim2\+\_\+len,  }\item[{double complex, dimension(\mbox{\hyperlink{cfft2df__unit__test__MATLAB_8m_acb4b6a591c5ad6fc207ef543dc74d1ae}{dim1\+\_\+len}}, \mbox{\hyperlink{cfft2df__unit__test__MATLAB_8m_adef80e51b1bb5916dd9410de399f1319}{dim2\+\_\+len}})}]{matrix,  }\item[{integer}]{scl\+\_\+dim1\+\_\+len,  }\item[{integer}]{scl\+\_\+dim2\+\_\+len,  }\item[{double complex, dimension(scl\+\_\+dim1\+\_\+len, scl\+\_\+dim2\+\_\+len)}]{scaled\+\_\+matrix }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{79 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{80 }
\DoxyCodeLine{81 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{82 }
\DoxyCodeLine{83 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{84 }
\DoxyCodeLine{85 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{86 \& dim2\_len,  \&}
\DoxyCodeLine{87 \& scl\_dim1\_len, \&}
\DoxyCodeLine{88 \& scl\_dim2\_len, \&}
\DoxyCodeLine{89 \& scaled\_dim1\_neg\_wavenum\_low\_index, \&}
\DoxyCodeLine{90 \& scaled\_dim2\_neg\_wavenum\_low\_index}
\DoxyCodeLine{91 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(dim1\_len, dim2\_len)} :: matrix}
\DoxyCodeLine{92 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(scl\_dim1\_len, scl\_dim2\_len)} :: scaled\_matrix}
\DoxyCodeLine{93 }
\DoxyCodeLine{94 matrix = 0.0}
\DoxyCodeLine{95 \textcolor{keywordflow}{IF} (mod(dim1\_len, 2) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{96   scaled\_dim1\_neg\_wavenum\_low\_index = dim1\_len + 2}
\DoxyCodeLine{97 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (mod(dim1\_len, 2) .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{98   scaled\_dim1\_neg\_wavenum\_low\_index = dim1\_len + 1}
\DoxyCodeLine{99 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{100 }
\DoxyCodeLine{101 \textcolor{keywordflow}{IF} (mod(dim2\_len, 2) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{102   scaled\_dim2\_neg\_wavenum\_low\_index = dim2\_len + 2}
\DoxyCodeLine{103 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (mod(dim2\_len, 2) .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{104   scaled\_dim2\_neg\_wavenum\_low\_index = dim2\_len + 1}
\DoxyCodeLine{105 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{106 }
\DoxyCodeLine{107 \textcolor{comment}{! This matrix is scale by 3/2 in each dimension, with the indices corresponding}}
\DoxyCodeLine{108 \textcolor{comment}{! to the largest wavenumbers (in magnitude) zeroed out.}}
\DoxyCodeLine{109 matrix(1:dim1\_len/2+1, 1:dim2\_len/2+1) = \&}
\DoxyCodeLine{110 \& scaled\_matrix(1:dim1\_len/2+1, 1:dim2\_len/2+1)}
\DoxyCodeLine{111 }
\DoxyCodeLine{112 matrix(1:dim1\_len/2+1, dim2\_len/2+2:dim2\_len) = \&}
\DoxyCodeLine{113 \& scaled\_matrix(1:dim1\_len/2+1, scaled\_dim2\_neg\_wavenum\_low\_index:scl\_dim2\_len)}
\DoxyCodeLine{114 }
\DoxyCodeLine{115 matrix(dim1\_len/2+2:dim1\_len, 1:dim2\_len/2+1) = \&}
\DoxyCodeLine{116 \& scaled\_matrix(scaled\_dim1\_neg\_wavenum\_low\_index:scl\_dim1\_len, \&}
\DoxyCodeLine{117   \& 1:dim2\_len/2+1)}
\DoxyCodeLine{118 }
\DoxyCodeLine{119 matrix(dim1\_len/2+2:dim1\_len, dim2\_len/2+2:dim2\_len) = \&}
\DoxyCodeLine{120 \& scaled\_matrix(scaled\_dim1\_neg\_wavenum\_low\_index:scl\_dim1\_len, \&}
\DoxyCodeLine{121   \& scaled\_dim2\_neg\_wavenum\_low\_index:scl\_dim2\_len)}
\DoxyCodeLine{122 }

\end{DoxyCode}
\mbox{\Hypertarget{zero__padding__inv__dble__cmplx_8f_ac071011cbdba5faa1f193641174ac106}\label{zero__padding__inv__dble__cmplx_8f_ac071011cbdba5faa1f193641174ac106}} 
\index{zero\_padding\_inv\_dble\_cmplx.f@{zero\_padding\_inv\_dble\_cmplx.f}!zero\_padding\_inv\_dble\_cmplx\_ezp@{zero\_padding\_inv\_dble\_cmplx\_ezp}}
\index{zero\_padding\_inv\_dble\_cmplx\_ezp@{zero\_padding\_inv\_dble\_cmplx\_ezp}!zero\_padding\_inv\_dble\_cmplx.f@{zero\_padding\_inv\_dble\_cmplx.f}}
\doxysubsubsection{\texorpdfstring{zero\_padding\_inv\_dble\_cmplx\_ezp()}{zero\_padding\_inv\_dble\_cmplx\_ezp()}}
{\footnotesize\ttfamily subroutine zero\+\_\+padding\+\_\+inv\+\_\+dble\+\_\+cmplx\+\_\+ezp (\begin{DoxyParamCaption}\item[{integer}]{dim1\+\_\+len,  }\item[{integer}]{dim2\+\_\+len,  }\item[{double complex, dimension(\mbox{\hyperlink{cfft2df__unit__test__MATLAB_8m_acb4b6a591c5ad6fc207ef543dc74d1ae}{dim1\+\_\+len}}, \mbox{\hyperlink{cfft2df__unit__test__MATLAB_8m_adef80e51b1bb5916dd9410de399f1319}{dim2\+\_\+len}})}]{matrix,  }\item[{integer}]{scl\+\_\+dim1\+\_\+len,  }\item[{integer}]{scl\+\_\+dim2\+\_\+len,  }\item[{double complex, dimension(scl\+\_\+dim1\+\_\+len, scl\+\_\+dim2\+\_\+len)}]{scaled\+\_\+matrix,  }\item[{integer}]{overlap }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{24 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{31 \& dim2\_len, \&}
\DoxyCodeLine{32 \& overlap, \&}
\DoxyCodeLine{33 \& scl\_dim1\_len, \&}
\DoxyCodeLine{34 \& scl\_dim2\_len, \&}
\DoxyCodeLine{35 \& proc\_id, \&}
\DoxyCodeLine{36 \& proc\_count, \&}
\DoxyCodeLine{37 \& ierror}
\DoxyCodeLine{38 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(dim1\_len, dim2\_len)} :: matrix}
\DoxyCodeLine{39 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(scl\_dim1\_len, scl\_dim2\_len)} :: scaled\_matrix}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 \textcolor{keyword}{CALL }mpi\_comm\_rank(mpi\_comm\_world, proc\_id, ierror)}
\DoxyCodeLine{42 \textcolor{keyword}{CALL }mpi\_comm\_size(mpi\_comm\_world, proc\_count, ierror)}
\DoxyCodeLine{43 }
\DoxyCodeLine{44 \textcolor{comment}{! Check for errors in user input.}}
\DoxyCodeLine{45 \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}(proc\_id)}
\DoxyCodeLine{46 }
\DoxyCodeLine{47 \textcolor{comment}{! Run in serial if there is only one processor.}}
\DoxyCodeLine{48 \textcolor{keywordflow}{IF} (proc\_count .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{49   \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}(dim1\_len, dim2\_len, matrix, scl\_dim1\_len, scl\_dim2\_len, \&}
\DoxyCodeLine{50     \& scaled\_matrix)}
\DoxyCodeLine{51 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{52   \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}(dim1\_len, dim2\_len, matrix, scl\_dim1\_len, scl\_dim2\_len, \&}
\DoxyCodeLine{53     \& scaled\_matrix, overlap, proc\_id, proc\_count)}
\DoxyCodeLine{54 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{55 }
\DoxyCodeLine{56 }
\DoxyCodeLine{57 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{58 \textcolor{keyword}{CONTAINS}}
\DoxyCodeLine{59 }
\DoxyCodeLine{60 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{61 \textcolor{comment}{! SERIAL. Handles the execution if there is only one processor.}}
\DoxyCodeLine{62 \textcolor{comment}{!}}
\DoxyCodeLine{63 \textcolor{comment}{! STRUCTURE: 1) Calculates the size of the scaled matrix, and the index in the}}
\DoxyCodeLine{64 \textcolor{comment}{! scaled matrix of the largest negative wavenumber in both dim1 and dim2.}}
\DoxyCodeLine{65 \textcolor{comment}{! 2) Fills in the non-\/zero entries of the scaled matrix (which correspond to the}}
\DoxyCodeLine{66 \textcolor{comment}{! wavenumbers of the original matrix) with the entries of the original matrix.}}
\DoxyCodeLine{67 \textcolor{comment}{!}}
\DoxyCodeLine{68 \textcolor{comment}{! VARIABLES: -\/ dim1\_len, dim2\_len: The shape of the matrix (INTEGER).}}
\DoxyCodeLine{69 \textcolor{comment}{! -\/ matrix: The matrix to be scaled (DOUBLE COMPLEX,}}
\DoxyCodeLine{70 \textcolor{comment}{! DIMENSION(dim1\_len, dim2\_len)).}}
\DoxyCodeLine{71 \textcolor{comment}{! -\/ scl\_dim1\_len, slc\_dim2\_len: The dimensions of scaled\_matrix (INTEGER).}}
\DoxyCodeLine{72 \textcolor{comment}{! -\/ scaled\_matrix: The resulting scaled matrix (DOUBLE COMPLEX,}}
\DoxyCodeLine{73 \textcolor{comment}{! DIMENSION(scl\_dim1\_len, scl\_dim2\_len)).}}
\DoxyCodeLine{74 \textcolor{comment}{! -\/ scaled\_dim1\_neg\_wavenum\_low\_index, scaled\_dim2\_neg\_wavenum\_low\_index: The}}
\DoxyCodeLine{75 \textcolor{comment}{! lower index of the largest negative wavenumber in scaled\_matrix (INTEGER).}}
\DoxyCodeLine{76 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{77 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}(dim1\_len, dim2\_len, matrix, scl\_dim1\_len, scl\_dim2\_len, \&}
\DoxyCodeLine{78   \& scaled\_matrix)}
\DoxyCodeLine{79 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{80 }
\DoxyCodeLine{81 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{82 }
\DoxyCodeLine{83 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{84 }
\DoxyCodeLine{85 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{86 \& dim2\_len,  \&}
\DoxyCodeLine{87 \& scl\_dim1\_len, \&}
\DoxyCodeLine{88 \& scl\_dim2\_len, \&}
\DoxyCodeLine{89 \& scaled\_dim1\_neg\_wavenum\_low\_index, \&}
\DoxyCodeLine{90 \& scaled\_dim2\_neg\_wavenum\_low\_index}
\DoxyCodeLine{91 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(dim1\_len, dim2\_len)} :: matrix}
\DoxyCodeLine{92 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(scl\_dim1\_len, scl\_dim2\_len)} :: scaled\_matrix}
\DoxyCodeLine{93 }
\DoxyCodeLine{94 matrix = 0.0}
\DoxyCodeLine{95 \textcolor{keywordflow}{IF} (mod(dim1\_len, 2) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{96   scaled\_dim1\_neg\_wavenum\_low\_index = dim1\_len + 2}
\DoxyCodeLine{97 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (mod(dim1\_len, 2) .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{98   scaled\_dim1\_neg\_wavenum\_low\_index = dim1\_len + 1}
\DoxyCodeLine{99 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{100 }
\DoxyCodeLine{101 \textcolor{keywordflow}{IF} (mod(dim2\_len, 2) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{102   scaled\_dim2\_neg\_wavenum\_low\_index = dim2\_len + 2}
\DoxyCodeLine{103 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (mod(dim2\_len, 2) .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{104   scaled\_dim2\_neg\_wavenum\_low\_index = dim2\_len + 1}
\DoxyCodeLine{105 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{106 }
\DoxyCodeLine{107 \textcolor{comment}{! This matrix is scale by 3/2 in each dimension, with the indices corresponding}}
\DoxyCodeLine{108 \textcolor{comment}{! to the largest wavenumbers (in magnitude) zeroed out.}}
\DoxyCodeLine{109 matrix(1:dim1\_len/2+1, 1:dim2\_len/2+1) = \&}
\DoxyCodeLine{110 \& scaled\_matrix(1:dim1\_len/2+1, 1:dim2\_len/2+1)}
\DoxyCodeLine{111 }
\DoxyCodeLine{112 matrix(1:dim1\_len/2+1, dim2\_len/2+2:dim2\_len) = \&}
\DoxyCodeLine{113 \& scaled\_matrix(1:dim1\_len/2+1, scaled\_dim2\_neg\_wavenum\_low\_index:scl\_dim2\_len)}
\DoxyCodeLine{114 }
\DoxyCodeLine{115 matrix(dim1\_len/2+2:dim1\_len, 1:dim2\_len/2+1) = \&}
\DoxyCodeLine{116 \& scaled\_matrix(scaled\_dim1\_neg\_wavenum\_low\_index:scl\_dim1\_len, \&}
\DoxyCodeLine{117   \& 1:dim2\_len/2+1)}
\DoxyCodeLine{118 }
\DoxyCodeLine{119 matrix(dim1\_len/2+2:dim1\_len, dim2\_len/2+2:dim2\_len) = \&}
\DoxyCodeLine{120 \& scaled\_matrix(scaled\_dim1\_neg\_wavenum\_low\_index:scl\_dim1\_len, \&}
\DoxyCodeLine{121   \& scaled\_dim2\_neg\_wavenum\_low\_index:scl\_dim2\_len)}
\DoxyCodeLine{122 }
\DoxyCodeLine{123 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}}
\DoxyCodeLine{124 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{125 }
\DoxyCodeLine{126 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{127 \textcolor{comment}{! PARALLEL. Handles the execution if there is more than one processor.}}
\DoxyCodeLine{128 \textcolor{comment}{!}}
\DoxyCodeLine{129 \textcolor{comment}{! STRUCTURE: 1) Strip the overlap from each sub-\/grid to make them easier to}}
\DoxyCodeLine{130 \textcolor{comment}{! work with. Scale each sub-\/grid interior along the first dimension.}}
\DoxyCodeLine{131 \textcolor{comment}{! 2) Rearrange the partially scaled grid into slices along the first dimension}}
\DoxyCodeLine{132 \textcolor{comment}{! (the dim2 slices).}}
\DoxyCodeLine{133 \textcolor{comment}{! 3) Scale the dim2 slices along the second dimension.}}
\DoxyCodeLine{134 \textcolor{comment}{! 4) Construct the interior of the scaled sub-\/grids using these scaled dim2}}
\DoxyCodeLine{135 \textcolor{comment}{! slices.}}
\DoxyCodeLine{136 \textcolor{comment}{! 4) Fill in the overlap region with the SHARE\_SUBGRID\_BOUNDARIES subroutine.}}
\DoxyCodeLine{137 \textcolor{comment}{!}}
\DoxyCodeLine{138 \textcolor{comment}{!}}
\DoxyCodeLine{139 \textcolor{comment}{! VARIABLES: -\/ dim1\_len, dim2\_len: The shape of the matrix (INTEGER).}}
\DoxyCodeLine{140 \textcolor{comment}{! -\/ matrix: The matrix to be scaled (DOUBLE COMPLEX,}}
\DoxyCodeLine{141 \textcolor{comment}{! DIMENSION(dim1\_len, dim2\_len)).}}
\DoxyCodeLine{142 \textcolor{comment}{! -\/ scl\_dim1\_len, slc\_dim2\_len: The dimensions of scaled\_matrix (INTEGER).}}
\DoxyCodeLine{143 \textcolor{comment}{! -\/ scaled\_matrix: The resulting scaled matrix (DOUBLE COMPLEX,}}
\DoxyCodeLine{144 \textcolor{comment}{! DIMENSION(scl\_dim1\_len, scl\_dim2\_len)).}}
\DoxyCodeLine{145 \textcolor{comment}{! -\/ overlap: The overlap required for the numerical scheme (INTEGER).}}
\DoxyCodeLine{146 \textcolor{comment}{! -\/ proc\_id: Processor ID (INTEGER).}}
\DoxyCodeLine{147 \textcolor{comment}{! -\/ proc\_count: Number of processors (INTEGER).}}
\DoxyCodeLine{148 \textcolor{comment}{! -\/ dim2\_len\_interior: dim2\_len of sub-\/grid not counting the overlapping region}}
\DoxyCodeLine{149 \textcolor{comment}{! (INTEGER).}}
\DoxyCodeLine{150 \textcolor{comment}{! -\/ i: Counting index for DO loops (INTEGER).}}
\DoxyCodeLine{151 \textcolor{comment}{! -\/ dim1\_len\_dim1\_slice, dim2\_len\_dim1\_slice, dim1\_len\_dim2\_slice,}}
\DoxyCodeLine{152 \textcolor{comment}{! dim2\_len\_dim2\_slice: Dimensions of the dim1 and dim2 slices (INTEGER).}}
\DoxyCodeLine{153 \textcolor{comment}{! -\/ scl\_dim1\_len\_dim1\_slice, scl\_dim2\_len\_dim1\_slice, scl\_dim1\_len\_dim2\_slice,}}
\DoxyCodeLine{154 \textcolor{comment}{! scl\_dim2\_len\_dim2\_slice: The dimensions of the scaled dim1 and dim2 slices}}
\DoxyCodeLine{155 \textcolor{comment}{! (INTEGER).}}
\DoxyCodeLine{156 \textcolor{comment}{! -\/ scl\_dim1\_slice\_pos\_wvnm\_low\_ind, scl\_dim1\_slice\_pos\_wvnm\_high\_ind,}}
\DoxyCodeLine{157 \textcolor{comment}{! -\/ scl\_dim1\_slice\_neg\_wvnm\_low\_ind, scl\_dim1\_slice\_neg\_wvnm\_high\_ind,}}
\DoxyCodeLine{158 \textcolor{comment}{! -\/ scl\_dim2\_slice\_pos\_wvnm\_low\_ind, scl\_dim2\_slice\_pos\_wvnm\_high\_ind,}}
\DoxyCodeLine{159 \textcolor{comment}{! -\/ scl\_dim2\_slice\_neg\_wvnm\_low\_ind, scl\_dim2\_slice\_neg\_wvnm\_high\_ind: The}}
\DoxyCodeLine{160 \textcolor{comment}{! indices for the positive/negative wavenumbers in the scaled dim1 and dim2}}
\DoxyCodeLine{161 \textcolor{comment}{! slices (INTEGER).}}
\DoxyCodeLine{162 \textcolor{comment}{! -\/ fill\_in\_proc\_trgt: The proc\_id of the processor to communicate with during}}
\DoxyCodeLine{163 \textcolor{comment}{! the dim2\_slice fill-\/in process (INTEGER).}}
\DoxyCodeLine{164 \textcolor{comment}{! -\/ dim1\_low\_index\_dim1\_slice: Lesser global dim2 index for the portion of}}
\DoxyCodeLine{165 \textcolor{comment}{! dim1\_slice to be put into dim2\_slice (INTEGER).}}
\DoxyCodeLine{166 \textcolor{comment}{! -\/ dim1\_high\_index\_dim1\_slice: Greater global dim2 index for the portion of}}
\DoxyCodeLine{167 \textcolor{comment}{! dim1\_slice to be put into dim2\_slice (INTEGER).}}
\DoxyCodeLine{168 \textcolor{comment}{! -\/ dim2\_low\_index\_dim2\_slice: Lesser global dim2 index for the portion of}}
\DoxyCodeLine{169 \textcolor{comment}{! dim2\_slice to be filled in by dim1\_slice (INTEGER).}}
\DoxyCodeLine{170 \textcolor{comment}{! -\/ dim2\_high\_index\_dim2\_slice: Greater global dim2 index for the portion of}}
\DoxyCodeLine{171 \textcolor{comment}{! dim2\_slice to be filled in by dim1\_slice (INTEGER).}}
\DoxyCodeLine{172 \textcolor{comment}{! -\/ dim1\_len\_dim2\_slice\_list, dim2\_len\_dim1\_slice\_list: The list of dim1/dim2}}
\DoxyCodeLine{173 \textcolor{comment}{! lengths for the dim1/dim2 slices (INTEGER, DIMENSION(proc\_count)).}}
\DoxyCodeLine{174 \textcolor{comment}{! -\/ dim1\_slice, dim2\_slice, scl\_dim1\_slice, scl\_dim2\_slice: The slices of the}}
\DoxyCodeLine{175 \textcolor{comment}{! global matrix and scaled matrix in each dimension (dim1 is a slice whose dim1}}
\DoxyCodeLine{176 \textcolor{comment}{! length matches that of the global grid) (DOUBLE COMPLEX, DIMENSION(:,:),}}
\DoxyCodeLine{177 \textcolor{comment}{! ALLOCATABLE).}}
\DoxyCodeLine{178 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{179 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}(dim1\_len, dim2\_len, matrix, scl\_dim1\_len, scl\_dim2\_len, \&}
\DoxyCodeLine{180   \& scaled\_matrix, overlap, proc\_id, proc\_count)}
\DoxyCodeLine{181 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{182 }
\DoxyCodeLine{183 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{184 }
\DoxyCodeLine{185 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{186 }
\DoxyCodeLine{187 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{188 \& dim2\_len, \&}
\DoxyCodeLine{189 \& scl\_dim1\_len, \&}
\DoxyCodeLine{190 \& scl\_dim2\_len, \&}
\DoxyCodeLine{191 \& overlap, \&}
\DoxyCodeLine{192 \& proc\_id, \&}
\DoxyCodeLine{193 \& proc\_count, \&}
\DoxyCodeLine{194 \& ierror, \&}
\DoxyCodeLine{195 \& dim1\_len\_dim1\_slice, \&}
\DoxyCodeLine{196 \& dim2\_len\_dim1\_slice, \&}
\DoxyCodeLine{197 \& dim1\_len\_dim2\_slice, \&}
\DoxyCodeLine{198 \& dim2\_len\_dim2\_slice, \&}
\DoxyCodeLine{199 \& dim1\_len\_scl\_dim1\_slice, \&}
\DoxyCodeLine{200 \& dim2\_len\_scl\_dim1\_slice, \&}
\DoxyCodeLine{201 \& dim1\_len\_scl\_dim2\_slice, \&}
\DoxyCodeLine{202 \& dim2\_len\_scl\_dim2\_slice, \&}
\DoxyCodeLine{203 \& scl\_dim1\_slice\_pos\_wvnm\_low\_ind, \&}
\DoxyCodeLine{204 \& scl\_dim1\_slice\_pos\_wvnm\_high\_ind, \&}
\DoxyCodeLine{205 \& scl\_dim1\_slice\_neg\_wvnm\_low\_ind, \&}
\DoxyCodeLine{206 \& scl\_dim1\_slice\_neg\_wvnm\_high\_ind, \&}
\DoxyCodeLine{207 \& scl\_dim2\_slice\_pos\_wvnm\_low\_ind, \&}
\DoxyCodeLine{208 \& scl\_dim2\_slice\_pos\_wvnm\_high\_ind, \&}
\DoxyCodeLine{209 \& scl\_dim2\_slice\_neg\_wvnm\_low\_ind, \&}
\DoxyCodeLine{210 \& scl\_dim2\_slice\_neg\_wvnm\_high\_ind, \&}
\DoxyCodeLine{211 \& fill\_in\_proc\_trgt, \&}
\DoxyCodeLine{212 \& i, \&}
\DoxyCodeLine{213 \& j, \&}
\DoxyCodeLine{214 \& status(MPI\_STATUS\_SIZE), \&}
\DoxyCodeLine{215 \& dim1\_low\_index\_dim1\_slice, \&}
\DoxyCodeLine{216 \& dim1\_high\_index\_dim1\_slice, \&}
\DoxyCodeLine{217 \& dim2\_low\_index\_dim2\_slice, \&}
\DoxyCodeLine{218 \& dim2\_high\_index\_dim2\_slice}
\DoxyCodeLine{219 \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(proc\_count)} :: dim1\_len\_scl\_dim2\_slice\_list, \&}
\DoxyCodeLine{220 \& dim1\_len\_dim2\_slice\_list, \&}
\DoxyCodeLine{221 \& dim2\_len\_dim1\_slice\_list}
\DoxyCodeLine{222 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(dim1\_len,dim2\_len)} :: matrix}
\DoxyCodeLine{223 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{ALLOCATABLE} :: dim1\_slice, \&}
\DoxyCodeLine{224 \& dim2\_slice, \&}
\DoxyCodeLine{225 \& scl\_dim1\_slice, \&}
\DoxyCodeLine{226 \& scl\_dim2\_slice}
\DoxyCodeLine{227 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(scl\_dim1\_len, scl\_dim2\_len)} :: scaled\_matrix}
\DoxyCodeLine{228 }
\DoxyCodeLine{229 matrix = 0.0}
\DoxyCodeLine{230 \textcolor{comment}{! Obtain the size of the scl\_dim1\_slice (excluding overlap).}}
\DoxyCodeLine{231 dim1\_len\_scl\_dim1\_slice = scl\_dim1\_len}
\DoxyCodeLine{232 \textcolor{comment}{! Middle processor.}}
\DoxyCodeLine{233 \textcolor{keywordflow}{IF} (mod(proc\_id, proc\_count-\/1) .NE. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{234   dim2\_len\_scl\_dim1\_slice = scl\_dim2\_len -\/ 2 * overlap}
\DoxyCodeLine{235 \textcolor{comment}{! Processor 0 or proc\_count-\/1.}}
\DoxyCodeLine{236 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{237   dim2\_len\_scl\_dim1\_slice = scl\_dim2\_len -\/ overlap}
\DoxyCodeLine{238 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{239 \textcolor{comment}{! Obtain the scl\_dim1\_slice entries.}}
\DoxyCodeLine{240 \textcolor{keyword}{ALLOCATE}(scl\_dim1\_slice(dim1\_len\_scl\_dim1\_slice, dim2\_len\_scl\_dim1\_slice))}
\DoxyCodeLine{241 scl\_dim1\_slice = 0.0}
\DoxyCodeLine{242 \textcolor{comment}{! Processor 0, doesn't need last parts of dim2.}}
\DoxyCodeLine{243 \textcolor{keywordflow}{IF} (proc\_id .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{244   scl\_dim1\_slice = scaled\_matrix(:,1:scl\_dim2\_len-\/overlap)}
\DoxyCodeLine{245 \textcolor{comment}{! Last processor, doesn't need first part of dim2.}}
\DoxyCodeLine{246 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (proc\_id .EQ. proc\_count-\/1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{247   scl\_dim1\_slice = scaled\_matrix(:,overlap+1:scl\_dim2\_len)}
\DoxyCodeLine{248 \textcolor{comment}{! Middle processor, doesn't need first or last part of dim2.}}
\DoxyCodeLine{249 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{250   scl\_dim1\_slice = scaled\_matrix(:,overlap+1:scl\_dim2\_len-\/overlap)}
\DoxyCodeLine{251 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{252 }
\DoxyCodeLine{253 \textcolor{comment}{! Scale in the dim1 direction.}}
\DoxyCodeLine{254 dim1\_len\_dim1\_slice = dim1\_len}
\DoxyCodeLine{255 dim2\_len\_dim1\_slice = dim2\_len\_scl\_dim1\_slice}
\DoxyCodeLine{256 \textcolor{keyword}{ALLOCATE}(dim1\_slice(dim1\_len\_dim1\_slice, dim2\_len\_dim1\_slice))}
\DoxyCodeLine{257 dim1\_slice = 0.0}
\DoxyCodeLine{258 \textcolor{comment}{! Determine the indices of scl\_dim1\_slice that dim1\_slice entires go into.}}
\DoxyCodeLine{259 scl\_dim1\_slice\_pos\_wvnm\_low\_ind = 1}
\DoxyCodeLine{260 scl\_dim1\_slice\_pos\_wvnm\_high\_ind = dim1\_len\_dim1\_slice/2 + 1}
\DoxyCodeLine{261 scl\_dim1\_slice\_neg\_wvnm\_high\_ind = dim1\_len\_scl\_dim1\_slice}
\DoxyCodeLine{262 \textcolor{keywordflow}{IF} (mod(dim1\_len\_dim1\_slice, 2) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{263   scl\_dim1\_slice\_neg\_wvnm\_low\_ind = dim1\_len\_dim1\_slice + 2}
\DoxyCodeLine{264 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (mod(dim1\_len\_dim1\_slice, 2) .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{265   scl\_dim1\_slice\_neg\_wvnm\_low\_ind = dim1\_len\_dim1\_slice + 1}
\DoxyCodeLine{266 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{267 }
\DoxyCodeLine{268 \textcolor{comment}{! Fill in dim1\_slice.}}
\DoxyCodeLine{269 dim1\_slice(1:dim1\_len\_dim1\_slice/2 + 1,:) = scl\_dim1\_slice( \&}
\DoxyCodeLine{270   \& scl\_dim1\_slice\_pos\_wvnm\_low\_ind:scl\_dim1\_slice\_pos\_wvnm\_high\_ind,:)}
\DoxyCodeLine{271 dim1\_slice(dim1\_len\_dim1\_slice/2 + 2:dim1\_len\_dim1\_slice,:) = scl\_dim1\_slice( \&}
\DoxyCodeLine{272   \& scl\_dim1\_slice\_neg\_wvnm\_low\_ind:scl\_dim1\_slice\_neg\_wvnm\_high\_ind,:)}
\DoxyCodeLine{273 }
\DoxyCodeLine{274 \textcolor{comment}{! At this point, we've scaled down in dim1. Now we must do the same for dim2.}}
\DoxyCodeLine{275 \textcolor{comment}{! Obtain the size of scl\_dim2\_slice.}}
\DoxyCodeLine{276   \textcolor{comment}{! Divide scl\_dim1\_len as evenly as possible.}}
\DoxyCodeLine{277 dim1\_len\_scl\_dim2\_slice = dim1\_len/proc\_count}
\DoxyCodeLine{278 \textcolor{keywordflow}{DO} i = 1, proc\_count}
\DoxyCodeLine{279   \textcolor{keywordflow}{IF} ((i -\/ 1) .LT. mod(dim1\_len, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{280     dim1\_len\_scl\_dim2\_slice\_list(i) = dim1\_len\_scl\_dim2\_slice + 1}
\DoxyCodeLine{281   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{282     dim1\_len\_scl\_dim2\_slice\_list(i) = dim1\_len\_scl\_dim2\_slice}
\DoxyCodeLine{283 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{284 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{285 dim1\_len\_scl\_dim2\_slice = dim1\_len\_scl\_dim2\_slice\_list(proc\_id + 1)}
\DoxyCodeLine{286 \textcolor{keyword}{CALL }mpi\_allreduce(dim2\_len\_scl\_dim1\_slice, dim2\_len\_scl\_dim2\_slice, 1, \&}
\DoxyCodeLine{287 \& mpi\_integer, mpi\_sum, mpi\_comm\_world, ierror)}
\DoxyCodeLine{288 \textcolor{keyword}{ALLOCATE}(scl\_dim2\_slice(dim1\_len\_scl\_dim2\_slice, dim2\_len\_scl\_dim2\_slice))}
\DoxyCodeLine{289 scl\_dim2\_slice = 0.0}
\DoxyCodeLine{290 }
\DoxyCodeLine{291 \textcolor{comment}{! Obtain dim2\_len\_dim1\_slice\_list for use in filling in scl\_dim2\_slices.}}
\DoxyCodeLine{292 dim2\_len\_dim1\_slice = dim2\_len\_scl\_dim2\_slice/proc\_count}
\DoxyCodeLine{293 \textcolor{keywordflow}{DO} i = 1, proc\_count}
\DoxyCodeLine{294   \textcolor{keywordflow}{IF} ((i -\/ 1) .LT. mod(dim2\_len\_scl\_dim2\_slice, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{295     dim2\_len\_dim1\_slice\_list(i) = dim2\_len\_dim1\_slice + 1}
\DoxyCodeLine{296   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{297     dim2\_len\_dim1\_slice\_list(i) = dim2\_len\_dim1\_slice}
\DoxyCodeLine{298 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{299 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{300 dim2\_len\_dim1\_slice = dim2\_len\_dim1\_slice\_list(proc\_id + 1)}
\DoxyCodeLine{301 }
\DoxyCodeLine{302 \textcolor{comment}{! Fill in scl\_dim2\_slice using sections from the dim1\_slices.}}
\DoxyCodeLine{303 \textcolor{keywordflow}{DO} i = 1, proc\_count}
\DoxyCodeLine{304   fill\_in\_proc\_trgt = mod(proc\_count -\/ proc\_id + i, proc\_count)}
\DoxyCodeLine{305   dim1\_high\_index\_dim1\_slice = \&}
\DoxyCodeLine{306   \& sum(dim1\_len\_scl\_dim2\_slice\_list(1:fill\_in\_proc\_trgt+1))}
\DoxyCodeLine{307   dim1\_low\_index\_dim1\_slice = dim1\_high\_index\_dim1\_slice \&}
\DoxyCodeLine{308   \& -\/ dim1\_len\_scl\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) + 1}
\DoxyCodeLine{309   dim2\_high\_index\_dim2\_slice = \&}
\DoxyCodeLine{310   \& sum(dim2\_len\_dim1\_slice\_list(1:fill\_in\_proc\_trgt+1))}
\DoxyCodeLine{311   dim2\_low\_index\_dim2\_slice = dim2\_high\_index\_dim2\_slice \&}
\DoxyCodeLine{312   \& -\/ dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1) + 1}
\DoxyCodeLine{313 }
\DoxyCodeLine{314   \textcolor{comment}{! If fill\_in\_proc\_trgt < proc\_id, RECV then SEND.}}
\DoxyCodeLine{315   \textcolor{keywordflow}{IF} (fill\_in\_proc\_trgt .LT. proc\_id) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{316 }
\DoxyCodeLine{317     \textcolor{keyword}{CALL }mpi\_recv( \&}
\DoxyCodeLine{318     \& scl\_dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice), \&}
\DoxyCodeLine{319     \& dim1\_len\_scl\_dim2\_slice\_list(proc\_id+1) \&}
\DoxyCodeLine{320     \& * dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1), mpi\_double\_complex, \&}
\DoxyCodeLine{321     \& fill\_in\_proc\_trgt, proc\_id, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{322 }
\DoxyCodeLine{323     \textcolor{keyword}{CALL }mpi\_send( \&}
\DoxyCodeLine{324     \& dim1\_slice(dim1\_low\_index\_dim1\_slice:dim1\_high\_index\_dim1\_slice,:), \&}
\DoxyCodeLine{325     \& dim1\_len\_scl\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) \&}
\DoxyCodeLine{326     \& * dim2\_len\_dim1\_slice\_list(proc\_id+1), mpi\_double\_complex, \&}
\DoxyCodeLine{327     \& fill\_in\_proc\_trgt, fill\_in\_proc\_trgt, mpi\_comm\_world, ierror)}
\DoxyCodeLine{328 }
\DoxyCodeLine{329   \textcolor{comment}{! If fill\_in\_proc\_trgt > proc\_id, SEND then RECV.}}
\DoxyCodeLine{330   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (fill\_in\_proc\_trgt .GT. proc\_id) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{331     \textcolor{keyword}{CALL }mpi\_send( \&}
\DoxyCodeLine{332     \& dim1\_slice(dim1\_low\_index\_dim1\_slice:dim1\_high\_index\_dim1\_slice,:), \&}
\DoxyCodeLine{333     \& dim1\_len\_scl\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) \&}
\DoxyCodeLine{334     \& * dim2\_len\_dim1\_slice\_list(proc\_id+1), mpi\_double\_complex, \&}
\DoxyCodeLine{335     \& fill\_in\_proc\_trgt, fill\_in\_proc\_trgt, mpi\_comm\_world, ierror)}
\DoxyCodeLine{336 }
\DoxyCodeLine{337     \textcolor{keyword}{CALL }mpi\_recv( \&}
\DoxyCodeLine{338     \& scl\_dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice), \&}
\DoxyCodeLine{339     \& dim1\_len\_scl\_dim2\_slice\_list(proc\_id+1) \&}
\DoxyCodeLine{340     \& * dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1), mpi\_double\_complex, \&}
\DoxyCodeLine{341     \& fill\_in\_proc\_trgt, proc\_id, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{342 }
\DoxyCodeLine{343   \textcolor{comment}{! If fill\_in\_proc\_trgt = proc\_id, then fill in dim2\_slice from your}}
\DoxyCodeLine{344   \textcolor{comment}{! dim1\_slice.}}
\DoxyCodeLine{345   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{346     scl\_dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice) = \&}
\DoxyCodeLine{347     \& dim1\_slice(dim1\_low\_index\_dim1\_slice:dim1\_high\_index\_dim1\_slice,:)}
\DoxyCodeLine{348 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{349 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{350 }
\DoxyCodeLine{351 \textcolor{comment}{! Scale the dim2 slice.}}
\DoxyCodeLine{352 dim1\_len\_dim2\_slice = dim1\_len\_scl\_dim2\_slice}
\DoxyCodeLine{353 \textcolor{comment}{! Obtain the size of the dim1\_slice (excluding overlap).}}
\DoxyCodeLine{354 dim2\_len\_dim1\_slice = dim2\_len}
\DoxyCodeLine{355 \textcolor{comment}{! Middle processor.}}
\DoxyCodeLine{356 \textcolor{keywordflow}{IF} (mod(proc\_id, proc\_count-\/1) .NE. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{357   dim2\_len\_dim1\_slice = dim2\_len -\/ 2 * overlap}
\DoxyCodeLine{358 \textcolor{comment}{! Processor 0 or proc\_count-\/1.}}
\DoxyCodeLine{359 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{360   dim2\_len\_dim1\_slice = dim2\_len -\/ overlap}
\DoxyCodeLine{361 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{362 \textcolor{keyword}{CALL }mpi\_allreduce(dim2\_len\_dim1\_slice, dim2\_len\_dim2\_slice, 1, \&}
\DoxyCodeLine{363 \& mpi\_integer, mpi\_sum, mpi\_comm\_world, ierror)}
\DoxyCodeLine{364 \textcolor{keyword}{ALLOCATE}(dim2\_slice(dim1\_len\_dim2\_slice, dim2\_len\_dim2\_slice))}
\DoxyCodeLine{365 dim2\_slice = 0.0}
\DoxyCodeLine{366 }
\DoxyCodeLine{367 \textcolor{comment}{! Determine the indices of scl\_dim2\_slice that go ino dim2\_slice entires.}}
\DoxyCodeLine{368 scl\_dim2\_slice\_pos\_wvnm\_low\_ind = 1}
\DoxyCodeLine{369 scl\_dim2\_slice\_pos\_wvnm\_high\_ind = dim2\_len\_dim2\_slice/2 + 1}
\DoxyCodeLine{370 scl\_dim2\_slice\_neg\_wvnm\_high\_ind = dim2\_len\_scl\_dim2\_slice}
\DoxyCodeLine{371 \textcolor{keywordflow}{IF} (mod(dim2\_len\_dim2\_slice, 2) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{372   scl\_dim2\_slice\_neg\_wvnm\_low\_ind = dim2\_len\_dim2\_slice + 2}
\DoxyCodeLine{373 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (mod(dim2\_len\_dim2\_slice, 2) .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{374   scl\_dim2\_slice\_neg\_wvnm\_low\_ind = dim2\_len\_dim2\_slice + 1}
\DoxyCodeLine{375 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{376 }
\DoxyCodeLine{377 \textcolor{comment}{! Fill in dim2\_slice.}}
\DoxyCodeLine{378 dim2\_slice(:,1:dim2\_len\_dim2\_slice/2 + 1) = scl\_dim2\_slice(:, \&}
\DoxyCodeLine{379   \& scl\_dim2\_slice\_pos\_wvnm\_low\_ind:scl\_dim2\_slice\_pos\_wvnm\_high\_ind)}
\DoxyCodeLine{380 dim2\_slice(:,dim2\_len\_dim2\_slice/2 + 2:dim2\_len\_dim2\_slice) = \&}
\DoxyCodeLine{381 \& scl\_dim2\_slice(:, \&}
\DoxyCodeLine{382   \& scl\_dim2\_slice\_neg\_wvnm\_low\_ind:scl\_dim2\_slice\_neg\_wvnm\_high\_ind)}
\DoxyCodeLine{383 }
\DoxyCodeLine{384 \textcolor{comment}{! We have now scaled down in dim2. Now to construct the dim1 slices and fill in}}
\DoxyCodeLine{385 \textcolor{comment}{! the smaller matix.}}
\DoxyCodeLine{386 \textcolor{comment}{! Reallocate dim1\_slice.}}
\DoxyCodeLine{387 \textcolor{keyword}{DEALLOCATE}(dim1\_slice)}
\DoxyCodeLine{388 dim1\_len\_dim1\_slice = dim1\_len}
\DoxyCodeLine{389 \textcolor{comment}{! Evenly divide dim2\_len of the matrix.}}
\DoxyCodeLine{390 dim2\_len\_dim1\_slice = dim2\_len\_dim2\_slice/proc\_count}
\DoxyCodeLine{391 \textcolor{keywordflow}{DO} i = 1, proc\_count}
\DoxyCodeLine{392   \textcolor{keywordflow}{IF} ((i-\/1) .LT. modulo(dim2\_len\_dim2\_slice, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{393     dim2\_len\_dim1\_slice\_list(i) = dim2\_len\_dim1\_slice + 1}
\DoxyCodeLine{394     \textcolor{comment}{! The indexing is weird here since processors start at index 0 but arrays}}
\DoxyCodeLine{395     \textcolor{comment}{! start at index 1. Thus, entry ii of this corresponds to processor (ii-\/1).}}
\DoxyCodeLine{396   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{397     dim2\_len\_dim1\_slice\_list(i) = dim2\_len\_dim1\_slice}
\DoxyCodeLine{398 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{399 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{400 dim2\_len\_dim1\_slice = dim2\_len\_dim1\_slice\_list(proc\_id + 1)}
\DoxyCodeLine{401 \textcolor{keyword}{ALLOCATE}(dim1\_slice(dim1\_len\_dim1\_slice,dim2\_len\_dim1\_slice))}
\DoxyCodeLine{402 dim1\_slice = 0.0}
\DoxyCodeLine{403 }
\DoxyCodeLine{404 \textcolor{comment}{! Obtain dim1\_len\_dim2\_slice\_list for section communication.}}
\DoxyCodeLine{405 dim1\_len\_dim2\_slice = dim1\_len/proc\_count}
\DoxyCodeLine{406 \textcolor{keywordflow}{DO} i = 1, proc\_count}
\DoxyCodeLine{407   \textcolor{keywordflow}{IF} ((i-\/1) .LT. modulo(dim1\_len, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{408     dim1\_len\_dim2\_slice\_list(i) = dim1\_len\_dim2\_slice + 1}
\DoxyCodeLine{409     \textcolor{comment}{! The indexing is weird here since processors start at index 0 but arrays}}
\DoxyCodeLine{410     \textcolor{comment}{! start at index 1. Thus, entry i of this corresponds to processor (i-\/1).}}
\DoxyCodeLine{411   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{412     dim1\_len\_dim2\_slice\_list(i) = dim1\_len\_dim2\_slice}
\DoxyCodeLine{413 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{414 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{415 dim1\_len\_dim2\_slice = dim1\_len\_dim2\_slice\_list(proc\_id + 1)}
\DoxyCodeLine{416 }
\DoxyCodeLine{417 \textcolor{comment}{! Fill in dim1\_slice using sections from the dim2\_slices.}}
\DoxyCodeLine{418 \textcolor{keywordflow}{DO} i = 1, proc\_count}
\DoxyCodeLine{419   fill\_in\_proc\_trgt = mod(proc\_count -\/ proc\_id + i, proc\_count)}
\DoxyCodeLine{420   dim1\_high\_index\_dim1\_slice = \&}
\DoxyCodeLine{421   \& sum(dim1\_len\_dim2\_slice\_list(1:fill\_in\_proc\_trgt+1))}
\DoxyCodeLine{422   dim1\_low\_index\_dim1\_slice = dim1\_high\_index\_dim1\_slice \&}
\DoxyCodeLine{423   \& -\/ dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) + 1}
\DoxyCodeLine{424   dim2\_high\_index\_dim2\_slice = \&}
\DoxyCodeLine{425   \& sum(dim2\_len\_dim1\_slice\_list(1:fill\_in\_proc\_trgt+1))}
\DoxyCodeLine{426   dim2\_low\_index\_dim2\_slice = dim2\_high\_index\_dim2\_slice \&}
\DoxyCodeLine{427   \& -\/ dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1) + 1}
\DoxyCodeLine{428 }
\DoxyCodeLine{429   \textcolor{comment}{! If fill\_in\_proc\_trgt < proc\_id, RECV then SEND.}}
\DoxyCodeLine{430   \textcolor{keywordflow}{IF} (fill\_in\_proc\_trgt .LT. proc\_id) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{431     \textcolor{keyword}{CALL }mpi\_recv( \&}
\DoxyCodeLine{432     \& dim1\_slice(dim1\_low\_index\_dim1\_slice:dim1\_high\_index\_dim1\_slice,:), \&}
\DoxyCodeLine{433     \& dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) \&}
\DoxyCodeLine{434     \& * dim2\_len\_dim1\_slice\_list(proc\_id+1), mpi\_double\_complex, \&}
\DoxyCodeLine{435     \& fill\_in\_proc\_trgt, proc\_id, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{436 }
\DoxyCodeLine{437     \textcolor{keyword}{CALL }mpi\_send( \&}
\DoxyCodeLine{438     \& dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice), \&}
\DoxyCodeLine{439     \& dim1\_len\_dim2\_slice\_list(proc\_id+1) \&}
\DoxyCodeLine{440     \& * dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1), mpi\_double\_complex, \&}
\DoxyCodeLine{441     \& fill\_in\_proc\_trgt, fill\_in\_proc\_trgt, mpi\_comm\_world, ierror)}
\DoxyCodeLine{442 }
\DoxyCodeLine{443   \textcolor{comment}{! If fill\_in\_proc\_trgt > proc\_id, SEND then RECV.}}
\DoxyCodeLine{444   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (fill\_in\_proc\_trgt .GT. proc\_id) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{445     \textcolor{keyword}{CALL }mpi\_send( \&}
\DoxyCodeLine{446     \& dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice), \&}
\DoxyCodeLine{447     \& dim1\_len\_dim2\_slice\_list(proc\_id+1) \&}
\DoxyCodeLine{448     \& * dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1), mpi\_double\_complex, \&}
\DoxyCodeLine{449     \& fill\_in\_proc\_trgt, fill\_in\_proc\_trgt, mpi\_comm\_world, ierror)}
\DoxyCodeLine{450 }
\DoxyCodeLine{451     \textcolor{keyword}{CALL }mpi\_recv( \&}
\DoxyCodeLine{452     \& dim1\_slice(dim1\_low\_index\_dim1\_slice:dim1\_high\_index\_dim1\_slice,:), \&}
\DoxyCodeLine{453     \& dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) \&}
\DoxyCodeLine{454     \& * dim2\_len\_dim1\_slice\_list(proc\_id+1), mpi\_double\_complex, \&}
\DoxyCodeLine{455     \& fill\_in\_proc\_trgt, proc\_id, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{456 }
\DoxyCodeLine{457   \textcolor{comment}{! If fill\_in\_proc\_trgt = proc\_id, then fill in dim2\_slice from your}}
\DoxyCodeLine{458   \textcolor{comment}{! dim1\_slice.}}
\DoxyCodeLine{459   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{460     dim1\_slice(dim1\_low\_index\_dim1\_slice:dim1\_high\_index\_dim1\_slice,:) = \&}
\DoxyCodeLine{461     \& dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice)}
\DoxyCodeLine{462 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{463 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{464 }
\DoxyCodeLine{465 \textcolor{comment}{! Use dim1\_slices to file in the interiors of matrix, and then call}}
\DoxyCodeLine{466 \textcolor{comment}{! SHARE\_SUBGRID\_BOUNDARIES to fill in the boundaries of the sub-\/grids.}}
\DoxyCodeLine{467 }
\DoxyCodeLine{468 \textcolor{comment}{! Fill in interior of matrix.}}
\DoxyCodeLine{469 \textcolor{keywordflow}{IF} (proc\_id .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{470   \textcolor{comment}{! First processor, fill in all except last part along dimension 2 of matrix.}}
\DoxyCodeLine{471   matrix(:, 1:dim2\_len-\/overlap) = dim1\_slice}
\DoxyCodeLine{472 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (proc\_id .EQ. proc\_count-\/1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{473   \textcolor{comment}{! Last processor, fill in all but first part along dimension 2 of matrix.}}
\DoxyCodeLine{474   matrix(:, 1+overlap:dim2\_len) = dim1\_slice}
\DoxyCodeLine{475 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{476   \textcolor{comment}{! Middle processor, fill in all but first and last part along dimension 2 of}}
\DoxyCodeLine{477   \textcolor{comment}{! matrix.}}
\DoxyCodeLine{478   matrix(:, 1+overlap:dim2\_len-\/overlap) = dim1\_slice}
\DoxyCodeLine{479 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{480 }
\DoxyCodeLine{481 }
\DoxyCodeLine{482 \textcolor{keyword}{CALL }\mbox{\hyperlink{share__subgrid__boundaries__dble__cmplx_8f_ab72aac7a19e9dd8ef60d8f704a8aa7e4}{share\_subgrid\_boundaries\_dble\_cmplx\_ezp}}(dim1\_len, dim2\_len, overlap, matrix)}
\DoxyCodeLine{483 }
\DoxyCodeLine{484 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}}
\DoxyCodeLine{485 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{486 }
\DoxyCodeLine{487 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{488 \textcolor{comment}{! ERROR\_HANDLING. Checks for input error and other possible complications.}}
\DoxyCodeLine{489 \textcolor{comment}{!}}
\DoxyCodeLine{490 \textcolor{comment}{! ERRORS TO CHECK: -\/ error1.}}
\DoxyCodeLine{491 \textcolor{comment}{!}}
\DoxyCodeLine{492 \textcolor{comment}{! VARIABLES: -\/ proc\_id: Processor ID (INTEGER).}}
\DoxyCodeLine{493 \textcolor{comment}{! -\/ proc\_err\_flag -\/ Flag is triggered if processor encounters an error}}
\DoxyCodeLine{494 \textcolor{comment}{! (LOGICAL).}}
\DoxyCodeLine{495 \textcolor{comment}{! -\/ global\_err\_flag -\/ Flag is triggered if any processor encouters an error}}
\DoxyCodeLine{496 \textcolor{comment}{! (LOGICAL).}}
\DoxyCodeLine{497 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{498 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}(proc\_id)}
\DoxyCodeLine{499 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{500 }
\DoxyCodeLine{501 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{502 }
\DoxyCodeLine{503 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{504 }
\DoxyCodeLine{505 \textcolor{keywordtype}{INTEGER} :: proc\_id}
\DoxyCodeLine{506 \textcolor{keywordtype}{LOGICAL} :: proc\_err\_flag, \&}
\DoxyCodeLine{507 \& global\_err\_flag}
\DoxyCodeLine{508 }
\DoxyCodeLine{509 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{510 }
\DoxyCodeLine{511 proc\_err\_flag = .false.}
\DoxyCodeLine{512 global\_err\_flag = .false.}
\DoxyCodeLine{513 }
\DoxyCodeLine{514 \textcolor{comment}{! error 1.}}
\DoxyCodeLine{515 \textcolor{comment}{!IF (error1) THEN}}
\DoxyCodeLine{516 \textcolor{comment}{!  proc\_err\_flag = .TRUE.}}
\DoxyCodeLine{517 \textcolor{comment}{!  PRINT *, 'EZ\_PARALLEL: Issue with processor ', proc\_id, ' in subroutine ', \&}}
\DoxyCodeLine{518 \textcolor{comment}{!  \& 'call SUBROUTINE\_NAME. order: ', order, ' is less ', \&}}
\DoxyCodeLine{519 \textcolor{comment}{!  \& 'than 1. Please increase the order.'}}
\DoxyCodeLine{520 \textcolor{comment}{!END IF}}
\DoxyCodeLine{521 }
\DoxyCodeLine{522 \textcolor{comment}{! STOP all processors if any encounter an error.}}
\DoxyCodeLine{523 \textcolor{keyword}{CALL }mpi\_allreduce(proc\_err\_flag, global\_err\_flag, 1, mpi\_logical, mpi\_lor, \&}
\DoxyCodeLine{524 \& mpi\_comm\_world, ierror)}
\DoxyCodeLine{525 }
\DoxyCodeLine{526 \textcolor{keywordflow}{IF} (global\_err\_flag) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{527   \textcolor{keyword}{CALL }mpi\_finalize(ierror)}
\DoxyCodeLine{528   stop}
\DoxyCodeLine{529 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{530 }
\DoxyCodeLine{531 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{532 }
\DoxyCodeLine{533 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}}
\DoxyCodeLine{534 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{535 }

\end{DoxyCode}
