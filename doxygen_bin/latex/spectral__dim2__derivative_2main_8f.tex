\hypertarget{spectral__dim2__derivative_2main_8f}{}\doxysection{C\+:/\+Users/\+Owner/\+Education and Research/\+Graduate School/\+Parallelization Module Project/\+E\+Z\+\_\+\+P\+A\+R\+A\+L\+L\+E\+L\+\_\+project/unit\+\_\+tests/spectral\+\_\+dim2\+\_\+derivative/main.f File Reference}
\label{spectral__dim2__derivative_2main_8f}\index{C:/Users/Owner/Education and Research/Graduate School/Parallelization Module Project/EZ\_PARALLEL\_project/unit\_tests/spectral\_dim2\_derivative/main.f@{C:/Users/Owner/Education and Research/Graduate School/Parallelization Module Project/EZ\_PARALLEL\_project/unit\_tests/spectral\_dim2\_derivative/main.f}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
program \mbox{\hyperlink{spectral__dim2__derivative_2main_8f_a1e38a62e97bb73156b1a7e4a90947ed4}{spectral\+\_\+dim2\+\_\+derivative\+\_\+unit\+\_\+test}}
\item 
subroutine \mbox{\hyperlink{spectral__dim2__derivative_2main_8f_a15cc15c693d3b7862febd19a2538b7f8}{main}}
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{spectral__dim2__derivative_2main_8f_a15cc15c693d3b7862febd19a2538b7f8}\label{spectral__dim2__derivative_2main_8f_a15cc15c693d3b7862febd19a2538b7f8}} 
\index{main.f@{main.f}!main@{main}}
\index{main@{main}!main.f@{main.f}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily subroutine spectral\+\_\+dim2\+\_\+derivative\+\_\+unit\+\_\+test\+::main}


\begin{DoxyCode}{0}
\DoxyCodeLine{39 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{42 }
\DoxyCodeLine{43 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{44 }
\DoxyCodeLine{45 \textcolor{keywordtype}{INTEGER(qb)} :: dim1\_len, \&}
\DoxyCodeLine{46 \& dim2\_len, \&}
\DoxyCodeLine{47 \& overlap, \&}
\DoxyCodeLine{48 \& order, \&}
\DoxyCodeLine{49 \& i, \&}
\DoxyCodeLine{50 \& j, \&}
\DoxyCodeLine{51 \& proc\_id, \&}
\DoxyCodeLine{52 \& proc\_count, \&}
\DoxyCodeLine{53 \& ierror}
\DoxyCodeLine{54 \textcolor{keywordtype}{REAL(dp)} :: dim1\_ref, \&}
\DoxyCodeLine{55 \& dim2\_ref, \&}
\DoxyCodeLine{56 \& dim1\_spc, \&}
\DoxyCodeLine{57 \& dim2\_spc}
\DoxyCodeLine{58 \textcolor{keywordtype}{COMPLEX(dp)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{ALLOCATABLE} :: spec\_dim2\_deriv, \&}
\DoxyCodeLine{59 \& test\_grid(:,:)}
\DoxyCodeLine{60 \textcolor{keywordtype}{REAL(dp)}, \textcolor{keywordtype}{PARAMETER} :: pi\_dp = 4.0\_dp * atan(1.0\_dp)}
\DoxyCodeLine{61 \textcolor{keywordtype}{CHARACTER(len=14)} :: output\_format\_1, \&}
\DoxyCodeLine{62 \& output\_format\_2}
\DoxyCodeLine{63 }
\DoxyCodeLine{64 namelist /test\_params/ dim1\_len, dim2\_len, overlap, dim1\_ref, dim2\_ref, \&}
\DoxyCodeLine{65 \& dim1\_spc, dim2\_spc, order}
\DoxyCodeLine{66 \textcolor{keyword}{OPEN}(1000, file = \textcolor{stringliteral}{'NAMELIST'})}
\DoxyCodeLine{67 \textcolor{keyword}{READ}(1000, nml = test\_params)}
\DoxyCodeLine{68 \textcolor{keyword}{CLOSE}(1000)}
\DoxyCodeLine{69 }
\DoxyCodeLine{70 \textcolor{comment}{! Create format string for output grid.}}
\DoxyCodeLine{71 \textcolor{keyword}{WRITE}(output\_format\_1,\textcolor{stringliteral}{'(A,I0.8,A)'}) \textcolor{stringliteral}{'('}, dim1\_len, \textcolor{stringliteral}{'F8.4)'}}
\DoxyCodeLine{72 \textcolor{keyword}{WRITE}(output\_format\_2,\textcolor{stringliteral}{'(A,I0.8,A)'}) \textcolor{stringliteral}{'('}, 2\_qb * dim1\_len, \textcolor{stringliteral}{'F8.4)'}}
\DoxyCodeLine{73 }
\DoxyCodeLine{74 \textcolor{keyword}{CALL }\mbox{\hyperlink{init__mpi_8f_a9f981f068ebbfa17378e60c81aeb0056}{init\_mpi\_ezp}}}
\DoxyCodeLine{75 \textcolor{keyword}{CALL }\mbox{\hyperlink{get__id_8f_a091a155bf3e810603ef253fa4be15bb2}{get\_id\_ezp}}(proc\_id)}
\DoxyCodeLine{76 \textcolor{keyword}{CALL }mpi\_comm\_size(mpi\_comm\_world, proc\_count, ierror)}
\DoxyCodeLine{77 }
\DoxyCodeLine{78 \textcolor{comment}{! Output dimensions of grid using processor 0.}}
\DoxyCodeLine{79 \textcolor{keywordflow}{IF} (proc\_id .EQ. 0\_qb) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{80   print *, \textcolor{stringliteral}{'dim1\_len\_total: '}, dim1\_len, \textcolor{stringliteral}{' dim2\_len\_total: '}, dim2\_len, \&}
\DoxyCodeLine{81   \& \textcolor{stringliteral}{' overlap: '}, overlap}
\DoxyCodeLine{82   print *, \textcolor{stringliteral}{'dim1\_ref: '}, dim1\_ref, \textcolor{stringliteral}{' dim2\_ref: '}, dim2\_ref, \textcolor{stringliteral}{' dim1\_spc: '}, \&}
\DoxyCodeLine{83   \& dim1\_spc, \textcolor{stringliteral}{' dim2\_spc: '}, dim2\_spc}
\DoxyCodeLine{84   print *, \textcolor{stringliteral}{'order: '}, order}
\DoxyCodeLine{85 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{86 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{87 }
\DoxyCodeLine{88 \textcolor{comment}{! Fill in the test grid.}}
\DoxyCodeLine{89 \textcolor{keyword}{CALL }\mbox{\hyperlink{decomp__grid_8f_a3d23c951820c059e318e5c68e781e165}{decomp\_grid\_ezp}}(dim2\_len, overlap)}
\DoxyCodeLine{90 \textcolor{comment}{! Each processor prints out its dim2\_len.}}
\DoxyCodeLine{91 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{92 \textcolor{keywordflow}{DO} i = 0, proc\_count-\/1}
\DoxyCodeLine{93   \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{94   \textcolor{keywordflow}{IF} (proc\_id .EQ. i) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{95     print *, \textcolor{stringliteral}{'proc\_id: '}, proc\_id, \textcolor{stringliteral}{' dim2\_len: '}, dim2\_len}
\DoxyCodeLine{96     \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{97   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{98     \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{99 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{100 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{101 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{102 }
\DoxyCodeLine{103 \textcolor{keyword}{CALL }\mbox{\hyperlink{identify__ref__point_8f_ac016bc84d13cb001edb3210843abc4c2}{identify\_ref\_point\_ezp}}(dim2\_len, dim2\_ref, dim2\_spc, overlap)}
\DoxyCodeLine{104 \textcolor{comment}{! Each processor prints out its reference point.}}
\DoxyCodeLine{105 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{106 \textcolor{keywordflow}{DO} i = 0, proc\_count-\/1}
\DoxyCodeLine{107   \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{108   \textcolor{keywordflow}{IF} (proc\_id .EQ. i) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{109     print *, \textcolor{stringliteral}{'proc\_id: '}, proc\_id, \textcolor{stringliteral}{' dim1\_ref: '}, dim1\_ref, \textcolor{stringliteral}{' dim2\_ref: '}, \&}
\DoxyCodeLine{110     \& dim2\_ref}
\DoxyCodeLine{111   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{112     \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{113 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{114 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{115 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{116 }
\DoxyCodeLine{117 \textcolor{keyword}{ALLOCATE}(test\_grid(dim1\_len, dim2\_len))}
\DoxyCodeLine{118 test\_grid = (0.0\_dp, 0.0\_dp)}
\DoxyCodeLine{119 \textcolor{keywordflow}{DO} j = 1, dim2\_len}
\DoxyCodeLine{120   \textcolor{keywordflow}{DO} i = 1, dim1\_len}
\DoxyCodeLine{121     test\_grid(i,j) = sin((dim2\_ref + real(j-\/1\_qb, dp) * dim2\_spc) * pi\_dp)}
\DoxyCodeLine{122 \textcolor{keywordflow}{  END DO}}
\DoxyCodeLine{123 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{124 }
\DoxyCodeLine{125 \textcolor{comment}{! Each processor prints out its test\_grid.}}
\DoxyCodeLine{126 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{127 \textcolor{keywordflow}{DO} i = 0, proc\_count-\/1}
\DoxyCodeLine{128   \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{129   \textcolor{keywordflow}{IF} (proc\_id .EQ. i) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{130     print *, \textcolor{stringliteral}{'proc\_id: '}, proc\_id, \textcolor{stringliteral}{' test\_grid: '}}
\DoxyCodeLine{131     \textcolor{keywordflow}{DO} j = 1, dim2\_len}
\DoxyCodeLine{132       \textcolor{keyword}{WRITE}(*, output\_format\_1) real(test\_grid(:,j), dp)}
\DoxyCodeLine{133 \textcolor{keywordflow}{    END DO}}
\DoxyCodeLine{134     \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{135   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{136     \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{137 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{138 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{139 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{140 }
\DoxyCodeLine{141 \textcolor{comment}{! Get spectral dim2 derivative matrix.}}
\DoxyCodeLine{142 \textcolor{keyword}{ALLOCATE}(spec\_dim2\_deriv(dim1\_len, dim2\_len))}
\DoxyCodeLine{143 spec\_dim2\_deriv = (0.0\_dp, 0.0\_dp)}
\DoxyCodeLine{144 \textcolor{keyword}{CALL }\mbox{\hyperlink{spectral__dim2__derivative_8f_a852387db32f0e275bd7d81b55761ff65}{spectral\_dim2\_derivative\_ezp}}(dim1\_len, dim2\_len, overlap, spec\_dim2\_deriv, \&}
\DoxyCodeLine{145 \& order)}
\DoxyCodeLine{146 }
\DoxyCodeLine{147 \textcolor{comment}{! Each processor prints out its spec\_dim2\_deriv.}}
\DoxyCodeLine{148 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{149 \textcolor{keywordflow}{DO} i = 0, proc\_count-\/1}
\DoxyCodeLine{150   \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{151   \textcolor{keywordflow}{IF} (proc\_id .EQ. i) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{152     print *, \textcolor{stringliteral}{'proc\_id: '}, proc\_id, \textcolor{stringliteral}{' spec\_dim2\_deriv: '}}
\DoxyCodeLine{153     \textcolor{keywordflow}{DO} j = 1, dim2\_len}
\DoxyCodeLine{154       \textcolor{keyword}{WRITE}(*, output\_format\_2) spec\_dim2\_deriv(:,j)}
\DoxyCodeLine{155 \textcolor{keywordflow}{    END DO}}
\DoxyCodeLine{156     \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{157   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{158     \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{159 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{160 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{161 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{162 }
\DoxyCodeLine{163 \textcolor{comment}{! Differentiate test\_grid along dim2.}}
\DoxyCodeLine{164 \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2df_8f_adff7cfcd1f911f1dc00debad125fe530}{cfft2df\_ezp}}(dim1\_len, dim2\_len, overlap, test\_grid)}
\DoxyCodeLine{165 test\_grid = spec\_dim2\_deriv * test\_grid}
\DoxyCodeLine{166 \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_a85dec28129199285c17927fb1dcd3836}{cfft2db\_ezp}}(dim1\_len, dim2\_len, overlap, test\_grid)}
\DoxyCodeLine{167 }
\DoxyCodeLine{168 \textcolor{comment}{! Write out test grid.}}
\DoxyCodeLine{169 \textcolor{keywordflow}{DO} j = 1, dim2\_len}
\DoxyCodeLine{170   \textcolor{keywordflow}{DO} i = 1, dim1\_len}
\DoxyCodeLine{171     test\_grid(i,j) = test\_grid(i,j)}
\DoxyCodeLine{172     \textcolor{comment}{! Order 1 derivative -\/ COS((dim2\_ref + REAL(j-\/1\_qb, dp) * dim2\_spc) * pi\_dp)}}
\DoxyCodeLine{173 \textcolor{keywordflow}{  END DO}}
\DoxyCodeLine{174 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{175 \textcolor{comment}{! Each processor prints out its test\_grid.}}
\DoxyCodeLine{176 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{177 \textcolor{keywordflow}{DO} i = 0, proc\_count-\/1}
\DoxyCodeLine{178   \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{179   \textcolor{keywordflow}{IF} (proc\_id .EQ. i) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{180     print *, \textcolor{stringliteral}{'proc\_id: '}, proc\_id, \textcolor{stringliteral}{' output test\_grid: '}}
\DoxyCodeLine{181     \textcolor{keywordflow}{DO} j = 1, dim2\_len}
\DoxyCodeLine{182       \textcolor{keyword}{WRITE}(*, output\_format\_1) real(test\_grid(:,j), dp)}
\DoxyCodeLine{183 \textcolor{keywordflow}{    END DO}}
\DoxyCodeLine{184     \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{185   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{186     \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{187 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{188 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{189 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{190 }
\DoxyCodeLine{191 \textcolor{keyword}{CALL }\mbox{\hyperlink{fin__mpi_8f_ad9592fceaa187ad8c5d3e5ec6844d22f}{fin\_mpi\_ezp}}}
\DoxyCodeLine{192 }
\DoxyCodeLine{193 \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{194 }

\end{DoxyCode}
\mbox{\Hypertarget{spectral__dim2__derivative_2main_8f_a1e38a62e97bb73156b1a7e4a90947ed4}\label{spectral__dim2__derivative_2main_8f_a1e38a62e97bb73156b1a7e4a90947ed4}} 
\index{main.f@{main.f}!spectral\_dim2\_derivative\_unit\_test@{spectral\_dim2\_derivative\_unit\_test}}
\index{spectral\_dim2\_derivative\_unit\_test@{spectral\_dim2\_derivative\_unit\_test}!main.f@{main.f}}
\doxysubsubsection{\texorpdfstring{spectral\_dim2\_derivative\_unit\_test()}{spectral\_dim2\_derivative\_unit\_test()}}
{\footnotesize\ttfamily program spectral\+\_\+dim2\+\_\+derivative\+\_\+unit\+\_\+test}

