\hypertarget{share__subgrid__boundaries__dble__real_8f}{}\doxysection{C\+:/\+Users/\+Owner/\+Education and Research/\+Graduate School/\+Parallelization Module Project/\+E\+Z\+\_\+\+P\+A\+R\+A\+L\+L\+E\+L\+\_\+project/\+E\+Z\+\_\+\+P\+A\+R\+A\+L\+L\+E\+L/share\+\_\+subgrid\+\_\+boundaries\+\_\+dble\+\_\+real.f File Reference}
\label{share__subgrid__boundaries__dble__real_8f}\index{C:/Users/Owner/Education and Research/Graduate School/Parallelization Module Project/EZ\_PARALLEL\_project/EZ\_PARALLEL/share\_subgrid\_boundaries\_dble\_real.f@{C:/Users/Owner/Education and Research/Graduate School/Parallelization Module Project/EZ\_PARALLEL\_project/EZ\_PARALLEL/share\_subgrid\_boundaries\_dble\_real.f}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{share__subgrid__boundaries__dble__real_8f_a5170f5c15842e65d901113fc48dfe97a}{share\+\_\+subgrid\+\_\+boundaries\+\_\+dble\+\_\+real\+\_\+ezp}} (dim1\+\_\+len, dim2\+\_\+len, overlap, sub\+\_\+grid)
\item 
subroutine \mbox{\hyperlink{share__subgrid__boundaries__dble__real_8f_a62f18c373f73b73503511f5db249c3a7}{serial}}
\item 
subroutine \mbox{\hyperlink{share__subgrid__boundaries__dble__real_8f_a756eefa398fb7b38c797dde2adda5816}{parallel}} (dim1\+\_\+len, dim2\+\_\+len, overlap, sub\+\_\+grid, proc\+\_\+id, proc\+\_\+count)
\item 
subroutine \mbox{\hyperlink{share__subgrid__boundaries__dble__real_8f_a2080767509a6ad0ef3843bd263daa355}{error\+\_\+handling}} (proc\+\_\+id)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{share__subgrid__boundaries__dble__real_8f_a2080767509a6ad0ef3843bd263daa355}\label{share__subgrid__boundaries__dble__real_8f_a2080767509a6ad0ef3843bd263daa355}} 
\index{share\_subgrid\_boundaries\_dble\_real.f@{share\_subgrid\_boundaries\_dble\_real.f}!error\_handling@{error\_handling}}
\index{error\_handling@{error\_handling}!share\_subgrid\_boundaries\_dble\_real.f@{share\_subgrid\_boundaries\_dble\_real.f}}
\doxysubsubsection{\texorpdfstring{error\_handling()}{error\_handling()}}
{\footnotesize\ttfamily subroutine share\+\_\+subgrid\+\_\+boundaries\+\_\+dble\+\_\+real\+\_\+ezp\+::error\+\_\+handling (\begin{DoxyParamCaption}\item[{integer}]{proc\+\_\+id }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{227 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{228 }
\DoxyCodeLine{229 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{230 }
\DoxyCodeLine{231 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{232 }
\DoxyCodeLine{233 \textcolor{keywordtype}{INTEGER} :: proc\_id}
\DoxyCodeLine{234 \textcolor{keywordtype}{LOGICAL} :: proc\_err\_flag, \&}
\DoxyCodeLine{235 \& global\_err\_flag}
\DoxyCodeLine{236 }
\DoxyCodeLine{237 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{238 }
\DoxyCodeLine{239 proc\_err\_flag = .false.}
\DoxyCodeLine{240 global\_err\_flag = .false.}
\DoxyCodeLine{241 }
\DoxyCodeLine{242 \textcolor{comment}{! STOP all processors if any encounter an error.}}
\DoxyCodeLine{243 \textcolor{keyword}{CALL }mpi\_allreduce(proc\_err\_flag, global\_err\_flag, 1, mpi\_logical, mpi\_lor, \&}
\DoxyCodeLine{244 \& mpi\_comm\_world, ierror)}
\DoxyCodeLine{245 }
\DoxyCodeLine{246 \textcolor{keywordflow}{IF} (global\_err\_flag) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{247   \textcolor{keyword}{CALL }mpi\_finalize(ierror)}
\DoxyCodeLine{248   stop}
\DoxyCodeLine{249 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{250 }
\DoxyCodeLine{251 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{252 }

\end{DoxyCode}
\mbox{\Hypertarget{share__subgrid__boundaries__dble__real_8f_a756eefa398fb7b38c797dde2adda5816}\label{share__subgrid__boundaries__dble__real_8f_a756eefa398fb7b38c797dde2adda5816}} 
\index{share\_subgrid\_boundaries\_dble\_real.f@{share\_subgrid\_boundaries\_dble\_real.f}!parallel@{parallel}}
\index{parallel@{parallel}!share\_subgrid\_boundaries\_dble\_real.f@{share\_subgrid\_boundaries\_dble\_real.f}}
\doxysubsubsection{\texorpdfstring{parallel()}{parallel()}}
{\footnotesize\ttfamily subroutine share\+\_\+subgrid\+\_\+boundaries\+\_\+dble\+\_\+real\+\_\+ezp\+::parallel (\begin{DoxyParamCaption}\item[{integer}]{dim1\+\_\+len,  }\item[{integer}]{dim2\+\_\+len,  }\item[{integer}]{overlap,  }\item[{double precision, dimension(\mbox{\hyperlink{cfft2df__unit__test__MATLAB_8m_acb4b6a591c5ad6fc207ef543dc74d1ae}{dim1\+\_\+len}}, \mbox{\hyperlink{cfft2df__unit__test__MATLAB_8m_adef80e51b1bb5916dd9410de399f1319}{dim2\+\_\+len}})}]{sub\+\_\+grid,  }\item[{integer}]{proc\+\_\+id,  }\item[{integer}]{proc\+\_\+count }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{94 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{95 }
\DoxyCodeLine{96 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{97 }
\DoxyCodeLine{98 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{99 }
\DoxyCodeLine{100 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{101 \& dim2\_len, \&}
\DoxyCodeLine{102 \& overlap, \&}
\DoxyCodeLine{103 \& proc\_id, \&}
\DoxyCodeLine{104 \& proc\_count, \&}
\DoxyCodeLine{105 \& prev\_send\_tag, \&}
\DoxyCodeLine{106 \& next\_recv\_tag, \&}
\DoxyCodeLine{107 \& next\_send\_tag, \&}
\DoxyCodeLine{108 \& prev\_recv\_tag, \&}
\DoxyCodeLine{109 \& ierror, \&}
\DoxyCodeLine{110 \& status(MPI\_STATUS\_SIZE)}
\DoxyCodeLine{111 \textcolor{keywordtype}{DOUBLE PRECISION}, \textcolor{keywordtype}{DIMENSION(dim1\_len, dim2\_len)} :: sub\_grid}
\DoxyCodeLine{112 \textcolor{keywordtype}{DOUBLE PRECISION}, \textcolor{keywordtype}{DIMENSION(dim1\_len, overlap)} :: next\_send\_boundary, \&}
\DoxyCodeLine{113 \& prev\_send\_boundary, \&}
\DoxyCodeLine{114 \& next\_recv\_boundary, \&}
\DoxyCodeLine{115 \& prev\_recv\_boundary}
\DoxyCodeLine{116 }
\DoxyCodeLine{117 prev\_send\_tag = 12}
\DoxyCodeLine{118 next\_recv\_tag = prev\_send\_tag}
\DoxyCodeLine{119 next\_send\_tag = 93}
\DoxyCodeLine{120 prev\_recv\_tag = next\_send\_tag}
\DoxyCodeLine{121 }
\DoxyCodeLine{122 next\_send\_boundary = 0.0}
\DoxyCodeLine{123 prev\_send\_boundary = 0.0}
\DoxyCodeLine{124 next\_recv\_boundary = 0.0}
\DoxyCodeLine{125 prev\_recv\_boundary = 0.0}
\DoxyCodeLine{126 }
\DoxyCodeLine{127 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{128 \textcolor{comment}{! Communicate boundary points of my subgrid to neighbors. 3 Cases:}}
\DoxyCodeLine{129 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{130 \textcolor{comment}{! 1. Interior subgrid, needs to send both of its boundary vectors.}}
\DoxyCodeLine{131 \textcolor{keywordflow}{IF} (modulo(proc\_id, proc\_count-\/1) .NE. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{132   next\_send\_boundary = sub\_grid(:,dim2\_len-\/2*overlap+1:dim2\_len-\/overlap)}
\DoxyCodeLine{133   prev\_send\_boundary = sub\_grid(:,overlap+1:2*overlap)}
\DoxyCodeLine{134 }
\DoxyCodeLine{135   \textcolor{comment}{! For buffering, even processors SEND/RECV and odd ones RECV/SEND.}}
\DoxyCodeLine{136   \textcolor{keywordflow}{IF} (modulo(proc\_id, 2) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{137     \textcolor{keyword}{CALL }mpi\_send(next\_send\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{138     \&  proc\_id+1, next\_send\_tag, mpi\_comm\_world, ierror)}
\DoxyCodeLine{139     \textcolor{keyword}{CALL }mpi\_send(prev\_send\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{140     \&  proc\_id-\/1, prev\_send\_tag, mpi\_comm\_world, ierror)}
\DoxyCodeLine{141 }
\DoxyCodeLine{142     \textcolor{keyword}{CALL }mpi\_recv(next\_recv\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{143     \&  proc\_id+1, next\_recv\_tag, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{144     \textcolor{keyword}{CALL }mpi\_recv(prev\_recv\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{145     \&  proc\_id-\/1, prev\_recv\_tag,  mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{146 }
\DoxyCodeLine{147   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (modulo(proc\_id, 2) .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{148     \textcolor{keyword}{CALL }mpi\_recv(next\_recv\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{149     \&  proc\_id+1, next\_recv\_tag, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{150     \textcolor{keyword}{CALL }mpi\_recv(prev\_recv\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{151     \&  proc\_id-\/1, prev\_recv\_tag,  mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{152 }
\DoxyCodeLine{153     \textcolor{keyword}{CALL }mpi\_send(next\_send\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{154     \&  proc\_id+1, next\_send\_tag, mpi\_comm\_world, ierror)}
\DoxyCodeLine{155     \textcolor{keyword}{CALL }mpi\_send(prev\_send\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{156     \&  proc\_id-\/1, prev\_send\_tag, mpi\_comm\_world, ierror)}
\DoxyCodeLine{157 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{158 }
\DoxyCodeLine{159   sub\_grid(:,dim2\_len-\/overlap+1:dim2\_len) = next\_recv\_boundary}
\DoxyCodeLine{160   sub\_grid(:,1:overlap) = prev\_recv\_boundary}
\DoxyCodeLine{161 }
\DoxyCodeLine{162 \textcolor{comment}{! 2. Processor 0 only needs to send one boundary, SEND/RECV.}}
\DoxyCodeLine{163 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (proc\_id .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{164   next\_send\_boundary = sub\_grid(:,dim2\_len-\/2*overlap+1:dim2\_len-\/overlap)}
\DoxyCodeLine{165 }
\DoxyCodeLine{166   \textcolor{keyword}{CALL }mpi\_send(next\_send\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{167   \&  proc\_id+1, next\_send\_tag, mpi\_comm\_world, ierror)}
\DoxyCodeLine{168 }
\DoxyCodeLine{169   \textcolor{keyword}{CALL }mpi\_recv(next\_recv\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{170   \&  proc\_id+1, next\_recv\_tag, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{171 }
\DoxyCodeLine{172   sub\_grid(:,dim2\_len-\/overlap+1:dim2\_len) = next\_recv\_boundary}
\DoxyCodeLine{173 }
\DoxyCodeLine{174 \textcolor{comment}{! 3. Last processor only needs to send one boundary, but follows even SEND/RECV}}
\DoxyCodeLine{175 \textcolor{comment}{! odd RECV/SEND.}}
\DoxyCodeLine{176 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (proc\_id .EQ. proc\_count-\/1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{177   prev\_send\_boundary = sub\_grid(:,overlap+1:2*overlap)}
\DoxyCodeLine{178 }
\DoxyCodeLine{179   \textcolor{comment}{! For buffering, even processors send/recv and odd ones recv/send.}}
\DoxyCodeLine{180   \textcolor{keywordflow}{IF} (modulo(proc\_id, 2) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{181     \textcolor{keyword}{CALL }mpi\_send(prev\_send\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{182     \& proc\_id-\/1, prev\_send\_tag, mpi\_comm\_world, ierror)}
\DoxyCodeLine{183 }
\DoxyCodeLine{184     \textcolor{keyword}{CALL }mpi\_recv(prev\_recv\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{185     \& proc\_id-\/1, prev\_recv\_tag,  mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{186 }
\DoxyCodeLine{187   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (modulo(proc\_id, 2) .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{188     \textcolor{keyword}{CALL }mpi\_recv(prev\_recv\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{189     \& proc\_id-\/1, prev\_recv\_tag,  mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{190 }
\DoxyCodeLine{191     \textcolor{keyword}{CALL }mpi\_send(prev\_send\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{192     \& proc\_id-\/1, prev\_send\_tag, mpi\_comm\_world, ierror)}
\DoxyCodeLine{193 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{194 }
\DoxyCodeLine{195   sub\_grid(:,1:overlap) = prev\_recv\_boundary}
\DoxyCodeLine{196 }
\DoxyCodeLine{197 \textcolor{comment}{! 4. ERROR STOP.}}
\DoxyCodeLine{198 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{199   print *, \textcolor{stringliteral}{'EZ\_PARALLEL: Issue with processor '}, proc\_id, \textcolor{stringliteral}{' in subroutine '}, \&}
\DoxyCodeLine{200   \& \textcolor{stringliteral}{'call SHARE\_SUBGRID\_BOUNDARIES\_DBLE\_REAL (which is also called in '}, \&}
\DoxyCodeLine{201   \& \textcolor{stringliteral}{'SHARE\_SUBGRID\_BOUNDARIES\_DBLE\_CMPLX). You should '}, \&}
\DoxyCodeLine{202   \& \textcolor{stringliteral}{'never actually see this error, it means that the aforementioned '}, \&}
\DoxyCodeLine{203   \& \textcolor{stringliteral}{'processor does not have an ID between 0 and '}, proc\_count, \&}
\DoxyCodeLine{204   \& \textcolor{stringliteral}{'. I am not sure what you did to get here nor how I messed up, but look '}, \&}
\DoxyCodeLine{205   \& \textcolor{stringliteral}{'in the share\_subgrid\_boundaries.f file in the EZ\_PARALLEL '}, \&}
\DoxyCodeLine{206   \& \textcolor{stringliteral}{'directory, the IF statement there messed up. I am going to force an '}, \&}
\DoxyCodeLine{207   \& \textcolor{stringliteral}{'ERROR STOP now.'}}
\DoxyCodeLine{208   error stop \textcolor{stringliteral}{'EZ\_PARALLEL: Good luck fixing this, and let me know how you do!'}}
\DoxyCodeLine{209 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{210 }

\end{DoxyCode}
\mbox{\Hypertarget{share__subgrid__boundaries__dble__real_8f_a62f18c373f73b73503511f5db249c3a7}\label{share__subgrid__boundaries__dble__real_8f_a62f18c373f73b73503511f5db249c3a7}} 
\index{share\_subgrid\_boundaries\_dble\_real.f@{share\_subgrid\_boundaries\_dble\_real.f}!serial@{serial}}
\index{serial@{serial}!share\_subgrid\_boundaries\_dble\_real.f@{share\_subgrid\_boundaries\_dble\_real.f}}
\doxysubsubsection{\texorpdfstring{serial()}{serial()}}
{\footnotesize\ttfamily subroutine share\+\_\+subgrid\+\_\+boundaries\+\_\+dble\+\_\+real\+\_\+ezp\+::serial}


\begin{DoxyCode}{0}
\DoxyCodeLine{56 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{57 }
\DoxyCodeLine{58 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{59 }
\DoxyCodeLine{60 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{61 }

\end{DoxyCode}
\mbox{\Hypertarget{share__subgrid__boundaries__dble__real_8f_a5170f5c15842e65d901113fc48dfe97a}\label{share__subgrid__boundaries__dble__real_8f_a5170f5c15842e65d901113fc48dfe97a}} 
\index{share\_subgrid\_boundaries\_dble\_real.f@{share\_subgrid\_boundaries\_dble\_real.f}!share\_subgrid\_boundaries\_dble\_real\_ezp@{share\_subgrid\_boundaries\_dble\_real\_ezp}}
\index{share\_subgrid\_boundaries\_dble\_real\_ezp@{share\_subgrid\_boundaries\_dble\_real\_ezp}!share\_subgrid\_boundaries\_dble\_real.f@{share\_subgrid\_boundaries\_dble\_real.f}}
\doxysubsubsection{\texorpdfstring{share\_subgrid\_boundaries\_dble\_real\_ezp()}{share\_subgrid\_boundaries\_dble\_real\_ezp()}}
{\footnotesize\ttfamily subroutine share\+\_\+subgrid\+\_\+boundaries\+\_\+dble\+\_\+real\+\_\+ezp (\begin{DoxyParamCaption}\item[{integer}]{dim1\+\_\+len,  }\item[{integer}]{dim2\+\_\+len,  }\item[{integer}]{overlap,  }\item[{double precision, dimension(\mbox{\hyperlink{cfft2df__unit__test__MATLAB_8m_acb4b6a591c5ad6fc207ef543dc74d1ae}{dim1\+\_\+len}}, \mbox{\hyperlink{cfft2df__unit__test__MATLAB_8m_adef80e51b1bb5916dd9410de399f1319}{dim2\+\_\+len}})}]{sub\+\_\+grid }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{17 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{24 \& dim2\_len, \&}
\DoxyCodeLine{25 \& overlap, \&}
\DoxyCodeLine{26 \& proc\_id, \&}
\DoxyCodeLine{27 \& proc\_count, \&}
\DoxyCodeLine{28 \& ierror}
\DoxyCodeLine{29 \textcolor{keywordtype}{DOUBLE PRECISION}, \textcolor{keywordtype}{DIMENSION(dim1\_len, dim2\_len)} :: sub\_grid}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{keyword}{CALL }mpi\_comm\_rank(mpi\_comm\_world, proc\_id, ierror)}
\DoxyCodeLine{32 \textcolor{keyword}{CALL }mpi\_comm\_size(mpi\_comm\_world, proc\_count, ierror)}
\DoxyCodeLine{33 }
\DoxyCodeLine{34 \textcolor{comment}{! Check for errors in user input.}}
\DoxyCodeLine{35 \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}(proc\_id)}
\DoxyCodeLine{36 }
\DoxyCodeLine{37 \textcolor{comment}{! Run in serial if there is only one processor.}}
\DoxyCodeLine{38 \textcolor{keywordflow}{IF} (proc\_count .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{39   \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}}
\DoxyCodeLine{40 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{41   \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}(dim1\_len, dim2\_len, overlap, sub\_grid, proc\_id, proc\_count)}
\DoxyCodeLine{42 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{45 \textcolor{keyword}{CONTAINS}}
\DoxyCodeLine{46 }
\DoxyCodeLine{47 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{48 \textcolor{comment}{! SERIAL. Handles the execution if there is only one processor.}}
\DoxyCodeLine{49 \textcolor{comment}{!}}
\DoxyCodeLine{50 \textcolor{comment}{! STRUCTURE: N/A. One processor implies there is no sub-\/grid boundary to}}
\DoxyCodeLine{51 \textcolor{comment}{! communicate.}}
\DoxyCodeLine{52 \textcolor{comment}{!}}
\DoxyCodeLine{53 \textcolor{comment}{! VARIABLES: -\/ variable1: variable1 descripotion.}}
\DoxyCodeLine{54 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{55 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}}
\DoxyCodeLine{56 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{57 }
\DoxyCodeLine{58 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{59 }
\DoxyCodeLine{60 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{61 }
\DoxyCodeLine{62 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}}
\DoxyCodeLine{63 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{64 }
\DoxyCodeLine{65 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{66 \textcolor{comment}{! PARALLEL. Handles the execution if there is more than one processor.}}
\DoxyCodeLine{67 \textcolor{comment}{!}}
\DoxyCodeLine{68 \textcolor{comment}{! STRUCTURE: 1) Set the MPI message tages and zero out the SEND/RECV boundary}}
\DoxyCodeLine{69 \textcolor{comment}{! arrays.}}
\DoxyCodeLine{70 \textcolor{comment}{! 2) SEND/RECV boundary based on the following cases: a) Interior subgrid,}}
\DoxyCodeLine{71 \textcolor{comment}{! needs to SEND/RECV both of its boundary arrays, b) first processor only needs}}
\DoxyCodeLine{72 \textcolor{comment}{! to SEND/RECV next boundary, and c) last processor only needs to SEND/RECV prev}}
\DoxyCodeLine{73 \textcolor{comment}{! boundary. Even processors SEND then RECV, odd processors RECV then SEND to}}
\DoxyCodeLine{74 \textcolor{comment}{! reduce buffering.}}
\DoxyCodeLine{75 \textcolor{comment}{!}}
\DoxyCodeLine{76 \textcolor{comment}{! VARIABLES: -\/ dim1\_len, dim2\_len: The shape of the sub-\/sub\_grid (INTEGER).}}
\DoxyCodeLine{77 \textcolor{comment}{! -\/ overlap: The overlap required for the numerical scheme (INTEGER).}}
\DoxyCodeLine{78 \textcolor{comment}{! -\/ sub\_grid: The sub-\/grid of the processor, or the grid if only one processor}}
\DoxyCodeLine{79 \textcolor{comment}{! is in use (DOUBLE PRECISION, DIMENSION(dim1\_len, dim2\_len)).}}
\DoxyCodeLine{80 \textcolor{comment}{! -\/ proc\_id: Processor ID (INTEGER).}}
\DoxyCodeLine{81 \textcolor{comment}{! -\/ proc\_count: Total number of processors (INTEGER).}}
\DoxyCodeLine{82 \textcolor{comment}{! -\/ prev\_send\_tag, prev\_recv\_tag: MPI message tags for SEND to/RECV from the}}
\DoxyCodeLine{83 \textcolor{comment}{! previous processor ID (INTEGER).}}
\DoxyCodeLine{84 \textcolor{comment}{! -\/ next\_send\_tag, next\_recv\_tag: MPI message tags for SEND to/RECV from the}}
\DoxyCodeLine{85 \textcolor{comment}{! next processor ID (INTEGER).}}
\DoxyCodeLine{86 \textcolor{comment}{! -\/ prev\_send\_boundary, prev\_recv\_boundary: The arrays for storing the values}}
\DoxyCodeLine{87 \textcolor{comment}{! to SEND to/RECV from the previous processor ID (DOUBLE PRECISION,}}
\DoxyCodeLine{88 \textcolor{comment}{! DIMENSION(dim1\_len, overlap)).}}
\DoxyCodeLine{89 \textcolor{comment}{! -\/ next\_send\_boundary, next\_recv\_boundary: The arrays for storing the values}}
\DoxyCodeLine{90 \textcolor{comment}{! to SEND to/RECV from the next processor ID (DOUBLE PRECISION,}}
\DoxyCodeLine{91 \textcolor{comment}{! DIMENSION(dim1\_len, overlap)).}}
\DoxyCodeLine{92 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{93 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}(dim1\_len, dim2\_len, overlap, sub\_grid, proc\_id, proc\_count)}
\DoxyCodeLine{94 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{95 }
\DoxyCodeLine{96 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{97 }
\DoxyCodeLine{98 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{99 }
\DoxyCodeLine{100 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{101 \& dim2\_len, \&}
\DoxyCodeLine{102 \& overlap, \&}
\DoxyCodeLine{103 \& proc\_id, \&}
\DoxyCodeLine{104 \& proc\_count, \&}
\DoxyCodeLine{105 \& prev\_send\_tag, \&}
\DoxyCodeLine{106 \& next\_recv\_tag, \&}
\DoxyCodeLine{107 \& next\_send\_tag, \&}
\DoxyCodeLine{108 \& prev\_recv\_tag, \&}
\DoxyCodeLine{109 \& ierror, \&}
\DoxyCodeLine{110 \& status(MPI\_STATUS\_SIZE)}
\DoxyCodeLine{111 \textcolor{keywordtype}{DOUBLE PRECISION}, \textcolor{keywordtype}{DIMENSION(dim1\_len, dim2\_len)} :: sub\_grid}
\DoxyCodeLine{112 \textcolor{keywordtype}{DOUBLE PRECISION}, \textcolor{keywordtype}{DIMENSION(dim1\_len, overlap)} :: next\_send\_boundary, \&}
\DoxyCodeLine{113 \& prev\_send\_boundary, \&}
\DoxyCodeLine{114 \& next\_recv\_boundary, \&}
\DoxyCodeLine{115 \& prev\_recv\_boundary}
\DoxyCodeLine{116 }
\DoxyCodeLine{117 prev\_send\_tag = 12}
\DoxyCodeLine{118 next\_recv\_tag = prev\_send\_tag}
\DoxyCodeLine{119 next\_send\_tag = 93}
\DoxyCodeLine{120 prev\_recv\_tag = next\_send\_tag}
\DoxyCodeLine{121 }
\DoxyCodeLine{122 next\_send\_boundary = 0.0}
\DoxyCodeLine{123 prev\_send\_boundary = 0.0}
\DoxyCodeLine{124 next\_recv\_boundary = 0.0}
\DoxyCodeLine{125 prev\_recv\_boundary = 0.0}
\DoxyCodeLine{126 }
\DoxyCodeLine{127 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{128 \textcolor{comment}{! Communicate boundary points of my subgrid to neighbors. 3 Cases:}}
\DoxyCodeLine{129 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{130 \textcolor{comment}{! 1. Interior subgrid, needs to send both of its boundary vectors.}}
\DoxyCodeLine{131 \textcolor{keywordflow}{IF} (modulo(proc\_id, proc\_count-\/1) .NE. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{132   next\_send\_boundary = sub\_grid(:,dim2\_len-\/2*overlap+1:dim2\_len-\/overlap)}
\DoxyCodeLine{133   prev\_send\_boundary = sub\_grid(:,overlap+1:2*overlap)}
\DoxyCodeLine{134 }
\DoxyCodeLine{135   \textcolor{comment}{! For buffering, even processors SEND/RECV and odd ones RECV/SEND.}}
\DoxyCodeLine{136   \textcolor{keywordflow}{IF} (modulo(proc\_id, 2) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{137     \textcolor{keyword}{CALL }mpi\_send(next\_send\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{138     \&  proc\_id+1, next\_send\_tag, mpi\_comm\_world, ierror)}
\DoxyCodeLine{139     \textcolor{keyword}{CALL }mpi\_send(prev\_send\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{140     \&  proc\_id-\/1, prev\_send\_tag, mpi\_comm\_world, ierror)}
\DoxyCodeLine{141 }
\DoxyCodeLine{142     \textcolor{keyword}{CALL }mpi\_recv(next\_recv\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{143     \&  proc\_id+1, next\_recv\_tag, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{144     \textcolor{keyword}{CALL }mpi\_recv(prev\_recv\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{145     \&  proc\_id-\/1, prev\_recv\_tag,  mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{146 }
\DoxyCodeLine{147   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (modulo(proc\_id, 2) .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{148     \textcolor{keyword}{CALL }mpi\_recv(next\_recv\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{149     \&  proc\_id+1, next\_recv\_tag, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{150     \textcolor{keyword}{CALL }mpi\_recv(prev\_recv\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{151     \&  proc\_id-\/1, prev\_recv\_tag,  mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{152 }
\DoxyCodeLine{153     \textcolor{keyword}{CALL }mpi\_send(next\_send\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{154     \&  proc\_id+1, next\_send\_tag, mpi\_comm\_world, ierror)}
\DoxyCodeLine{155     \textcolor{keyword}{CALL }mpi\_send(prev\_send\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{156     \&  proc\_id-\/1, prev\_send\_tag, mpi\_comm\_world, ierror)}
\DoxyCodeLine{157 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{158 }
\DoxyCodeLine{159   sub\_grid(:,dim2\_len-\/overlap+1:dim2\_len) = next\_recv\_boundary}
\DoxyCodeLine{160   sub\_grid(:,1:overlap) = prev\_recv\_boundary}
\DoxyCodeLine{161 }
\DoxyCodeLine{162 \textcolor{comment}{! 2. Processor 0 only needs to send one boundary, SEND/RECV.}}
\DoxyCodeLine{163 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (proc\_id .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{164   next\_send\_boundary = sub\_grid(:,dim2\_len-\/2*overlap+1:dim2\_len-\/overlap)}
\DoxyCodeLine{165 }
\DoxyCodeLine{166   \textcolor{keyword}{CALL }mpi\_send(next\_send\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{167   \&  proc\_id+1, next\_send\_tag, mpi\_comm\_world, ierror)}
\DoxyCodeLine{168 }
\DoxyCodeLine{169   \textcolor{keyword}{CALL }mpi\_recv(next\_recv\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{170   \&  proc\_id+1, next\_recv\_tag, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{171 }
\DoxyCodeLine{172   sub\_grid(:,dim2\_len-\/overlap+1:dim2\_len) = next\_recv\_boundary}
\DoxyCodeLine{173 }
\DoxyCodeLine{174 \textcolor{comment}{! 3. Last processor only needs to send one boundary, but follows even SEND/RECV}}
\DoxyCodeLine{175 \textcolor{comment}{! odd RECV/SEND.}}
\DoxyCodeLine{176 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (proc\_id .EQ. proc\_count-\/1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{177   prev\_send\_boundary = sub\_grid(:,overlap+1:2*overlap)}
\DoxyCodeLine{178 }
\DoxyCodeLine{179   \textcolor{comment}{! For buffering, even processors send/recv and odd ones recv/send.}}
\DoxyCodeLine{180   \textcolor{keywordflow}{IF} (modulo(proc\_id, 2) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{181     \textcolor{keyword}{CALL }mpi\_send(prev\_send\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{182     \& proc\_id-\/1, prev\_send\_tag, mpi\_comm\_world, ierror)}
\DoxyCodeLine{183 }
\DoxyCodeLine{184     \textcolor{keyword}{CALL }mpi\_recv(prev\_recv\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{185     \& proc\_id-\/1, prev\_recv\_tag,  mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{186 }
\DoxyCodeLine{187   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (modulo(proc\_id, 2) .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{188     \textcolor{keyword}{CALL }mpi\_recv(prev\_recv\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{189     \& proc\_id-\/1, prev\_recv\_tag,  mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{190 }
\DoxyCodeLine{191     \textcolor{keyword}{CALL }mpi\_send(prev\_send\_boundary, dim1\_len*overlap, mpi\_double\_precision, \&}
\DoxyCodeLine{192     \& proc\_id-\/1, prev\_send\_tag, mpi\_comm\_world, ierror)}
\DoxyCodeLine{193 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{194 }
\DoxyCodeLine{195   sub\_grid(:,1:overlap) = prev\_recv\_boundary}
\DoxyCodeLine{196 }
\DoxyCodeLine{197 \textcolor{comment}{! 4. ERROR STOP.}}
\DoxyCodeLine{198 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{199   print *, \textcolor{stringliteral}{'EZ\_PARALLEL: Issue with processor '}, proc\_id, \textcolor{stringliteral}{' in subroutine '}, \&}
\DoxyCodeLine{200   \& \textcolor{stringliteral}{'call SHARE\_SUBGRID\_BOUNDARIES\_DBLE\_REAL (which is also called in '}, \&}
\DoxyCodeLine{201   \& \textcolor{stringliteral}{'SHARE\_SUBGRID\_BOUNDARIES\_DBLE\_CMPLX). You should '}, \&}
\DoxyCodeLine{202   \& \textcolor{stringliteral}{'never actually see this error, it means that the aforementioned '}, \&}
\DoxyCodeLine{203   \& \textcolor{stringliteral}{'processor does not have an ID between 0 and '}, proc\_count, \&}
\DoxyCodeLine{204   \& \textcolor{stringliteral}{'. I am not sure what you did to get here nor how I messed up, but look '}, \&}
\DoxyCodeLine{205   \& \textcolor{stringliteral}{'in the share\_subgrid\_boundaries.f file in the EZ\_PARALLEL '}, \&}
\DoxyCodeLine{206   \& \textcolor{stringliteral}{'directory, the IF statement there messed up. I am going to force an '}, \&}
\DoxyCodeLine{207   \& \textcolor{stringliteral}{'ERROR STOP now.'}}
\DoxyCodeLine{208   error stop \textcolor{stringliteral}{'EZ\_PARALLEL: Good luck fixing this, and let me know how you do!'}}
\DoxyCodeLine{209 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{210 }
\DoxyCodeLine{211 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}}
\DoxyCodeLine{212 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{213 }
\DoxyCodeLine{214 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{215 \textcolor{comment}{! ERROR\_HANDLING. Checks for input error and other possible complications.}}
\DoxyCodeLine{216 \textcolor{comment}{!}}
\DoxyCodeLine{217 \textcolor{comment}{! ERRORS TO CHECK: -\/ N/A. (Assume that users will not enter negative matrix}}
\DoxyCodeLine{218 \textcolor{comment}{! dimension lengths.)}}
\DoxyCodeLine{219 \textcolor{comment}{!}}
\DoxyCodeLine{220 \textcolor{comment}{! VARIABLES: -\/ proc\_id: Processor ID (INTEGER).}}
\DoxyCodeLine{221 \textcolor{comment}{! -\/ proc\_err\_flag -\/ Flag is triggered if processor encounters an error}}
\DoxyCodeLine{222 \textcolor{comment}{! (LOGICAL).}}
\DoxyCodeLine{223 \textcolor{comment}{! -\/ global\_err\_flag -\/ Flag is triggered if any processor encouters an error}}
\DoxyCodeLine{224 \textcolor{comment}{! (LOGICAL).}}
\DoxyCodeLine{225 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{226 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}(proc\_id)}
\DoxyCodeLine{227 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{228 }
\DoxyCodeLine{229 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{230 }
\DoxyCodeLine{231 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{232 }
\DoxyCodeLine{233 \textcolor{keywordtype}{INTEGER} :: proc\_id}
\DoxyCodeLine{234 \textcolor{keywordtype}{LOGICAL} :: proc\_err\_flag, \&}
\DoxyCodeLine{235 \& global\_err\_flag}
\DoxyCodeLine{236 }
\DoxyCodeLine{237 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{238 }
\DoxyCodeLine{239 proc\_err\_flag = .false.}
\DoxyCodeLine{240 global\_err\_flag = .false.}
\DoxyCodeLine{241 }
\DoxyCodeLine{242 \textcolor{comment}{! STOP all processors if any encounter an error.}}
\DoxyCodeLine{243 \textcolor{keyword}{CALL }mpi\_allreduce(proc\_err\_flag, global\_err\_flag, 1, mpi\_logical, mpi\_lor, \&}
\DoxyCodeLine{244 \& mpi\_comm\_world, ierror)}
\DoxyCodeLine{245 }
\DoxyCodeLine{246 \textcolor{keywordflow}{IF} (global\_err\_flag) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{247   \textcolor{keyword}{CALL }mpi\_finalize(ierror)}
\DoxyCodeLine{248   stop}
\DoxyCodeLine{249 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{250 }
\DoxyCodeLine{251 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{252 }
\DoxyCodeLine{253 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}}
\DoxyCodeLine{254 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{255 }

\end{DoxyCode}
