\hypertarget{cfft2db_8f}{}\doxysection{C\+:/\+Users/\+Owner/\+Education and Research/\+Graduate School/\+Parallelization Module Project/\+E\+Z\+\_\+\+P\+A\+R\+A\+L\+L\+E\+L\+\_\+project/\+E\+Z\+\_\+\+P\+A\+R\+A\+L\+L\+E\+L/cfft2db.f File Reference}
\label{cfft2db_8f}\index{C:/Users/Owner/Education and Research/Graduate School/Parallelization Module Project/EZ\_PARALLEL\_project/EZ\_PARALLEL/cfft2db.f@{C:/Users/Owner/Education and Research/Graduate School/Parallelization Module Project/EZ\_PARALLEL\_project/EZ\_PARALLEL/cfft2db.f}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{cfft2db_8f_a85dec28129199285c17927fb1dcd3836}{cfft2db\+\_\+ezp}} (dim1\+\_\+len, dim2\+\_\+len, overlap, matrix)
\item 
subroutine \mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}} (dim1\+\_\+len, dim2\+\_\+len, overlap, matrix)
\item 
subroutine \mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}} (dim1\+\_\+len, dim2\+\_\+len, overlap, matrix, proc\+\_\+id, proc\+\_\+count)
\item 
subroutine \mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\+\_\+handling}} (proc\+\_\+id)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{cfft2db_8f_a85dec28129199285c17927fb1dcd3836}\label{cfft2db_8f_a85dec28129199285c17927fb1dcd3836}} 
\index{cfft2db.f@{cfft2db.f}!cfft2db\_ezp@{cfft2db\_ezp}}
\index{cfft2db\_ezp@{cfft2db\_ezp}!cfft2db.f@{cfft2db.f}}
\doxysubsubsection{\texorpdfstring{cfft2db\_ezp()}{cfft2db\_ezp()}}
{\footnotesize\ttfamily subroutine cfft2db\+\_\+ezp (\begin{DoxyParamCaption}\item[{integer}]{dim1\+\_\+len,  }\item[{integer}]{dim2\+\_\+len,  }\item[{integer}]{overlap,  }\item[{double complex, dimension(\mbox{\hyperlink{cfft2df__unit__test__MATLAB_8m_acb4b6a591c5ad6fc207ef543dc74d1ae}{dim1\+\_\+len}} $\ast$ \mbox{\hyperlink{cfft2df__unit__test__MATLAB_8m_adef80e51b1bb5916dd9410de399f1319}{dim2\+\_\+len}})}]{matrix }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{24 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{31 \& dim2\_len, \&}
\DoxyCodeLine{32 \& overlap, \&}
\DoxyCodeLine{33 \& proc\_id, \&}
\DoxyCodeLine{34 \& proc\_count, \&}
\DoxyCodeLine{35 \& ierror}
\DoxyCodeLine{36 \textcolor{keywordtype}{DOUBLE COMPLEX} :: matrix(dim1\_len * dim2\_len)}
\DoxyCodeLine{37 }
\DoxyCodeLine{38 \textcolor{keyword}{CALL }mpi\_comm\_rank(mpi\_comm\_world, proc\_id, ierror)}
\DoxyCodeLine{39 \textcolor{keyword}{CALL }mpi\_comm\_size(mpi\_comm\_world, proc\_count, ierror)}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 \textcolor{comment}{! Check for errors in user input.}}
\DoxyCodeLine{42 \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}(proc\_id)}
\DoxyCodeLine{43 }
\DoxyCodeLine{44 \textcolor{comment}{! Run in serial if there is only one processor.}}
\DoxyCodeLine{45 \textcolor{keywordflow}{IF} (proc\_count .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{46   \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}(dim1\_len, dim2\_len, overlap, matrix)}
\DoxyCodeLine{47 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{48   \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}(dim1\_len, dim2\_len, overlap, matrix, proc\_id, proc\_count)}
\DoxyCodeLine{49 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{50 }
\DoxyCodeLine{51 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{52 \textcolor{keyword}{CONTAINS}}
\DoxyCodeLine{53 }
\DoxyCodeLine{54 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{55 \textcolor{comment}{! SERIAL. Handles the execution if there is only one processor.}}
\DoxyCodeLine{56 \textcolor{comment}{!}}
\DoxyCodeLine{57 \textcolor{comment}{! STRUCTURE: 1) Fills WSAVE1, and transforms the matrix along dimension 1}}
\DoxyCodeLine{58 \textcolor{comment}{! (dim1).}}
\DoxyCodeLine{59 \textcolor{comment}{! 2) Fills WSAVE2, transposes the matrix, and transforms the transpose along}}
\DoxyCodeLine{60 \textcolor{comment}{! dim1 (which is dimension 2 of the matrix). Returns the transpose of the}}
\DoxyCodeLine{61 \textcolor{comment}{! tranformed transpose matrix.}}
\DoxyCodeLine{62 \textcolor{comment}{!}}
\DoxyCodeLine{63 \textcolor{comment}{! VARIABLES: -\/ dim1\_len, dim2\_len: The shape of the sub-\/grid (INTEGER).}}
\DoxyCodeLine{64 \textcolor{comment}{! -\/ overlap: The overlap required for the numerical scheme (INTEGER).}}
\DoxyCodeLine{65 \textcolor{comment}{! -\/ matrix: The 2D DOUBLE COMPLEX array which will be Fourier transformed}}
\DoxyCodeLine{66 \textcolor{comment}{! (DOUBLE COMPLEX, DIMENSION(dim1\_len, dim2\_len)).}}
\DoxyCodeLine{67 \textcolor{comment}{! -\/ norm: The normalization coefficient for the transform (DOUBLE PRECISION).}}
\DoxyCodeLine{68 \textcolor{comment}{! -\/ WSAVE1: Work array to store prime factorization of dim1\_len and tabulate}}
\DoxyCodeLine{69 \textcolor{comment}{! trig functions for usage in SW's FFT routines (DOUBLE PRECISION,}}
\DoxyCodeLine{70 \textcolor{comment}{! DIMENSION(4*dim1\_len+15)).}}
\DoxyCodeLine{71 \textcolor{comment}{! -\/ WSAVE2: Work array to store prime factorization of dim2\_len and tabulate}}
\DoxyCodeLine{72 \textcolor{comment}{! trig functions for usage in SW's FFT routines (DOUBLE PRECISION,}}
\DoxyCodeLine{73 \textcolor{comment}{! DIMENSION(4*dim2\_len+15)).}}
\DoxyCodeLine{74 \textcolor{comment}{! -\/ matrix\_tr: The 2D DOUBLE COMPLEX array which will store the transpose of}}
\DoxyCodeLine{75 \textcolor{comment}{! matrix during the Fourier transform (DOUBLE COMPLEX,}}
\DoxyCodeLine{76 \textcolor{comment}{! DIMENSION(dim2\_len, dim1\_len)).}}
\DoxyCodeLine{77 \textcolor{comment}{! -\/ ii: Counting index used in DO loops (INTEGER).}}
\DoxyCodeLine{78 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{79 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}(dim1\_len, dim2\_len, overlap, matrix)}
\DoxyCodeLine{80 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{81 }
\DoxyCodeLine{82 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{83 }
\DoxyCodeLine{84 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{85 }
\DoxyCodeLine{86 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{87 \& dim2\_len, \&}
\DoxyCodeLine{88 \& overlap, \&}
\DoxyCodeLine{89 \& ii}
\DoxyCodeLine{90 \textcolor{keywordtype}{DOUBLE PRECISION} :: norm}
\DoxyCodeLine{91 \textcolor{keywordtype}{DOUBLE PRECISION}, \textcolor{keywordtype}{DIMENSION(4*dim1\_len+15)} :: WSAVE1}
\DoxyCodeLine{92 \textcolor{keywordtype}{DOUBLE PRECISION}, \textcolor{keywordtype}{DIMENSION(4*dim2\_len+15)} :: WSAVE2}
\DoxyCodeLine{93 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(dim1\_len, dim2\_len)} :: matrix}
\DoxyCodeLine{94 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(dim2\_len, dim1\_len)} :: matrix\_tr}
\DoxyCodeLine{95 }
\DoxyCodeLine{96 \textcolor{comment}{! SW complex forward 1D FFT (FFFT) initialization, fills WSAVE1.}}
\DoxyCodeLine{97 wsave1 = 0.0}
\DoxyCodeLine{98 \textcolor{keyword}{CALL }\mbox{\hyperlink{zffti_8f_aeb5f66f9b7b03cd106b8563d955a8917}{zffti}}(dim1\_len, wsave1)}
\DoxyCodeLine{99 }
\DoxyCodeLine{100 \textcolor{comment}{! Perform 1D FFFT on the dim1 of matrix.}}
\DoxyCodeLine{101 \textcolor{keywordflow}{DO} ii = 1, dim2\_len}
\DoxyCodeLine{102   \textcolor{keyword}{CALL }\mbox{\hyperlink{zfftb_8f_ab698eb595703027e1cf9dcac305a4926}{zfftb}}(dim1\_len, matrix(:,ii), wsave1) \textcolor{comment}{! SW FFFT routine.}}
\DoxyCodeLine{103 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{104 matrix\_tr = transpose(matrix)}
\DoxyCodeLine{105 }
\DoxyCodeLine{106 wsave2 = 0.0}
\DoxyCodeLine{107 \textcolor{keyword}{CALL }\mbox{\hyperlink{zffti_8f_aeb5f66f9b7b03cd106b8563d955a8917}{zffti}}(dim2\_len, wsave2)}
\DoxyCodeLine{108 \textcolor{comment}{! SW 1D (FFFT) initialization, fills WSAVE2.}}
\DoxyCodeLine{109 }
\DoxyCodeLine{110 \textcolor{comment}{! Perform 1D FFFT on the dim1 of matrix\_transpose.}}
\DoxyCodeLine{111 \textcolor{keywordflow}{DO} ii = 1, dim1\_len}
\DoxyCodeLine{112   \textcolor{keyword}{CALL }\mbox{\hyperlink{zfftb_8f_ab698eb595703027e1cf9dcac305a4926}{zfftb}}(dim2\_len, matrix\_tr(:,ii), wsave2)}
\DoxyCodeLine{113 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{114 matrix = transpose(matrix\_tr)}
\DoxyCodeLine{115 }
\DoxyCodeLine{116 \textcolor{comment}{! Normalize the matrix in the inverse transform.}}
\DoxyCodeLine{117 norm = 1.0/dble(dim1\_len * dim2\_len)}
\DoxyCodeLine{118 matrix = norm * matrix}
\DoxyCodeLine{119 }
\DoxyCodeLine{120 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}}
\DoxyCodeLine{121 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{122 }
\DoxyCodeLine{123 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{124 \textcolor{comment}{! PARALLEL. Handles the execution if there is more than one processor.}}
\DoxyCodeLine{125 \textcolor{comment}{!}}
\DoxyCodeLine{126 \textcolor{comment}{! STRUCTURE: 1) Trim the overlap from the input matrix. FFT input matrix along}}
\DoxyCodeLine{127 \textcolor{comment}{! dim1.}}
\DoxyCodeLine{128 \textcolor{comment}{! 2) Get the sub-\/grids that the processor would have if the grid was split along}}
\DoxyCodeLine{129 \textcolor{comment}{! dimension 2 (dim2). FFT those sub-\/grids along dim2.}}
\DoxyCodeLine{130 \textcolor{comment}{! 3) Send dim2 sub-\/grid sections to their appropriate places in the}}
\DoxyCodeLine{131 \textcolor{comment}{! dim1 sub-\/grids}}
\DoxyCodeLine{132 \textcolor{comment}{!}}
\DoxyCodeLine{133 \textcolor{comment}{! VARIABLES: -\/ dim1\_len, dim2\_len: The shape of the sub-\/grid (INTEGER).}}
\DoxyCodeLine{134 \textcolor{comment}{! -\/ overlap: The overlap required for the numerical scheme (INTEGER).}}
\DoxyCodeLine{135 \textcolor{comment}{! -\/ matrix: The 2D DOUBLE COMPLEX array which will be Fourier transformed}}
\DoxyCodeLine{136 \textcolor{comment}{! (DOUBLE COMPLEX, DIMENSION(dim1\_len, dim2\_len)).}}
\DoxyCodeLine{137 \textcolor{comment}{! -\/ proc\_id: Processor ID (INTEGER).}}
\DoxyCodeLine{138 \textcolor{comment}{! -\/ proc\_count: Total number of processors (INTEGER).}}
\DoxyCodeLine{139 \textcolor{comment}{! -\/ WSAVE1: Work array to store prime factorization of dim1\_len and tabulate}}
\DoxyCodeLine{140 \textcolor{comment}{! trig functions for usage in SW's FFT routines (DOUBLE PRECISION,}}
\DoxyCodeLine{141 \textcolor{comment}{! DIMENSION(4*dim1\_len+15)).}}
\DoxyCodeLine{142 \textcolor{comment}{! -\/ WSAVE2: Work array to store prime factorization of dim2\_len and tabulate}}
\DoxyCodeLine{143 \textcolor{comment}{! trig functions for usage in SW's FFT routines (DOUBLE PRECISION,}}
\DoxyCodeLine{144 \textcolor{comment}{! DIMENSION(:), ALLOCATABLE).}}
\DoxyCodeLine{145 \textcolor{comment}{! -\/ dim1\_slice: The sub-\/grid (along dim1) that does not include its overlap with}}
\DoxyCodeLine{146 \textcolor{comment}{! neighboring subgrids (DOUBLE COMPLEX, DIMENSION(:,:), ALLOCATABLE).}}
\DoxyCodeLine{147 \textcolor{comment}{! -\/ dim2\_slice: The sub-\/grid (along dim2) that does not include its overlap with}}
\DoxyCodeLine{148 \textcolor{comment}{! neighboring subgrids (DOUBLE COMPLEX, DIMENSION(:,:), ALLOCATABLE).}}
\DoxyCodeLine{149 \textcolor{comment}{! -\/ ii: Counting index used in DO loops (INTEGER).}}
\DoxyCodeLine{150 \textcolor{comment}{! -\/ dim2\_len\_dim1\_slice: dim2 length of dim1\_slice, later recalculated for use}}
\DoxyCodeLine{151 \textcolor{comment}{! in communication (INTEGER).}}
\DoxyCodeLine{152 \textcolor{comment}{! -\/ dim1\_len\_dim2\_slice: dim1 length of dim2\_slice, later recalculated for use}}
\DoxyCodeLine{153 \textcolor{comment}{! in communication (INTEGER).}}
\DoxyCodeLine{154 \textcolor{comment}{! -\/ dim1\_len\_dim2\_slice\_list: List of all dim1\_len for all dim2\_slice's}}
\DoxyCodeLine{155 \textcolor{comment}{! (INTEGER, DIMENSION(proc\_count)).}}
\DoxyCodeLine{156 \textcolor{comment}{! -\/ dim2\_len\_dim2\_slice: dim2 length of dim2\_slice, later recalculated for use}}
\DoxyCodeLine{157 \textcolor{comment}{! in communication (INTEGER).}}
\DoxyCodeLine{158 \textcolor{comment}{! -\/ fill\_in\_proc\_trgt: The proc\_id of the processor to communicate with during}}
\DoxyCodeLine{159 \textcolor{comment}{! the dim2\_slice fill-\/in process (INTEGER).}}
\DoxyCodeLine{160 \textcolor{comment}{! -\/ dim2\_len\_total: dim2 length of the grid (INTEGER).}}
\DoxyCodeLine{161 \textcolor{comment}{! -\/ dim2\_len\_dim1\_slice\_list: List of all dim2\_len for all dim1\_slice's}}
\DoxyCodeLine{162 \textcolor{comment}{! (INTEGER, DIMENSION(proc\_count)).}}
\DoxyCodeLine{163 \textcolor{comment}{! -\/ dim2\_low\_index\_dim1\_slice: Lesser global dim2 index for the portion of}}
\DoxyCodeLine{164 \textcolor{comment}{! dim1\_slice to be put into dim2\_slice (INTEGER).}}
\DoxyCodeLine{165 \textcolor{comment}{! -\/ dim2\_high\_index\_dim1\_slice: Greater global dim2 index for the portion of}}
\DoxyCodeLine{166 \textcolor{comment}{! dim1\_slice to be put into dim2\_slice (INTEGER).}}
\DoxyCodeLine{167 \textcolor{comment}{! -\/ dim2\_low\_index\_dim2\_slice: Lesser global dim2 index for the portion of}}
\DoxyCodeLine{168 \textcolor{comment}{! dim2\_slice to be filled in by dim1\_slice (INTEGER).}}
\DoxyCodeLine{169 \textcolor{comment}{! -\/ dim2\_high\_index\_dim2\_slice: Greater global dim2 index for the portion of}}
\DoxyCodeLine{170 \textcolor{comment}{! dim2\_slice to be filled in by dim1\_slice (INTEGER).}}
\DoxyCodeLine{171 \textcolor{comment}{! -\/ dim2\_slice\_tr: The 2D DOUBLE COMPLEX array which will store the transpose of}}
\DoxyCodeLine{172 \textcolor{comment}{! dim2\_slice during the Fourier transform (DOUBLE COMPLEX, DIMENSION(:,:),}}
\DoxyCodeLine{173 \textcolor{comment}{! ALLOCATABLE).}}
\DoxyCodeLine{174 \textcolor{comment}{! -\/ norm: The normalization coefficient for the transform (DOUBLE PRECISION).}}
\DoxyCodeLine{175 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{176 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}(dim1\_len, dim2\_len, overlap, matrix, proc\_id, proc\_count)}
\DoxyCodeLine{177 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{178 }
\DoxyCodeLine{179 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{180 }
\DoxyCodeLine{181 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{182 }
\DoxyCodeLine{183 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{184 \& dim2\_len, \&}
\DoxyCodeLine{185 \& overlap, \&}
\DoxyCodeLine{186 \& proc\_id, \&}
\DoxyCodeLine{187 \& proc\_count, \&}
\DoxyCodeLine{188 \& ierror, \&}
\DoxyCodeLine{189 \& status(MPI\_STATUS\_SIZE), \&}
\DoxyCodeLine{190 \& ii, \&}
\DoxyCodeLine{191 \& dim2\_len\_dim1\_slice, \&}
\DoxyCodeLine{192 \& dim1\_len\_dim2\_slice, \&}
\DoxyCodeLine{193 \& dim2\_len\_dim2\_slice, \&}
\DoxyCodeLine{194 \& fill\_in\_proc\_trgt, \&}
\DoxyCodeLine{195 \& dim2\_len\_total, \&}
\DoxyCodeLine{196 \& dim2\_low\_index\_dim1\_slice, \&}
\DoxyCodeLine{197 \& dim2\_high\_index\_dim1\_slice, \&}
\DoxyCodeLine{198 \& dim2\_low\_index\_dim2\_slice, \&}
\DoxyCodeLine{199 \& dim2\_high\_index\_dim2\_slice}
\DoxyCodeLine{200 \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(proc\_count)} :: dim1\_len\_dim2\_slice\_list, \&}
\DoxyCodeLine{201 \& dim2\_len\_dim1\_slice\_list}
\DoxyCodeLine{202 \textcolor{keywordtype}{DOUBLE PRECISION} :: norm}
\DoxyCodeLine{203 \textcolor{keywordtype}{DOUBLE PRECISION}, \textcolor{keywordtype}{DIMENSION(4*dim1\_len+15)} :: WSAVE1}
\DoxyCodeLine{204 \textcolor{keywordtype}{DOUBLE PRECISION}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE} :: WSAVE2}
\DoxyCodeLine{205 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(dim1\_len, dim2\_len)} :: matrix}
\DoxyCodeLine{206 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{ALLOCATABLE} :: dim1\_slice, \&}
\DoxyCodeLine{207 \& dim2\_slice, \&}
\DoxyCodeLine{208 \& dim2\_slice\_tr}
\DoxyCodeLine{209 }
\DoxyCodeLine{210 }
\DoxyCodeLine{211 \textcolor{comment}{! Trim the overlap from the input matrix.}}
\DoxyCodeLine{212 \textcolor{keywordflow}{IF} (proc\_id .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{213   \textcolor{comment}{! First processor, trim last part along dimension 2 of matrix.}}
\DoxyCodeLine{214   dim2\_len\_dim1\_slice = dim2\_len -\/ overlap}
\DoxyCodeLine{215   \textcolor{keyword}{ALLOCATE}(dim1\_slice(dim1\_len, dim2\_len\_dim1\_slice))}
\DoxyCodeLine{216   dim1\_slice = matrix(:, 1:dim2\_len-\/overlap)}
\DoxyCodeLine{217 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (proc\_id .EQ. proc\_count-\/1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{218   \textcolor{comment}{! Last processor, trim first part along dimension 2 of matrix.}}
\DoxyCodeLine{219   dim2\_len\_dim1\_slice = dim2\_len -\/ overlap}
\DoxyCodeLine{220   \textcolor{keyword}{ALLOCATE}(dim1\_slice(dim1\_len, dim2\_len\_dim1\_slice))}
\DoxyCodeLine{221   dim1\_slice = matrix(:, 1+overlap:dim2\_len)}
\DoxyCodeLine{222 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{223   \textcolor{comment}{! Middle processor, trim first and last part along dimension 2 of matrix.}}
\DoxyCodeLine{224   dim2\_len\_dim1\_slice = dim2\_len -\/ 2 * overlap}
\DoxyCodeLine{225   \textcolor{keyword}{ALLOCATE}(dim1\_slice(dim1\_len, dim2\_len\_dim1\_slice))}
\DoxyCodeLine{226   dim1\_slice = matrix(:, 1+overlap:dim2\_len-\/overlap)}
\DoxyCodeLine{227 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{228 }
\DoxyCodeLine{229 \textcolor{comment}{! Perfom 1D FFT along first dimension of dim1\_slice.}}
\DoxyCodeLine{230   \textcolor{comment}{! SW complex forward 1D FFT (FFFT) initialization, fills WSAVE1.}}
\DoxyCodeLine{231 wsave1 = 0.}
\DoxyCodeLine{232 \textcolor{keyword}{CALL }\mbox{\hyperlink{zffti_8f_aeb5f66f9b7b03cd106b8563d955a8917}{zffti}}(dim1\_len, wsave1)}
\DoxyCodeLine{233 }
\DoxyCodeLine{234 \textcolor{keywordflow}{DO} ii = 1, dim2\_len\_dim1\_slice}
\DoxyCodeLine{235   \textcolor{keyword}{CALL }\mbox{\hyperlink{zfftb_8f_ab698eb595703027e1cf9dcac305a4926}{zfftb}}(dim1\_len, dim1\_slice(:,ii), wsave1) \textcolor{comment}{! SW FFFT routine.}}
\DoxyCodeLine{236 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{237 }
\DoxyCodeLine{238 \textcolor{comment}{! \string~\string~\string~ Up to this point, we have FFT'd the grid along dimension 1.}}
\DoxyCodeLine{239 }
\DoxyCodeLine{240 \textcolor{comment}{! Now need to FFT along dim2, so we need a dim2\_slice. First, we must}}
\DoxyCodeLine{241 \textcolor{comment}{! calculate the size of dim2\_slice for all processors.}}
\DoxyCodeLine{242 \textcolor{comment}{! Calculate dim1\_len for each dim2\_slice.}}
\DoxyCodeLine{243   \textcolor{comment}{! Divide dim1\_len of total grid as evenly as possible.}}
\DoxyCodeLine{244 dim1\_len\_dim2\_slice = dim1\_len/proc\_count}
\DoxyCodeLine{245   \textcolor{comment}{! Now check if dim2\_slice of a given processor needs to take additional row,}}
\DoxyCodeLine{246   \textcolor{comment}{! i.e., dim1\_len \% proc\_count != 0.}}
\DoxyCodeLine{247 \textcolor{keywordflow}{DO} ii = 1, proc\_count}
\DoxyCodeLine{248   \textcolor{keywordflow}{IF} ((ii-\/1) .LT. modulo(dim1\_len, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{249     dim1\_len\_dim2\_slice\_list(ii) = dim1\_len\_dim2\_slice + 1}
\DoxyCodeLine{250     \textcolor{comment}{! The indexing is weird here since processors start at index 0 but arrays}}
\DoxyCodeLine{251     \textcolor{comment}{! start at index 1. Thus, entry ii of this corresponds to processor (ii-\/1).}}
\DoxyCodeLine{252   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{253     dim1\_len\_dim2\_slice\_list(ii) = dim1\_len\_dim2\_slice}
\DoxyCodeLine{254 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{255 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{256 }
\DoxyCodeLine{257 }
\DoxyCodeLine{258 \textcolor{comment}{! Calculate dim2\_len for all dim2\_slice's by adding up dim2 for each processor's}}
\DoxyCodeLine{259 \textcolor{comment}{! dim1\_slice.}}
\DoxyCodeLine{260 \textcolor{keyword}{CALL }mpi\_allreduce(dim2\_len\_dim1\_slice, dim2\_len\_dim2\_slice, 1, mpi\_integer, \&}
\DoxyCodeLine{261 \& mpi\_sum, mpi\_comm\_world, ierror)}
\DoxyCodeLine{262 }
\DoxyCodeLine{263 }
\DoxyCodeLine{264 \textcolor{comment}{! Allocate memory to dim2\_slice and fill it in.}}
\DoxyCodeLine{265 \textcolor{keyword}{ALLOCATE}(dim2\_slice(dim1\_len\_dim2\_slice\_list(proc\_id + 1), dim2\_len\_dim2\_slice))}
\DoxyCodeLine{266 dim2\_slice = (0.0, 0.0)}
\DoxyCodeLine{267 }
\DoxyCodeLine{268 \textcolor{comment}{! To fill in dim2\_slice, we need the dim2\_len of all dim1\_slice's.}}
\DoxyCodeLine{269 \textcolor{keyword}{CALL }mpi\_allreduce(dim2\_len\_dim1\_slice, dim2\_len\_total, 1, mpi\_integer, \&}
\DoxyCodeLine{270 \& mpi\_sum, mpi\_comm\_world, ierror)}
\DoxyCodeLine{271 \textcolor{comment}{! Calculate dim2\_len for each dim1\_slice, to avoid communication between}}
\DoxyCodeLine{272 \textcolor{comment}{! processors.}}
\DoxyCodeLine{273   \textcolor{comment}{! Divide dim2\_len of total grid as evenly as possible.}}
\DoxyCodeLine{274 dim2\_len\_dim1\_slice = dim2\_len\_total/proc\_count}
\DoxyCodeLine{275   \textcolor{comment}{! Now check if dim1\_slice of a given processor needs to take additional row,}}
\DoxyCodeLine{276   \textcolor{comment}{! i.e., dim2\_len \% proc\_count != 0.}}
\DoxyCodeLine{277 \textcolor{keywordflow}{DO} ii = 1, proc\_count}
\DoxyCodeLine{278   \textcolor{keywordflow}{IF} ((ii-\/1) .LT. modulo(dim2\_len\_total, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{279     dim2\_len\_dim1\_slice\_list(ii) = dim2\_len\_dim1\_slice + 1}
\DoxyCodeLine{280     \textcolor{comment}{! The indexing is weird here since processors start at index 0 but arrays}}
\DoxyCodeLine{281     \textcolor{comment}{! start at index 1. Thus, entry ii of this corresponds to processor (ii-\/1).}}
\DoxyCodeLine{282   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{283     dim2\_len\_dim1\_slice\_list(ii) = dim2\_len\_dim1\_slice}
\DoxyCodeLine{284 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{285 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{286 }
\DoxyCodeLine{287 \textcolor{comment}{! Fill in dim2\_slice using sections of the dim1\_slice's.}}
\DoxyCodeLine{288 \textcolor{keywordflow}{DO} ii = 1, proc\_count}
\DoxyCodeLine{289   fill\_in\_proc\_trgt = mod(proc\_count -\/ proc\_id + ii, proc\_count)}
\DoxyCodeLine{290   dim2\_high\_index\_dim1\_slice = \&}
\DoxyCodeLine{291   \& sum(dim1\_len\_dim2\_slice\_list(1:fill\_in\_proc\_trgt+1))}
\DoxyCodeLine{292   dim2\_low\_index\_dim1\_slice = dim2\_high\_index\_dim1\_slice \&}
\DoxyCodeLine{293   \& -\/ dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) + 1}
\DoxyCodeLine{294   dim2\_high\_index\_dim2\_slice = \&}
\DoxyCodeLine{295   \& sum(dim2\_len\_dim1\_slice\_list(1:fill\_in\_proc\_trgt+1))}
\DoxyCodeLine{296   dim2\_low\_index\_dim2\_slice = dim2\_high\_index\_dim2\_slice \&}
\DoxyCodeLine{297   \& -\/ dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1) + 1}
\DoxyCodeLine{298 }
\DoxyCodeLine{299 }
\DoxyCodeLine{300   \textcolor{comment}{! If fill\_in\_proc\_trgt < proc\_id, RECV then SEND.}}
\DoxyCodeLine{301   \textcolor{keywordflow}{IF} (fill\_in\_proc\_trgt .LT. proc\_id) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{302     \textcolor{keyword}{CALL }mpi\_recv( \&}
\DoxyCodeLine{303     \& dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice), \&}
\DoxyCodeLine{304     \& dim1\_len\_dim2\_slice\_list(proc\_id+1)\&}
\DoxyCodeLine{305     \& * dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1), mpi\_double\_complex, \&}
\DoxyCodeLine{306     \& fill\_in\_proc\_trgt, proc\_id, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{307 }
\DoxyCodeLine{308     \textcolor{keyword}{CALL }mpi\_send( \&}
\DoxyCodeLine{309     \& dim1\_slice(dim2\_low\_index\_dim1\_slice:dim2\_high\_index\_dim1\_slice,:), \&}
\DoxyCodeLine{310     dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) \&}
\DoxyCodeLine{311     \& * dim2\_len\_dim1\_slice\_list(proc\_id+1), mpi\_double\_complex, \&}
\DoxyCodeLine{312     \& fill\_in\_proc\_trgt, fill\_in\_proc\_trgt, mpi\_comm\_world, ierror)}
\DoxyCodeLine{313 }
\DoxyCodeLine{314   \textcolor{comment}{! If fill\_in\_proc\_trgt > proc\_id, SEND then RECV.}}
\DoxyCodeLine{315   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (fill\_in\_proc\_trgt .GT. proc\_id) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{316     \textcolor{keyword}{CALL }mpi\_send( \&}
\DoxyCodeLine{317     \& dim1\_slice(dim2\_low\_index\_dim1\_slice:dim2\_high\_index\_dim1\_slice,:), \&}
\DoxyCodeLine{318     \& dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) \&}
\DoxyCodeLine{319     \& * dim2\_len\_dim1\_slice\_list(proc\_id+1), mpi\_double\_complex, \&}
\DoxyCodeLine{320     \& fill\_in\_proc\_trgt, fill\_in\_proc\_trgt, mpi\_comm\_world, ierror)}
\DoxyCodeLine{321 }
\DoxyCodeLine{322     \textcolor{keyword}{CALL }mpi\_recv( \&}
\DoxyCodeLine{323     \& dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice), \&}
\DoxyCodeLine{324     \& dim1\_len\_dim2\_slice\_list(proc\_id+1) \&}
\DoxyCodeLine{325     \& * dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1), mpi\_double\_complex, \&}
\DoxyCodeLine{326     \& fill\_in\_proc\_trgt, proc\_id, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{327 }
\DoxyCodeLine{328   \textcolor{comment}{! If fill\_in\_proc\_trgt = proc\_id, then fill in dim2\_slice from your}}
\DoxyCodeLine{329   \textcolor{comment}{! dim1\_slice.}}
\DoxyCodeLine{330   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{331     dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice) = \&}
\DoxyCodeLine{332     \& dim1\_slice(dim2\_low\_index\_dim1\_slice:dim2\_high\_index\_dim1\_slice,:)}
\DoxyCodeLine{333 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{334 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{335 }
\DoxyCodeLine{336 \textcolor{comment}{! \string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~ Up to this point, each processor has a filled-\/in dim2\_slice,}}
\DoxyCodeLine{337 \textcolor{comment}{! and we are ready to FFT along dim2.}}
\DoxyCodeLine{338 \textcolor{keyword}{ALLOCATE}( \&}
\DoxyCodeLine{339 \& dim2\_slice\_tr(dim2\_len\_dim2\_slice, dim1\_len\_dim2\_slice\_list(proc\_id + 1)))}
\DoxyCodeLine{340 dim2\_slice\_tr = (0.0, 0.0)}
\DoxyCodeLine{341 dim2\_slice\_tr = transpose(dim2\_slice)}
\DoxyCodeLine{342 \textcolor{keyword}{ALLOCATE}(wsave2(4*dim2\_len\_dim2\_slice+15))}
\DoxyCodeLine{343 }
\DoxyCodeLine{344 \textcolor{comment}{! Perfom 1D FFT along first dimension of dim2\_slice\_tr (the columns of the work}}
\DoxyCodeLine{345 \textcolor{comment}{! grid).}}
\DoxyCodeLine{346   \textcolor{comment}{! SW complex forward 1D FFT (FFFT) initialization, fills WSAVE1.}}
\DoxyCodeLine{347 wsave2 = 0.}
\DoxyCodeLine{348 \textcolor{keyword}{CALL }\mbox{\hyperlink{zffti_8f_aeb5f66f9b7b03cd106b8563d955a8917}{zffti}}(dim2\_len\_dim2\_slice, wsave2)}
\DoxyCodeLine{349 }
\DoxyCodeLine{350 \textcolor{keywordflow}{DO} ii = 1, dim1\_len\_dim2\_slice\_list(proc\_id + 1)}
\DoxyCodeLine{351   \textcolor{comment}{! SW FFFT routine.}}
\DoxyCodeLine{352   \textcolor{keyword}{CALL }\mbox{\hyperlink{zfftb_8f_ab698eb595703027e1cf9dcac305a4926}{zfftb}}(dim2\_len\_dim2\_slice, dim2\_slice\_tr(:,ii), wsave2)}
\DoxyCodeLine{353 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{354 }
\DoxyCodeLine{355 dim2\_slice = transpose(dim2\_slice\_tr)}
\DoxyCodeLine{356 }
\DoxyCodeLine{357 \textcolor{comment}{! \string~\string~\string~ Up to this point, we have FFT'd along dim2, and now we must reconstruct}}
\DoxyCodeLine{358 \textcolor{comment}{! the dim1\_slice's.}}
\DoxyCodeLine{359 }
\DoxyCodeLine{360 \textcolor{comment}{! Fill in dim1\_slice using sections of the dim2\_slice's.}}
\DoxyCodeLine{361 \textcolor{keywordflow}{DO} ii = 1, proc\_count}
\DoxyCodeLine{362   fill\_in\_proc\_trgt = mod(proc\_count -\/ proc\_id + ii, proc\_count)}
\DoxyCodeLine{363   dim2\_high\_index\_dim1\_slice = \&}
\DoxyCodeLine{364   \& sum(dim1\_len\_dim2\_slice\_list(1:fill\_in\_proc\_trgt+1))}
\DoxyCodeLine{365   dim2\_low\_index\_dim1\_slice = dim2\_high\_index\_dim1\_slice \&}
\DoxyCodeLine{366   \& -\/ dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) + 1}
\DoxyCodeLine{367   dim2\_high\_index\_dim2\_slice = \&}
\DoxyCodeLine{368   \& sum(dim2\_len\_dim1\_slice\_list(1:fill\_in\_proc\_trgt+1))}
\DoxyCodeLine{369   dim2\_low\_index\_dim2\_slice = dim2\_high\_index\_dim2\_slice \&}
\DoxyCodeLine{370   \& -\/ dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1) + 1}
\DoxyCodeLine{371 }
\DoxyCodeLine{372   \textcolor{comment}{! If fill\_in\_proc\_trgt < proc\_id, RECV then SEND.}}
\DoxyCodeLine{373   \textcolor{keywordflow}{IF} (fill\_in\_proc\_trgt .LT. proc\_id) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{374     \textcolor{keyword}{CALL }mpi\_recv( \&}
\DoxyCodeLine{375     \& dim1\_slice(dim2\_low\_index\_dim1\_slice:dim2\_high\_index\_dim1\_slice,:), \&}
\DoxyCodeLine{376     \& dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) \&}
\DoxyCodeLine{377     \& * dim2\_len\_dim1\_slice\_list(proc\_id+1), mpi\_double\_complex, \&}
\DoxyCodeLine{378     \& fill\_in\_proc\_trgt, proc\_id, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{379 }
\DoxyCodeLine{380     \textcolor{keyword}{CALL }mpi\_send( \&}
\DoxyCodeLine{381     \& dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice), \&}
\DoxyCodeLine{382     \& dim1\_len\_dim2\_slice\_list(proc\_id+1) \&}
\DoxyCodeLine{383     \& * dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1), mpi\_double\_complex, \&}
\DoxyCodeLine{384     \& fill\_in\_proc\_trgt, fill\_in\_proc\_trgt, mpi\_comm\_world, ierror)}
\DoxyCodeLine{385 }
\DoxyCodeLine{386   \textcolor{comment}{! If fill\_in\_proc\_trgt > proc\_id, SEND then RECV.}}
\DoxyCodeLine{387   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (fill\_in\_proc\_trgt .GT. proc\_id) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{388     \textcolor{keyword}{CALL }mpi\_send( \&}
\DoxyCodeLine{389     \& dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice), \&}
\DoxyCodeLine{390     \& dim1\_len\_dim2\_slice\_list(proc\_id+1) \&}
\DoxyCodeLine{391     \& * dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1), mpi\_double\_complex, \&}
\DoxyCodeLine{392     \& fill\_in\_proc\_trgt, fill\_in\_proc\_trgt, mpi\_comm\_world, ierror)}
\DoxyCodeLine{393 }
\DoxyCodeLine{394     \textcolor{keyword}{CALL }mpi\_recv( \&}
\DoxyCodeLine{395     \& dim1\_slice(dim2\_low\_index\_dim1\_slice:dim2\_high\_index\_dim1\_slice,:), \&}
\DoxyCodeLine{396     \& dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) \&}
\DoxyCodeLine{397     \& * dim2\_len\_dim1\_slice\_list(proc\_id+1), mpi\_double\_complex, \&}
\DoxyCodeLine{398     \& fill\_in\_proc\_trgt, proc\_id, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{399 }
\DoxyCodeLine{400   \textcolor{comment}{! If fill\_in\_proc\_trgt = proc\_id, then fill in dim2\_slice from your}}
\DoxyCodeLine{401   \textcolor{comment}{! dim1\_slice.}}
\DoxyCodeLine{402   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{403     dim1\_slice(dim2\_low\_index\_dim1\_slice:dim2\_high\_index\_dim1\_slice,:) = \&}
\DoxyCodeLine{404     \& dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice)}
\DoxyCodeLine{405 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{406 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{407 }
\DoxyCodeLine{408 \textcolor{comment}{! Normalize the dim1\_slice for the inverse transform.}}
\DoxyCodeLine{409 norm = 1.0/dble(dim1\_len * dim2\_len\_total)}
\DoxyCodeLine{410 dim1\_slice = norm * dim1\_slice}
\DoxyCodeLine{411 }
\DoxyCodeLine{412 \textcolor{comment}{! Fill in interior of input matrix.}}
\DoxyCodeLine{413 \textcolor{keywordflow}{IF} (proc\_id .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{414   \textcolor{comment}{! First processor, fill in all except last part along dimension 2 of matrix.}}
\DoxyCodeLine{415   matrix(:, 1:dim2\_len-\/overlap) = dim1\_slice}
\DoxyCodeLine{416 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (proc\_id .EQ. proc\_count-\/1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{417   \textcolor{comment}{! Last processor, fill in all but first part along dimension 2 of matrix.}}
\DoxyCodeLine{418   matrix(:, 1+overlap:dim2\_len) = dim1\_slice}
\DoxyCodeLine{419 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{420   \textcolor{comment}{! Middle processor, fill in all but first and last part along dimension 2 of}}
\DoxyCodeLine{421   \textcolor{comment}{! matrix.}}
\DoxyCodeLine{422    matrix(:, 1+overlap:dim2\_len-\/overlap) = dim1\_slice}
\DoxyCodeLine{423 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{424 }
\DoxyCodeLine{425 \textcolor{keyword}{CALL }\mbox{\hyperlink{share__subgrid__boundaries__dble__cmplx_8f_ab72aac7a19e9dd8ef60d8f704a8aa7e4}{share\_subgrid\_boundaries\_dble\_cmplx\_ezp}}(dim1\_len, dim2\_len, overlap, \&}
\DoxyCodeLine{426 \& matrix)}
\DoxyCodeLine{427 }
\DoxyCodeLine{428 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}}
\DoxyCodeLine{429 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{430 }
\DoxyCodeLine{431 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{432 \textcolor{comment}{! ERROR\_HANDLING. Checks for input error and other possible complications.}}
\DoxyCodeLine{433 \textcolor{comment}{!}}
\DoxyCodeLine{434 \textcolor{comment}{! ERRORS TO CHECK: -\/ N/A. (Assume that users will not enter negative matrix}}
\DoxyCodeLine{435 \textcolor{comment}{! dimension lengths.)}}
\DoxyCodeLine{436 \textcolor{comment}{!}}
\DoxyCodeLine{437 \textcolor{comment}{! VARIABLES: -\/ proc\_id: Processor ID (INTEGER).}}
\DoxyCodeLine{438 \textcolor{comment}{! -\/ proc\_err\_flag -\/ Flag is triggered if processor encounters an error}}
\DoxyCodeLine{439 \textcolor{comment}{! (LOGICAL).}}
\DoxyCodeLine{440 \textcolor{comment}{! -\/ global\_err\_flag -\/ Flag is triggered if any processor encouters an error}}
\DoxyCodeLine{441 \textcolor{comment}{! (LOGICAL).}}
\DoxyCodeLine{442 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{443 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}(proc\_id)}
\DoxyCodeLine{444 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{445 }
\DoxyCodeLine{446 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{447 }
\DoxyCodeLine{448 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{449 }
\DoxyCodeLine{450 \textcolor{keywordtype}{INTEGER} :: proc\_id}
\DoxyCodeLine{451 \textcolor{keywordtype}{LOGICAL} :: proc\_err\_flag, \&}
\DoxyCodeLine{452 \& global\_err\_flag}
\DoxyCodeLine{453 }
\DoxyCodeLine{454 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{455 }
\DoxyCodeLine{456 proc\_err\_flag = .false.}
\DoxyCodeLine{457 global\_err\_flag = .false.}
\DoxyCodeLine{458 }
\DoxyCodeLine{459 \textcolor{comment}{! STOP all processors if any encounter an error.}}
\DoxyCodeLine{460 \textcolor{keyword}{CALL }mpi\_allreduce(proc\_err\_flag, global\_err\_flag, 1, mpi\_logical, mpi\_lor, \&}
\DoxyCodeLine{461 \& mpi\_comm\_world, ierror)}
\DoxyCodeLine{462 }
\DoxyCodeLine{463 \textcolor{keywordflow}{IF} (global\_err\_flag) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{464   \textcolor{keyword}{CALL }mpi\_finalize(ierror)}
\DoxyCodeLine{465   stop}
\DoxyCodeLine{466 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{467 }
\DoxyCodeLine{468 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{469 }
\DoxyCodeLine{470 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}}
\DoxyCodeLine{471 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{472 }

\end{DoxyCode}
\mbox{\Hypertarget{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}\label{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}} 
\index{cfft2db.f@{cfft2db.f}!error\_handling@{error\_handling}}
\index{error\_handling@{error\_handling}!cfft2db.f@{cfft2db.f}}
\doxysubsubsection{\texorpdfstring{error\_handling()}{error\_handling()}}
{\footnotesize\ttfamily subroutine cfft2db\+\_\+ezp\+::error\+\_\+handling (\begin{DoxyParamCaption}\item[{integer}]{proc\+\_\+id }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{444 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{445 }
\DoxyCodeLine{446 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{447 }
\DoxyCodeLine{448 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{449 }
\DoxyCodeLine{450 \textcolor{keywordtype}{INTEGER} :: proc\_id}
\DoxyCodeLine{451 \textcolor{keywordtype}{LOGICAL} :: proc\_err\_flag, \&}
\DoxyCodeLine{452 \& global\_err\_flag}
\DoxyCodeLine{453 }
\DoxyCodeLine{454 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{455 }
\DoxyCodeLine{456 proc\_err\_flag = .false.}
\DoxyCodeLine{457 global\_err\_flag = .false.}
\DoxyCodeLine{458 }
\DoxyCodeLine{459 \textcolor{comment}{! STOP all processors if any encounter an error.}}
\DoxyCodeLine{460 \textcolor{keyword}{CALL }mpi\_allreduce(proc\_err\_flag, global\_err\_flag, 1, mpi\_logical, mpi\_lor, \&}
\DoxyCodeLine{461 \& mpi\_comm\_world, ierror)}
\DoxyCodeLine{462 }
\DoxyCodeLine{463 \textcolor{keywordflow}{IF} (global\_err\_flag) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{464   \textcolor{keyword}{CALL }mpi\_finalize(ierror)}
\DoxyCodeLine{465   stop}
\DoxyCodeLine{466 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{467 }
\DoxyCodeLine{468 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{469 }

\end{DoxyCode}
\mbox{\Hypertarget{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}\label{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}} 
\index{cfft2db.f@{cfft2db.f}!parallel@{parallel}}
\index{parallel@{parallel}!cfft2db.f@{cfft2db.f}}
\doxysubsubsection{\texorpdfstring{parallel()}{parallel()}}
{\footnotesize\ttfamily subroutine cfft2db\+\_\+ezp\+::parallel (\begin{DoxyParamCaption}\item[{integer}]{dim1\+\_\+len,  }\item[{integer}]{dim2\+\_\+len,  }\item[{integer}]{overlap,  }\item[{double complex, dimension(\mbox{\hyperlink{cfft2df__unit__test__MATLAB_8m_acb4b6a591c5ad6fc207ef543dc74d1ae}{dim1\+\_\+len}}, \mbox{\hyperlink{cfft2df__unit__test__MATLAB_8m_adef80e51b1bb5916dd9410de399f1319}{dim2\+\_\+len}})}]{matrix,  }\item[{integer}]{proc\+\_\+id,  }\item[{integer}]{proc\+\_\+count }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{177 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{178 }
\DoxyCodeLine{179 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{180 }
\DoxyCodeLine{181 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{182 }
\DoxyCodeLine{183 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{184 \& dim2\_len, \&}
\DoxyCodeLine{185 \& overlap, \&}
\DoxyCodeLine{186 \& proc\_id, \&}
\DoxyCodeLine{187 \& proc\_count, \&}
\DoxyCodeLine{188 \& ierror, \&}
\DoxyCodeLine{189 \& status(MPI\_STATUS\_SIZE), \&}
\DoxyCodeLine{190 \& ii, \&}
\DoxyCodeLine{191 \& dim2\_len\_dim1\_slice, \&}
\DoxyCodeLine{192 \& dim1\_len\_dim2\_slice, \&}
\DoxyCodeLine{193 \& dim2\_len\_dim2\_slice, \&}
\DoxyCodeLine{194 \& fill\_in\_proc\_trgt, \&}
\DoxyCodeLine{195 \& dim2\_len\_total, \&}
\DoxyCodeLine{196 \& dim2\_low\_index\_dim1\_slice, \&}
\DoxyCodeLine{197 \& dim2\_high\_index\_dim1\_slice, \&}
\DoxyCodeLine{198 \& dim2\_low\_index\_dim2\_slice, \&}
\DoxyCodeLine{199 \& dim2\_high\_index\_dim2\_slice}
\DoxyCodeLine{200 \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(proc\_count)} :: dim1\_len\_dim2\_slice\_list, \&}
\DoxyCodeLine{201 \& dim2\_len\_dim1\_slice\_list}
\DoxyCodeLine{202 \textcolor{keywordtype}{DOUBLE PRECISION} :: norm}
\DoxyCodeLine{203 \textcolor{keywordtype}{DOUBLE PRECISION}, \textcolor{keywordtype}{DIMENSION(4*dim1\_len+15)} :: WSAVE1}
\DoxyCodeLine{204 \textcolor{keywordtype}{DOUBLE PRECISION}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE} :: WSAVE2}
\DoxyCodeLine{205 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(dim1\_len, dim2\_len)} :: matrix}
\DoxyCodeLine{206 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{ALLOCATABLE} :: dim1\_slice, \&}
\DoxyCodeLine{207 \& dim2\_slice, \&}
\DoxyCodeLine{208 \& dim2\_slice\_tr}
\DoxyCodeLine{209 }
\DoxyCodeLine{210 }
\DoxyCodeLine{211 \textcolor{comment}{! Trim the overlap from the input matrix.}}
\DoxyCodeLine{212 \textcolor{keywordflow}{IF} (proc\_id .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{213   \textcolor{comment}{! First processor, trim last part along dimension 2 of matrix.}}
\DoxyCodeLine{214   dim2\_len\_dim1\_slice = dim2\_len -\/ overlap}
\DoxyCodeLine{215   \textcolor{keyword}{ALLOCATE}(dim1\_slice(dim1\_len, dim2\_len\_dim1\_slice))}
\DoxyCodeLine{216   dim1\_slice = matrix(:, 1:dim2\_len-\/overlap)}
\DoxyCodeLine{217 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (proc\_id .EQ. proc\_count-\/1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{218   \textcolor{comment}{! Last processor, trim first part along dimension 2 of matrix.}}
\DoxyCodeLine{219   dim2\_len\_dim1\_slice = dim2\_len -\/ overlap}
\DoxyCodeLine{220   \textcolor{keyword}{ALLOCATE}(dim1\_slice(dim1\_len, dim2\_len\_dim1\_slice))}
\DoxyCodeLine{221   dim1\_slice = matrix(:, 1+overlap:dim2\_len)}
\DoxyCodeLine{222 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{223   \textcolor{comment}{! Middle processor, trim first and last part along dimension 2 of matrix.}}
\DoxyCodeLine{224   dim2\_len\_dim1\_slice = dim2\_len -\/ 2 * overlap}
\DoxyCodeLine{225   \textcolor{keyword}{ALLOCATE}(dim1\_slice(dim1\_len, dim2\_len\_dim1\_slice))}
\DoxyCodeLine{226   dim1\_slice = matrix(:, 1+overlap:dim2\_len-\/overlap)}
\DoxyCodeLine{227 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{228 }
\DoxyCodeLine{229 \textcolor{comment}{! Perfom 1D FFT along first dimension of dim1\_slice.}}
\DoxyCodeLine{230   \textcolor{comment}{! SW complex forward 1D FFT (FFFT) initialization, fills WSAVE1.}}
\DoxyCodeLine{231 wsave1 = 0.}
\DoxyCodeLine{232 \textcolor{keyword}{CALL }\mbox{\hyperlink{zffti_8f_aeb5f66f9b7b03cd106b8563d955a8917}{zffti}}(dim1\_len, wsave1)}
\DoxyCodeLine{233 }
\DoxyCodeLine{234 \textcolor{keywordflow}{DO} ii = 1, dim2\_len\_dim1\_slice}
\DoxyCodeLine{235   \textcolor{keyword}{CALL }\mbox{\hyperlink{zfftb_8f_ab698eb595703027e1cf9dcac305a4926}{zfftb}}(dim1\_len, dim1\_slice(:,ii), wsave1) \textcolor{comment}{! SW FFFT routine.}}
\DoxyCodeLine{236 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{237 }
\DoxyCodeLine{238 \textcolor{comment}{! \string~\string~\string~ Up to this point, we have FFT'd the grid along dimension 1.}}
\DoxyCodeLine{239 }
\DoxyCodeLine{240 \textcolor{comment}{! Now need to FFT along dim2, so we need a dim2\_slice. First, we must}}
\DoxyCodeLine{241 \textcolor{comment}{! calculate the size of dim2\_slice for all processors.}}
\DoxyCodeLine{242 \textcolor{comment}{! Calculate dim1\_len for each dim2\_slice.}}
\DoxyCodeLine{243   \textcolor{comment}{! Divide dim1\_len of total grid as evenly as possible.}}
\DoxyCodeLine{244 dim1\_len\_dim2\_slice = dim1\_len/proc\_count}
\DoxyCodeLine{245   \textcolor{comment}{! Now check if dim2\_slice of a given processor needs to take additional row,}}
\DoxyCodeLine{246   \textcolor{comment}{! i.e., dim1\_len \% proc\_count != 0.}}
\DoxyCodeLine{247 \textcolor{keywordflow}{DO} ii = 1, proc\_count}
\DoxyCodeLine{248   \textcolor{keywordflow}{IF} ((ii-\/1) .LT. modulo(dim1\_len, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{249     dim1\_len\_dim2\_slice\_list(ii) = dim1\_len\_dim2\_slice + 1}
\DoxyCodeLine{250     \textcolor{comment}{! The indexing is weird here since processors start at index 0 but arrays}}
\DoxyCodeLine{251     \textcolor{comment}{! start at index 1. Thus, entry ii of this corresponds to processor (ii-\/1).}}
\DoxyCodeLine{252   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{253     dim1\_len\_dim2\_slice\_list(ii) = dim1\_len\_dim2\_slice}
\DoxyCodeLine{254 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{255 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{256 }
\DoxyCodeLine{257 }
\DoxyCodeLine{258 \textcolor{comment}{! Calculate dim2\_len for all dim2\_slice's by adding up dim2 for each processor's}}
\DoxyCodeLine{259 \textcolor{comment}{! dim1\_slice.}}
\DoxyCodeLine{260 \textcolor{keyword}{CALL }mpi\_allreduce(dim2\_len\_dim1\_slice, dim2\_len\_dim2\_slice, 1, mpi\_integer, \&}
\DoxyCodeLine{261 \& mpi\_sum, mpi\_comm\_world, ierror)}
\DoxyCodeLine{262 }
\DoxyCodeLine{263 }
\DoxyCodeLine{264 \textcolor{comment}{! Allocate memory to dim2\_slice and fill it in.}}
\DoxyCodeLine{265 \textcolor{keyword}{ALLOCATE}(dim2\_slice(dim1\_len\_dim2\_slice\_list(proc\_id + 1), dim2\_len\_dim2\_slice))}
\DoxyCodeLine{266 dim2\_slice = (0.0, 0.0)}
\DoxyCodeLine{267 }
\DoxyCodeLine{268 \textcolor{comment}{! To fill in dim2\_slice, we need the dim2\_len of all dim1\_slice's.}}
\DoxyCodeLine{269 \textcolor{keyword}{CALL }mpi\_allreduce(dim2\_len\_dim1\_slice, dim2\_len\_total, 1, mpi\_integer, \&}
\DoxyCodeLine{270 \& mpi\_sum, mpi\_comm\_world, ierror)}
\DoxyCodeLine{271 \textcolor{comment}{! Calculate dim2\_len for each dim1\_slice, to avoid communication between}}
\DoxyCodeLine{272 \textcolor{comment}{! processors.}}
\DoxyCodeLine{273   \textcolor{comment}{! Divide dim2\_len of total grid as evenly as possible.}}
\DoxyCodeLine{274 dim2\_len\_dim1\_slice = dim2\_len\_total/proc\_count}
\DoxyCodeLine{275   \textcolor{comment}{! Now check if dim1\_slice of a given processor needs to take additional row,}}
\DoxyCodeLine{276   \textcolor{comment}{! i.e., dim2\_len \% proc\_count != 0.}}
\DoxyCodeLine{277 \textcolor{keywordflow}{DO} ii = 1, proc\_count}
\DoxyCodeLine{278   \textcolor{keywordflow}{IF} ((ii-\/1) .LT. modulo(dim2\_len\_total, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{279     dim2\_len\_dim1\_slice\_list(ii) = dim2\_len\_dim1\_slice + 1}
\DoxyCodeLine{280     \textcolor{comment}{! The indexing is weird here since processors start at index 0 but arrays}}
\DoxyCodeLine{281     \textcolor{comment}{! start at index 1. Thus, entry ii of this corresponds to processor (ii-\/1).}}
\DoxyCodeLine{282   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{283     dim2\_len\_dim1\_slice\_list(ii) = dim2\_len\_dim1\_slice}
\DoxyCodeLine{284 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{285 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{286 }
\DoxyCodeLine{287 \textcolor{comment}{! Fill in dim2\_slice using sections of the dim1\_slice's.}}
\DoxyCodeLine{288 \textcolor{keywordflow}{DO} ii = 1, proc\_count}
\DoxyCodeLine{289   fill\_in\_proc\_trgt = mod(proc\_count -\/ proc\_id + ii, proc\_count)}
\DoxyCodeLine{290   dim2\_high\_index\_dim1\_slice = \&}
\DoxyCodeLine{291   \& sum(dim1\_len\_dim2\_slice\_list(1:fill\_in\_proc\_trgt+1))}
\DoxyCodeLine{292   dim2\_low\_index\_dim1\_slice = dim2\_high\_index\_dim1\_slice \&}
\DoxyCodeLine{293   \& -\/ dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) + 1}
\DoxyCodeLine{294   dim2\_high\_index\_dim2\_slice = \&}
\DoxyCodeLine{295   \& sum(dim2\_len\_dim1\_slice\_list(1:fill\_in\_proc\_trgt+1))}
\DoxyCodeLine{296   dim2\_low\_index\_dim2\_slice = dim2\_high\_index\_dim2\_slice \&}
\DoxyCodeLine{297   \& -\/ dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1) + 1}
\DoxyCodeLine{298 }
\DoxyCodeLine{299 }
\DoxyCodeLine{300   \textcolor{comment}{! If fill\_in\_proc\_trgt < proc\_id, RECV then SEND.}}
\DoxyCodeLine{301   \textcolor{keywordflow}{IF} (fill\_in\_proc\_trgt .LT. proc\_id) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{302     \textcolor{keyword}{CALL }mpi\_recv( \&}
\DoxyCodeLine{303     \& dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice), \&}
\DoxyCodeLine{304     \& dim1\_len\_dim2\_slice\_list(proc\_id+1)\&}
\DoxyCodeLine{305     \& * dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1), mpi\_double\_complex, \&}
\DoxyCodeLine{306     \& fill\_in\_proc\_trgt, proc\_id, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{307 }
\DoxyCodeLine{308     \textcolor{keyword}{CALL }mpi\_send( \&}
\DoxyCodeLine{309     \& dim1\_slice(dim2\_low\_index\_dim1\_slice:dim2\_high\_index\_dim1\_slice,:), \&}
\DoxyCodeLine{310     dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) \&}
\DoxyCodeLine{311     \& * dim2\_len\_dim1\_slice\_list(proc\_id+1), mpi\_double\_complex, \&}
\DoxyCodeLine{312     \& fill\_in\_proc\_trgt, fill\_in\_proc\_trgt, mpi\_comm\_world, ierror)}
\DoxyCodeLine{313 }
\DoxyCodeLine{314   \textcolor{comment}{! If fill\_in\_proc\_trgt > proc\_id, SEND then RECV.}}
\DoxyCodeLine{315   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (fill\_in\_proc\_trgt .GT. proc\_id) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{316     \textcolor{keyword}{CALL }mpi\_send( \&}
\DoxyCodeLine{317     \& dim1\_slice(dim2\_low\_index\_dim1\_slice:dim2\_high\_index\_dim1\_slice,:), \&}
\DoxyCodeLine{318     \& dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) \&}
\DoxyCodeLine{319     \& * dim2\_len\_dim1\_slice\_list(proc\_id+1), mpi\_double\_complex, \&}
\DoxyCodeLine{320     \& fill\_in\_proc\_trgt, fill\_in\_proc\_trgt, mpi\_comm\_world, ierror)}
\DoxyCodeLine{321 }
\DoxyCodeLine{322     \textcolor{keyword}{CALL }mpi\_recv( \&}
\DoxyCodeLine{323     \& dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice), \&}
\DoxyCodeLine{324     \& dim1\_len\_dim2\_slice\_list(proc\_id+1) \&}
\DoxyCodeLine{325     \& * dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1), mpi\_double\_complex, \&}
\DoxyCodeLine{326     \& fill\_in\_proc\_trgt, proc\_id, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{327 }
\DoxyCodeLine{328   \textcolor{comment}{! If fill\_in\_proc\_trgt = proc\_id, then fill in dim2\_slice from your}}
\DoxyCodeLine{329   \textcolor{comment}{! dim1\_slice.}}
\DoxyCodeLine{330   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{331     dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice) = \&}
\DoxyCodeLine{332     \& dim1\_slice(dim2\_low\_index\_dim1\_slice:dim2\_high\_index\_dim1\_slice,:)}
\DoxyCodeLine{333 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{334 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{335 }
\DoxyCodeLine{336 \textcolor{comment}{! \string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~ Up to this point, each processor has a filled-\/in dim2\_slice,}}
\DoxyCodeLine{337 \textcolor{comment}{! and we are ready to FFT along dim2.}}
\DoxyCodeLine{338 \textcolor{keyword}{ALLOCATE}( \&}
\DoxyCodeLine{339 \& dim2\_slice\_tr(dim2\_len\_dim2\_slice, dim1\_len\_dim2\_slice\_list(proc\_id + 1)))}
\DoxyCodeLine{340 dim2\_slice\_tr = (0.0, 0.0)}
\DoxyCodeLine{341 dim2\_slice\_tr = transpose(dim2\_slice)}
\DoxyCodeLine{342 \textcolor{keyword}{ALLOCATE}(wsave2(4*dim2\_len\_dim2\_slice+15))}
\DoxyCodeLine{343 }
\DoxyCodeLine{344 \textcolor{comment}{! Perfom 1D FFT along first dimension of dim2\_slice\_tr (the columns of the work}}
\DoxyCodeLine{345 \textcolor{comment}{! grid).}}
\DoxyCodeLine{346   \textcolor{comment}{! SW complex forward 1D FFT (FFFT) initialization, fills WSAVE1.}}
\DoxyCodeLine{347 wsave2 = 0.}
\DoxyCodeLine{348 \textcolor{keyword}{CALL }\mbox{\hyperlink{zffti_8f_aeb5f66f9b7b03cd106b8563d955a8917}{zffti}}(dim2\_len\_dim2\_slice, wsave2)}
\DoxyCodeLine{349 }
\DoxyCodeLine{350 \textcolor{keywordflow}{DO} ii = 1, dim1\_len\_dim2\_slice\_list(proc\_id + 1)}
\DoxyCodeLine{351   \textcolor{comment}{! SW FFFT routine.}}
\DoxyCodeLine{352   \textcolor{keyword}{CALL }\mbox{\hyperlink{zfftb_8f_ab698eb595703027e1cf9dcac305a4926}{zfftb}}(dim2\_len\_dim2\_slice, dim2\_slice\_tr(:,ii), wsave2)}
\DoxyCodeLine{353 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{354 }
\DoxyCodeLine{355 dim2\_slice = transpose(dim2\_slice\_tr)}
\DoxyCodeLine{356 }
\DoxyCodeLine{357 \textcolor{comment}{! \string~\string~\string~ Up to this point, we have FFT'd along dim2, and now we must reconstruct}}
\DoxyCodeLine{358 \textcolor{comment}{! the dim1\_slice's.}}
\DoxyCodeLine{359 }
\DoxyCodeLine{360 \textcolor{comment}{! Fill in dim1\_slice using sections of the dim2\_slice's.}}
\DoxyCodeLine{361 \textcolor{keywordflow}{DO} ii = 1, proc\_count}
\DoxyCodeLine{362   fill\_in\_proc\_trgt = mod(proc\_count -\/ proc\_id + ii, proc\_count)}
\DoxyCodeLine{363   dim2\_high\_index\_dim1\_slice = \&}
\DoxyCodeLine{364   \& sum(dim1\_len\_dim2\_slice\_list(1:fill\_in\_proc\_trgt+1))}
\DoxyCodeLine{365   dim2\_low\_index\_dim1\_slice = dim2\_high\_index\_dim1\_slice \&}
\DoxyCodeLine{366   \& -\/ dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) + 1}
\DoxyCodeLine{367   dim2\_high\_index\_dim2\_slice = \&}
\DoxyCodeLine{368   \& sum(dim2\_len\_dim1\_slice\_list(1:fill\_in\_proc\_trgt+1))}
\DoxyCodeLine{369   dim2\_low\_index\_dim2\_slice = dim2\_high\_index\_dim2\_slice \&}
\DoxyCodeLine{370   \& -\/ dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1) + 1}
\DoxyCodeLine{371 }
\DoxyCodeLine{372   \textcolor{comment}{! If fill\_in\_proc\_trgt < proc\_id, RECV then SEND.}}
\DoxyCodeLine{373   \textcolor{keywordflow}{IF} (fill\_in\_proc\_trgt .LT. proc\_id) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{374     \textcolor{keyword}{CALL }mpi\_recv( \&}
\DoxyCodeLine{375     \& dim1\_slice(dim2\_low\_index\_dim1\_slice:dim2\_high\_index\_dim1\_slice,:), \&}
\DoxyCodeLine{376     \& dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) \&}
\DoxyCodeLine{377     \& * dim2\_len\_dim1\_slice\_list(proc\_id+1), mpi\_double\_complex, \&}
\DoxyCodeLine{378     \& fill\_in\_proc\_trgt, proc\_id, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{379 }
\DoxyCodeLine{380     \textcolor{keyword}{CALL }mpi\_send( \&}
\DoxyCodeLine{381     \& dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice), \&}
\DoxyCodeLine{382     \& dim1\_len\_dim2\_slice\_list(proc\_id+1) \&}
\DoxyCodeLine{383     \& * dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1), mpi\_double\_complex, \&}
\DoxyCodeLine{384     \& fill\_in\_proc\_trgt, fill\_in\_proc\_trgt, mpi\_comm\_world, ierror)}
\DoxyCodeLine{385 }
\DoxyCodeLine{386   \textcolor{comment}{! If fill\_in\_proc\_trgt > proc\_id, SEND then RECV.}}
\DoxyCodeLine{387   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (fill\_in\_proc\_trgt .GT. proc\_id) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{388     \textcolor{keyword}{CALL }mpi\_send( \&}
\DoxyCodeLine{389     \& dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice), \&}
\DoxyCodeLine{390     \& dim1\_len\_dim2\_slice\_list(proc\_id+1) \&}
\DoxyCodeLine{391     \& * dim2\_len\_dim1\_slice\_list(fill\_in\_proc\_trgt+1), mpi\_double\_complex, \&}
\DoxyCodeLine{392     \& fill\_in\_proc\_trgt, fill\_in\_proc\_trgt, mpi\_comm\_world, ierror)}
\DoxyCodeLine{393 }
\DoxyCodeLine{394     \textcolor{keyword}{CALL }mpi\_recv( \&}
\DoxyCodeLine{395     \& dim1\_slice(dim2\_low\_index\_dim1\_slice:dim2\_high\_index\_dim1\_slice,:), \&}
\DoxyCodeLine{396     \& dim1\_len\_dim2\_slice\_list(fill\_in\_proc\_trgt+1) \&}
\DoxyCodeLine{397     \& * dim2\_len\_dim1\_slice\_list(proc\_id+1), mpi\_double\_complex, \&}
\DoxyCodeLine{398     \& fill\_in\_proc\_trgt, proc\_id, mpi\_comm\_world, status, ierror)}
\DoxyCodeLine{399 }
\DoxyCodeLine{400   \textcolor{comment}{! If fill\_in\_proc\_trgt = proc\_id, then fill in dim2\_slice from your}}
\DoxyCodeLine{401   \textcolor{comment}{! dim1\_slice.}}
\DoxyCodeLine{402   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{403     dim1\_slice(dim2\_low\_index\_dim1\_slice:dim2\_high\_index\_dim1\_slice,:) = \&}
\DoxyCodeLine{404     \& dim2\_slice(:,dim2\_low\_index\_dim2\_slice:dim2\_high\_index\_dim2\_slice)}
\DoxyCodeLine{405 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{406 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{407 }
\DoxyCodeLine{408 \textcolor{comment}{! Normalize the dim1\_slice for the inverse transform.}}
\DoxyCodeLine{409 norm = 1.0/dble(dim1\_len * dim2\_len\_total)}
\DoxyCodeLine{410 dim1\_slice = norm * dim1\_slice}
\DoxyCodeLine{411 }
\DoxyCodeLine{412 \textcolor{comment}{! Fill in interior of input matrix.}}
\DoxyCodeLine{413 \textcolor{keywordflow}{IF} (proc\_id .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{414   \textcolor{comment}{! First processor, fill in all except last part along dimension 2 of matrix.}}
\DoxyCodeLine{415   matrix(:, 1:dim2\_len-\/overlap) = dim1\_slice}
\DoxyCodeLine{416 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (proc\_id .EQ. proc\_count-\/1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{417   \textcolor{comment}{! Last processor, fill in all but first part along dimension 2 of matrix.}}
\DoxyCodeLine{418   matrix(:, 1+overlap:dim2\_len) = dim1\_slice}
\DoxyCodeLine{419 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{420   \textcolor{comment}{! Middle processor, fill in all but first and last part along dimension 2 of}}
\DoxyCodeLine{421   \textcolor{comment}{! matrix.}}
\DoxyCodeLine{422    matrix(:, 1+overlap:dim2\_len-\/overlap) = dim1\_slice}
\DoxyCodeLine{423 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{424 }
\DoxyCodeLine{425 \textcolor{keyword}{CALL }\mbox{\hyperlink{share__subgrid__boundaries__dble__cmplx_8f_ab72aac7a19e9dd8ef60d8f704a8aa7e4}{share\_subgrid\_boundaries\_dble\_cmplx\_ezp}}(dim1\_len, dim2\_len, overlap, \&}
\DoxyCodeLine{426 \& matrix)}
\DoxyCodeLine{427 }

\end{DoxyCode}
\mbox{\Hypertarget{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}\label{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}} 
\index{cfft2db.f@{cfft2db.f}!serial@{serial}}
\index{serial@{serial}!cfft2db.f@{cfft2db.f}}
\doxysubsubsection{\texorpdfstring{serial()}{serial()}}
{\footnotesize\ttfamily subroutine cfft2db\+\_\+ezp\+::serial (\begin{DoxyParamCaption}\item[{integer}]{dim1\+\_\+len,  }\item[{integer}]{dim2\+\_\+len,  }\item[{integer}]{overlap,  }\item[{double complex, dimension(\mbox{\hyperlink{cfft2df__unit__test__MATLAB_8m_acb4b6a591c5ad6fc207ef543dc74d1ae}{dim1\+\_\+len}}, \mbox{\hyperlink{cfft2df__unit__test__MATLAB_8m_adef80e51b1bb5916dd9410de399f1319}{dim2\+\_\+len}})}]{matrix }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{80 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{81 }
\DoxyCodeLine{82 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{83 }
\DoxyCodeLine{84 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{85 }
\DoxyCodeLine{86 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{87 \& dim2\_len, \&}
\DoxyCodeLine{88 \& overlap, \&}
\DoxyCodeLine{89 \& ii}
\DoxyCodeLine{90 \textcolor{keywordtype}{DOUBLE PRECISION} :: norm}
\DoxyCodeLine{91 \textcolor{keywordtype}{DOUBLE PRECISION}, \textcolor{keywordtype}{DIMENSION(4*dim1\_len+15)} :: WSAVE1}
\DoxyCodeLine{92 \textcolor{keywordtype}{DOUBLE PRECISION}, \textcolor{keywordtype}{DIMENSION(4*dim2\_len+15)} :: WSAVE2}
\DoxyCodeLine{93 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(dim1\_len, dim2\_len)} :: matrix}
\DoxyCodeLine{94 \textcolor{keywordtype}{DOUBLE COMPLEX}, \textcolor{keywordtype}{DIMENSION(dim2\_len, dim1\_len)} :: matrix\_tr}
\DoxyCodeLine{95 }
\DoxyCodeLine{96 \textcolor{comment}{! SW complex forward 1D FFT (FFFT) initialization, fills WSAVE1.}}
\DoxyCodeLine{97 wsave1 = 0.0}
\DoxyCodeLine{98 \textcolor{keyword}{CALL }\mbox{\hyperlink{zffti_8f_aeb5f66f9b7b03cd106b8563d955a8917}{zffti}}(dim1\_len, wsave1)}
\DoxyCodeLine{99 }
\DoxyCodeLine{100 \textcolor{comment}{! Perform 1D FFFT on the dim1 of matrix.}}
\DoxyCodeLine{101 \textcolor{keywordflow}{DO} ii = 1, dim2\_len}
\DoxyCodeLine{102   \textcolor{keyword}{CALL }\mbox{\hyperlink{zfftb_8f_ab698eb595703027e1cf9dcac305a4926}{zfftb}}(dim1\_len, matrix(:,ii), wsave1) \textcolor{comment}{! SW FFFT routine.}}
\DoxyCodeLine{103 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{104 matrix\_tr = transpose(matrix)}
\DoxyCodeLine{105 }
\DoxyCodeLine{106 wsave2 = 0.0}
\DoxyCodeLine{107 \textcolor{keyword}{CALL }\mbox{\hyperlink{zffti_8f_aeb5f66f9b7b03cd106b8563d955a8917}{zffti}}(dim2\_len, wsave2)}
\DoxyCodeLine{108 \textcolor{comment}{! SW 1D (FFFT) initialization, fills WSAVE2.}}
\DoxyCodeLine{109 }
\DoxyCodeLine{110 \textcolor{comment}{! Perform 1D FFFT on the dim1 of matrix\_transpose.}}
\DoxyCodeLine{111 \textcolor{keywordflow}{DO} ii = 1, dim1\_len}
\DoxyCodeLine{112   \textcolor{keyword}{CALL }\mbox{\hyperlink{zfftb_8f_ab698eb595703027e1cf9dcac305a4926}{zfftb}}(dim2\_len, matrix\_tr(:,ii), wsave2)}
\DoxyCodeLine{113 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{114 matrix = transpose(matrix\_tr)}
\DoxyCodeLine{115 }
\DoxyCodeLine{116 \textcolor{comment}{! Normalize the matrix in the inverse transform.}}
\DoxyCodeLine{117 norm = 1.0/dble(dim1\_len * dim2\_len)}
\DoxyCodeLine{118 matrix = norm * matrix}
\DoxyCodeLine{119 }

\end{DoxyCode}
