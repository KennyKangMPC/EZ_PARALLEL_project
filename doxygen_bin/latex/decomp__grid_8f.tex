\hypertarget{decomp__grid_8f}{}\doxysection{C\+:/\+Users/\+Owner/\+Education and Research/\+Graduate School/\+Parallelization Module Project/\+E\+Z\+\_\+\+P\+A\+R\+A\+L\+L\+E\+L\+\_\+project/\+E\+Z\+\_\+\+P\+A\+R\+A\+L\+L\+E\+L/decomp\+\_\+grid.f File Reference}
\label{decomp__grid_8f}\index{C:/Users/Owner/Education and Research/Graduate School/Parallelization Module Project/EZ\_PARALLEL\_project/EZ\_PARALLEL/decomp\_grid.f@{C:/Users/Owner/Education and Research/Graduate School/Parallelization Module Project/EZ\_PARALLEL\_project/EZ\_PARALLEL/decomp\_grid.f}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{decomp__grid_8f_a3d23c951820c059e318e5c68e781e165}{decomp\+\_\+grid\+\_\+ezp}} (dim2\+\_\+len\+\_\+total, overlap)
\item 
subroutine \mbox{\hyperlink{decomp__grid_8f_a5cbc50f5cff5618e0d801aa64e54461e}{serial}}
\item 
subroutine \mbox{\hyperlink{decomp__grid_8f_a69aa818df7de965b70e11d1da6a843c1}{parallel}} (dim2\+\_\+len\+\_\+total, overlap, proc\+\_\+id, proc\+\_\+count)
\item 
subroutine \mbox{\hyperlink{decomp__grid_8f_aafeb5b22a88cfc4a069d1b8e0608c608}{error\+\_\+handling}} (dim2\+\_\+len\+\_\+total, overlap, proc\+\_\+id, proc\+\_\+count)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{decomp__grid_8f_a3d23c951820c059e318e5c68e781e165}\label{decomp__grid_8f_a3d23c951820c059e318e5c68e781e165}} 
\index{decomp\_grid.f@{decomp\_grid.f}!decomp\_grid\_ezp@{decomp\_grid\_ezp}}
\index{decomp\_grid\_ezp@{decomp\_grid\_ezp}!decomp\_grid.f@{decomp\_grid.f}}
\doxysubsubsection{\texorpdfstring{decomp\_grid\_ezp()}{decomp\_grid\_ezp()}}
{\footnotesize\ttfamily subroutine decomp\+\_\+grid\+\_\+ezp (\begin{DoxyParamCaption}\item[{integer}]{dim2\+\_\+len\+\_\+total,  }\item[{integer}]{overlap }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{17 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{keywordtype}{INTEGER} :: dim2\_len\_total, \&}
\DoxyCodeLine{24 \& overlap, \&}
\DoxyCodeLine{25 \& proc\_id, \&}
\DoxyCodeLine{26 \& proc\_count, \&}
\DoxyCodeLine{27 \& ierror}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{keyword}{CALL }mpi\_comm\_rank(mpi\_comm\_world, proc\_id, ierror)}
\DoxyCodeLine{30 \textcolor{keyword}{CALL }mpi\_comm\_size(mpi\_comm\_world, proc\_count, ierror)}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{comment}{! Check for errors in user input.}}
\DoxyCodeLine{33 \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}(dim2\_len\_total, overlap, proc\_id, proc\_count)}
\DoxyCodeLine{34 }
\DoxyCodeLine{35 \textcolor{comment}{! Run in serial if there is only one processor.}}
\DoxyCodeLine{36 \textcolor{keywordflow}{IF} (proc\_count .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{37   \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}}
\DoxyCodeLine{38 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{39   \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}(dim2\_len\_total, overlap, proc\_id, proc\_count)}
\DoxyCodeLine{40 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{41 }
\DoxyCodeLine{42 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{43 \textcolor{keyword}{CONTAINS}}
\DoxyCodeLine{44 }
\DoxyCodeLine{45 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{46 \textcolor{comment}{! SERIAL. Handles the execution if there is only one processor.}}
\DoxyCodeLine{47 \textcolor{comment}{!}}
\DoxyCodeLine{48 \textcolor{comment}{! STRUCTURE: N/A If there is only one processor, nothing needs to}}
\DoxyCodeLine{49 \textcolor{comment}{! be done.}}
\DoxyCodeLine{50 \textcolor{comment}{!}}
\DoxyCodeLine{51 \textcolor{comment}{! VARIABLES: N/A}}
\DoxyCodeLine{52 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{53 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}}
\DoxyCodeLine{54 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{55 }
\DoxyCodeLine{56 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{57 }
\DoxyCodeLine{58 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{59 }
\DoxyCodeLine{60 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{61 }
\DoxyCodeLine{62 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}}
\DoxyCodeLine{63 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{64 }
\DoxyCodeLine{65 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{66 \textcolor{comment}{! PARALLEL. Handles the execution if there is more than one processor.}}
\DoxyCodeLine{67 \textcolor{comment}{!}}
\DoxyCodeLine{68 \textcolor{comment}{! STRUCTURE: 1) Divide dim2\_len as easily as possible, adding 1 where necessary,}}
\DoxyCodeLine{69 \textcolor{comment}{! e.g., splitting dim2\_len = 9 among two processors, processor 0 needs 5 and}}
\DoxyCodeLine{70 \textcolor{comment}{! processor 1 needs 4.}}
\DoxyCodeLine{71 \textcolor{comment}{!}}
\DoxyCodeLine{72 \textcolor{comment}{! VARIABLES: -\/ dim2\_len\_total: The size of dim2 of the grid (INTEGER).}}
\DoxyCodeLine{73 \textcolor{comment}{! -\/ overlap: The overlap required for the numerical scheme (INTEGER).}}
\DoxyCodeLine{74 \textcolor{comment}{! -\/ proc\_id: Processor ID (INTEGER).}}
\DoxyCodeLine{75 \textcolor{comment}{! -\/ proc\_count: Total number of processors (INTEGER).}}
\DoxyCodeLine{76 \textcolor{comment}{! -\/ dim2\_len: Size of dim2 of the sub-\/grid (INTEGER).}}
\DoxyCodeLine{77 \textcolor{comment}{! -\/ ierror: Integer for holding MPI error flag IDs (INTEGER).}}
\DoxyCodeLine{78 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{79 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}(dim2\_len\_total, overlap, proc\_id, proc\_count)}
\DoxyCodeLine{80 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{81 }
\DoxyCodeLine{82 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{83 }
\DoxyCodeLine{84 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{85 }
\DoxyCodeLine{86 \textcolor{keywordtype}{INTEGER} :: dim2\_len\_total, \&}
\DoxyCodeLine{87 \& overlap, \&}
\DoxyCodeLine{88 \& proc\_id, \&}
\DoxyCodeLine{89 \& proc\_count, \&}
\DoxyCodeLine{90 \& dim2\_len, \&}
\DoxyCodeLine{91 \& ierror}
\DoxyCodeLine{92 }
\DoxyCodeLine{93 \textcolor{comment}{! Divide dim2\_len\_total as evenly as possible, ignoring overlap.}}
\DoxyCodeLine{94 dim2\_len = dim2\_len\_total/proc\_count}
\DoxyCodeLine{95 }
\DoxyCodeLine{96 \textcolor{comment}{! Add 1 to dim2\_len if the sub-\/grid would be big enough, see STRUCTURE for}}
\DoxyCodeLine{97 \textcolor{comment}{! example.}}
\DoxyCodeLine{98 \textcolor{keywordflow}{IF} (proc\_id .LT. modulo(dim2\_len\_total, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{99   dim2\_len = dim2\_len + 1}
\DoxyCodeLine{100 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{101 }
\DoxyCodeLine{102 \textcolor{comment}{! Increase dim2\_len for overlap.}}
\DoxyCodeLine{103 \textcolor{comment}{! Interior sub-\/grid.}}
\DoxyCodeLine{104 \textcolor{keywordflow}{IF} (mod(proc\_id, proc\_count-\/1) .NE. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{105   dim2\_len = dim2\_len + 2 * overlap}
\DoxyCodeLine{106 \textcolor{comment}{! Boundary sub-\/grid.}}
\DoxyCodeLine{107 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (modulo(proc\_id, proc\_count-\/1) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{108   dim2\_len = dim2\_len + overlap}
\DoxyCodeLine{109 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{110 }
\DoxyCodeLine{111 dim2\_len\_total = dim2\_len}
\DoxyCodeLine{112 }
\DoxyCodeLine{113 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}}
\DoxyCodeLine{114 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{115 }
\DoxyCodeLine{116 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{117 \textcolor{comment}{! ERROR\_HANDLING. Checks for input error and other possible complications.}}
\DoxyCodeLine{118 \textcolor{comment}{!}}
\DoxyCodeLine{119 \textcolor{comment}{! ERRORS TO CHECK: -\/ overlap too large (overlap >= dim2\_len for any processor).}}
\DoxyCodeLine{120 \textcolor{comment}{! -\/ overlap < 0.}}
\DoxyCodeLine{121 \textcolor{comment}{!}}
\DoxyCodeLine{122 \textcolor{comment}{! VARIABLES: -\/ dim2\_len\_total: The size of dim2 of the grid (INTEGER).}}
\DoxyCodeLine{123 \textcolor{comment}{! -\/ overlap: The overlap required for the numerical scheme (INTEGER).}}
\DoxyCodeLine{124 \textcolor{comment}{! -\/ proc\_id: Processor ID (INTEGER).}}
\DoxyCodeLine{125 \textcolor{comment}{! -\/ proc\_count: Total number of processors (INTEGER).}}
\DoxyCodeLine{126 \textcolor{comment}{! -\/ proc\_err\_flag -\/ Flag is triggered if processor encounters an error}}
\DoxyCodeLine{127 \textcolor{comment}{! (LOGICAL).}}
\DoxyCodeLine{128 \textcolor{comment}{! -\/ global\_err\_flag -\/ Flag is triggered if any processor encouters an error}}
\DoxyCodeLine{129 \textcolor{comment}{! (LOGICAL).}}
\DoxyCodeLine{130 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{131 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}(dim2\_len\_total, overlap, proc\_id, proc\_count)}
\DoxyCodeLine{132 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{133 }
\DoxyCodeLine{134 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{135 }
\DoxyCodeLine{136 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{137 }
\DoxyCodeLine{138 \textcolor{keywordtype}{INTEGER} :: dim2\_len\_total, \&}
\DoxyCodeLine{139 \& overlap, \&}
\DoxyCodeLine{140 \& proc\_id, \&}
\DoxyCodeLine{141 \& proc\_count}
\DoxyCodeLine{142 \textcolor{keywordtype}{LOGICAL} :: proc\_err\_flag, \&}
\DoxyCodeLine{143 \& global\_err\_flag}
\DoxyCodeLine{144 }
\DoxyCodeLine{145 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{146 }
\DoxyCodeLine{147 proc\_err\_flag = .false.}
\DoxyCodeLine{148 global\_err\_flag = .false.}
\DoxyCodeLine{149 }
\DoxyCodeLine{150 \textcolor{comment}{! overlap too large. Only processor 0 needs to check this.}}
\DoxyCodeLine{151 \textcolor{keywordflow}{IF} ((proc\_id .EQ. 0) .AND. (overlap .GE. dim2\_len\_total/proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{152   proc\_err\_flag = .true.}
\DoxyCodeLine{153   print *, \textcolor{stringliteral}{'EZ\_PARALLEL: Issue with subroutine call DECOMP\_GRID. overlap: '}, \&}
\DoxyCodeLine{154   \& overlap, \textcolor{stringliteral}{' is greater than or equal to dim2\_len '}, \&}
\DoxyCodeLine{155   \& dim2\_len\_total/proc\_count, \textcolor{stringliteral}{' of some processor.'}}
\DoxyCodeLine{156   print *, \textcolor{stringliteral}{'Please decrease the overlap, decrease the number of processors, '}, \&}
\DoxyCodeLine{157   \& \textcolor{stringliteral}{'or increase the size of the second dimension of the grid.'}}
\DoxyCodeLine{158 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{159 }
\DoxyCodeLine{160 \textcolor{comment}{! overlap < 1. Only processor 0 needs to check this.}}
\DoxyCodeLine{161 \textcolor{keywordflow}{IF} ((proc\_id .EQ. 0) .AND. (overlap .LT. 0)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{162   proc\_err\_flag = .true.}
\DoxyCodeLine{163   print *, \textcolor{stringliteral}{'EZ\_PARALLEL: Issue with subroutine call DECOMP\_GRID. overlap: '}, \&}
\DoxyCodeLine{164   \& overlap, \textcolor{stringliteral}{' is negative.'}}
\DoxyCodeLine{165   print *, \textcolor{stringliteral}{'Please increase the overlap.'}}
\DoxyCodeLine{166 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{167 }
\DoxyCodeLine{168 \textcolor{comment}{! STOP all processors if any encounter an error.}}
\DoxyCodeLine{169 \textcolor{keyword}{CALL }mpi\_allreduce(proc\_err\_flag, global\_err\_flag, 1, mpi\_logical, mpi\_lor, \&}
\DoxyCodeLine{170 \& mpi\_comm\_world, ierror)}
\DoxyCodeLine{171 }
\DoxyCodeLine{172 \textcolor{keywordflow}{IF} (global\_err\_flag) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{173   \textcolor{keyword}{CALL }mpi\_finalize(ierror)}
\DoxyCodeLine{174   stop}
\DoxyCodeLine{175 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{176 }
\DoxyCodeLine{177 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{178 }
\DoxyCodeLine{179 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}}
\DoxyCodeLine{180 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{181 }

\end{DoxyCode}
\mbox{\Hypertarget{decomp__grid_8f_aafeb5b22a88cfc4a069d1b8e0608c608}\label{decomp__grid_8f_aafeb5b22a88cfc4a069d1b8e0608c608}} 
\index{decomp\_grid.f@{decomp\_grid.f}!error\_handling@{error\_handling}}
\index{error\_handling@{error\_handling}!decomp\_grid.f@{decomp\_grid.f}}
\doxysubsubsection{\texorpdfstring{error\_handling()}{error\_handling()}}
{\footnotesize\ttfamily subroutine decomp\+\_\+grid\+\_\+ezp\+::error\+\_\+handling (\begin{DoxyParamCaption}\item[{integer}]{dim2\+\_\+len\+\_\+total,  }\item[{integer}]{overlap,  }\item[{integer}]{proc\+\_\+id,  }\item[{integer}]{proc\+\_\+count }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{132 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{133 }
\DoxyCodeLine{134 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{135 }
\DoxyCodeLine{136 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{137 }
\DoxyCodeLine{138 \textcolor{keywordtype}{INTEGER} :: dim2\_len\_total, \&}
\DoxyCodeLine{139 \& overlap, \&}
\DoxyCodeLine{140 \& proc\_id, \&}
\DoxyCodeLine{141 \& proc\_count}
\DoxyCodeLine{142 \textcolor{keywordtype}{LOGICAL} :: proc\_err\_flag, \&}
\DoxyCodeLine{143 \& global\_err\_flag}
\DoxyCodeLine{144 }
\DoxyCodeLine{145 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{146 }
\DoxyCodeLine{147 proc\_err\_flag = .false.}
\DoxyCodeLine{148 global\_err\_flag = .false.}
\DoxyCodeLine{149 }
\DoxyCodeLine{150 \textcolor{comment}{! overlap too large. Only processor 0 needs to check this.}}
\DoxyCodeLine{151 \textcolor{keywordflow}{IF} ((proc\_id .EQ. 0) .AND. (overlap .GE. dim2\_len\_total/proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{152   proc\_err\_flag = .true.}
\DoxyCodeLine{153   print *, \textcolor{stringliteral}{'EZ\_PARALLEL: Issue with subroutine call DECOMP\_GRID. overlap: '}, \&}
\DoxyCodeLine{154   \& overlap, \textcolor{stringliteral}{' is greater than or equal to dim2\_len '}, \&}
\DoxyCodeLine{155   \& dim2\_len\_total/proc\_count, \textcolor{stringliteral}{' of some processor.'}}
\DoxyCodeLine{156   print *, \textcolor{stringliteral}{'Please decrease the overlap, decrease the number of processors, '}, \&}
\DoxyCodeLine{157   \& \textcolor{stringliteral}{'or increase the size of the second dimension of the grid.'}}
\DoxyCodeLine{158 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{159 }
\DoxyCodeLine{160 \textcolor{comment}{! overlap < 1. Only processor 0 needs to check this.}}
\DoxyCodeLine{161 \textcolor{keywordflow}{IF} ((proc\_id .EQ. 0) .AND. (overlap .LT. 0)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{162   proc\_err\_flag = .true.}
\DoxyCodeLine{163   print *, \textcolor{stringliteral}{'EZ\_PARALLEL: Issue with subroutine call DECOMP\_GRID. overlap: '}, \&}
\DoxyCodeLine{164   \& overlap, \textcolor{stringliteral}{' is negative.'}}
\DoxyCodeLine{165   print *, \textcolor{stringliteral}{'Please increase the overlap.'}}
\DoxyCodeLine{166 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{167 }
\DoxyCodeLine{168 \textcolor{comment}{! STOP all processors if any encounter an error.}}
\DoxyCodeLine{169 \textcolor{keyword}{CALL }mpi\_allreduce(proc\_err\_flag, global\_err\_flag, 1, mpi\_logical, mpi\_lor, \&}
\DoxyCodeLine{170 \& mpi\_comm\_world, ierror)}
\DoxyCodeLine{171 }
\DoxyCodeLine{172 \textcolor{keywordflow}{IF} (global\_err\_flag) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{173   \textcolor{keyword}{CALL }mpi\_finalize(ierror)}
\DoxyCodeLine{174   stop}
\DoxyCodeLine{175 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{176 }
\DoxyCodeLine{177 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{178 }

\end{DoxyCode}
\mbox{\Hypertarget{decomp__grid_8f_a69aa818df7de965b70e11d1da6a843c1}\label{decomp__grid_8f_a69aa818df7de965b70e11d1da6a843c1}} 
\index{decomp\_grid.f@{decomp\_grid.f}!parallel@{parallel}}
\index{parallel@{parallel}!decomp\_grid.f@{decomp\_grid.f}}
\doxysubsubsection{\texorpdfstring{parallel()}{parallel()}}
{\footnotesize\ttfamily subroutine decomp\+\_\+grid\+\_\+ezp\+::parallel (\begin{DoxyParamCaption}\item[{integer}]{dim2\+\_\+len\+\_\+total,  }\item[{integer}]{overlap,  }\item[{integer}]{proc\+\_\+id,  }\item[{integer}]{proc\+\_\+count }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{80 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{81 }
\DoxyCodeLine{82 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{83 }
\DoxyCodeLine{84 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{85 }
\DoxyCodeLine{86 \textcolor{keywordtype}{INTEGER} :: dim2\_len\_total, \&}
\DoxyCodeLine{87 \& overlap, \&}
\DoxyCodeLine{88 \& proc\_id, \&}
\DoxyCodeLine{89 \& proc\_count, \&}
\DoxyCodeLine{90 \& dim2\_len, \&}
\DoxyCodeLine{91 \& ierror}
\DoxyCodeLine{92 }
\DoxyCodeLine{93 \textcolor{comment}{! Divide dim2\_len\_total as evenly as possible, ignoring overlap.}}
\DoxyCodeLine{94 dim2\_len = dim2\_len\_total/proc\_count}
\DoxyCodeLine{95 }
\DoxyCodeLine{96 \textcolor{comment}{! Add 1 to dim2\_len if the sub-\/grid would be big enough, see STRUCTURE for}}
\DoxyCodeLine{97 \textcolor{comment}{! example.}}
\DoxyCodeLine{98 \textcolor{keywordflow}{IF} (proc\_id .LT. modulo(dim2\_len\_total, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{99   dim2\_len = dim2\_len + 1}
\DoxyCodeLine{100 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{101 }
\DoxyCodeLine{102 \textcolor{comment}{! Increase dim2\_len for overlap.}}
\DoxyCodeLine{103 \textcolor{comment}{! Interior sub-\/grid.}}
\DoxyCodeLine{104 \textcolor{keywordflow}{IF} (mod(proc\_id, proc\_count-\/1) .NE. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{105   dim2\_len = dim2\_len + 2 * overlap}
\DoxyCodeLine{106 \textcolor{comment}{! Boundary sub-\/grid.}}
\DoxyCodeLine{107 \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (modulo(proc\_id, proc\_count-\/1) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{108   dim2\_len = dim2\_len + overlap}
\DoxyCodeLine{109 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{110 }
\DoxyCodeLine{111 dim2\_len\_total = dim2\_len}
\DoxyCodeLine{112 }

\end{DoxyCode}
\mbox{\Hypertarget{decomp__grid_8f_a5cbc50f5cff5618e0d801aa64e54461e}\label{decomp__grid_8f_a5cbc50f5cff5618e0d801aa64e54461e}} 
\index{decomp\_grid.f@{decomp\_grid.f}!serial@{serial}}
\index{serial@{serial}!decomp\_grid.f@{decomp\_grid.f}}
\doxysubsubsection{\texorpdfstring{serial()}{serial()}}
{\footnotesize\ttfamily subroutine decomp\+\_\+grid\+\_\+ezp\+::serial}


\begin{DoxyCode}{0}
\DoxyCodeLine{54 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{55 }
\DoxyCodeLine{56 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{57 }
\DoxyCodeLine{58 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{59 }
\DoxyCodeLine{60 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{61 }

\end{DoxyCode}
