\hypertarget{identify__ref__point_8f}{}\doxysection{C\+:/\+Users/\+Owner/\+Education and Research/\+Graduate School/\+Parallelization Module Project/\+E\+Z\+\_\+\+P\+A\+R\+A\+L\+L\+E\+L\+\_\+project/\+E\+Z\+\_\+\+P\+A\+R\+A\+L\+L\+E\+L/identify\+\_\+ref\+\_\+point.f File Reference}
\label{identify__ref__point_8f}\index{C:/Users/Owner/Education and Research/Graduate School/Parallelization Module Project/EZ\_PARALLEL\_project/EZ\_PARALLEL/identify\_ref\_point.f@{C:/Users/Owner/Education and Research/Graduate School/Parallelization Module Project/EZ\_PARALLEL\_project/EZ\_PARALLEL/identify\_ref\_point.f}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{identify__ref__point_8f_ac016bc84d13cb001edb3210843abc4c2}{identify\+\_\+ref\+\_\+point\+\_\+ezp}} (dim2\+\_\+len, dim2\+\_\+ref, dim2\+\_\+spc, overlap)
\item 
subroutine \mbox{\hyperlink{identify__ref__point_8f_a15cadecc3999cf2b1e7b7c95d30590c5}{serial}}
\item 
subroutine \mbox{\hyperlink{identify__ref__point_8f_ad2a3956e40d76fa7a15063afc098055a}{parallel}} (dim2\+\_\+len, dim2\+\_\+ref, dim2\+\_\+spc, overlap, proc\+\_\+id, proc\+\_\+count)
\item 
subroutine \mbox{\hyperlink{identify__ref__point_8f_a5275d8961d32bc36735eedf3bdd867f6}{error\+\_\+handling}} (proc\+\_\+id)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{identify__ref__point_8f_a5275d8961d32bc36735eedf3bdd867f6}\label{identify__ref__point_8f_a5275d8961d32bc36735eedf3bdd867f6}} 
\index{identify\_ref\_point.f@{identify\_ref\_point.f}!error\_handling@{error\_handling}}
\index{error\_handling@{error\_handling}!identify\_ref\_point.f@{identify\_ref\_point.f}}
\doxysubsubsection{\texorpdfstring{error\_handling()}{error\_handling()}}
{\footnotesize\ttfamily subroutine identify\+\_\+ref\+\_\+point\+\_\+ezp\+::error\+\_\+handling (\begin{DoxyParamCaption}\item[{integer}]{proc\+\_\+id }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{160 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{161 }
\DoxyCodeLine{162 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{163 }
\DoxyCodeLine{164 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{165 }
\DoxyCodeLine{166 \textcolor{keywordtype}{INTEGER} :: proc\_id}
\DoxyCodeLine{167 \textcolor{keywordtype}{LOGICAL} :: proc\_err\_flag, \&}
\DoxyCodeLine{168 \& global\_err\_flag}
\DoxyCodeLine{169 }
\DoxyCodeLine{170 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{171 }
\DoxyCodeLine{172 proc\_err\_flag = .false.}
\DoxyCodeLine{173 global\_err\_flag = .false.}
\DoxyCodeLine{174 }
\DoxyCodeLine{175 \textcolor{comment}{! STOP all processors if any encounter an error.}}
\DoxyCodeLine{176 \textcolor{keyword}{CALL }mpi\_allreduce(proc\_err\_flag, global\_err\_flag, 1, mpi\_logical, mpi\_lor, \&}
\DoxyCodeLine{177 \& mpi\_comm\_world, ierror)}
\DoxyCodeLine{178 }
\DoxyCodeLine{179 \textcolor{keywordflow}{IF} (global\_err\_flag) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{180   \textcolor{keyword}{CALL }mpi\_finalize(ierror)}
\DoxyCodeLine{181   stop}
\DoxyCodeLine{182 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{183 }
\DoxyCodeLine{184 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{185 }

\end{DoxyCode}
\mbox{\Hypertarget{identify__ref__point_8f_ac016bc84d13cb001edb3210843abc4c2}\label{identify__ref__point_8f_ac016bc84d13cb001edb3210843abc4c2}} 
\index{identify\_ref\_point.f@{identify\_ref\_point.f}!identify\_ref\_point\_ezp@{identify\_ref\_point\_ezp}}
\index{identify\_ref\_point\_ezp@{identify\_ref\_point\_ezp}!identify\_ref\_point.f@{identify\_ref\_point.f}}
\doxysubsubsection{\texorpdfstring{identify\_ref\_point\_ezp()}{identify\_ref\_point\_ezp()}}
{\footnotesize\ttfamily subroutine identify\+\_\+ref\+\_\+point\+\_\+ezp (\begin{DoxyParamCaption}\item[{integer}]{dim2\+\_\+len,  }\item[{double precision}]{dim2\+\_\+ref,  }\item[{double precision}]{dim2\+\_\+spc,  }\item[{integer}]{overlap }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{21 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{keywordtype}{INTEGER} :: dim2\_len, \&}
\DoxyCodeLine{28 \& overlap, \&}
\DoxyCodeLine{29 \& proc\_id, \&}
\DoxyCodeLine{30 \& proc\_count, \&}
\DoxyCodeLine{31 \& ierror}
\DoxyCodeLine{32 \textcolor{keywordtype}{DOUBLE PRECISION} :: dim2\_ref, \&}
\DoxyCodeLine{33 \& dim2\_spc}
\DoxyCodeLine{34 }
\DoxyCodeLine{35 \textcolor{keyword}{CALL }mpi\_comm\_rank(mpi\_comm\_world, proc\_id, ierror)}
\DoxyCodeLine{36 \textcolor{keyword}{CALL }mpi\_comm\_size(mpi\_comm\_world, proc\_count, ierror)}
\DoxyCodeLine{37 }
\DoxyCodeLine{38 \textcolor{comment}{! Check for errors in user input.}}
\DoxyCodeLine{39 \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}(proc\_id)}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 \textcolor{comment}{! Run in serial if there is only one processor.}}
\DoxyCodeLine{42 \textcolor{keywordflow}{IF} (proc\_count .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{43   \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}}
\DoxyCodeLine{44 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{45   \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}(dim2\_len, dim2\_ref, dim2\_spc, overlap, proc\_id, proc\_count)}
\DoxyCodeLine{46 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48 }
\DoxyCodeLine{49 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{50 \textcolor{keyword}{CONTAINS}}
\DoxyCodeLine{51 }
\DoxyCodeLine{52 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{53 \textcolor{comment}{! SERIAL. Handles the execution if there is only one processor.}}
\DoxyCodeLine{54 \textcolor{comment}{!}}
\DoxyCodeLine{55 \textcolor{comment}{! STRUCTURE: N/A If there is only one processor, nothing needs to}}
\DoxyCodeLine{56 \textcolor{comment}{! be done.}}
\DoxyCodeLine{57 \textcolor{comment}{!}}
\DoxyCodeLine{58 \textcolor{comment}{! VARIABLES: N/A}}
\DoxyCodeLine{59 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{60 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}}
\DoxyCodeLine{61 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{64 }
\DoxyCodeLine{65 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{66 }
\DoxyCodeLine{67 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}}
\DoxyCodeLine{68 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{69 }
\DoxyCodeLine{70 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{71 \textcolor{comment}{! PARALLEL. Handles the execution if there is more than one processor.}}
\DoxyCodeLine{72 \textcolor{comment}{!}}
\DoxyCodeLine{73 \textcolor{comment}{! STRUCTURE:}}
\DoxyCodeLine{74 \textcolor{comment}{!}}
\DoxyCodeLine{75 \textcolor{comment}{! VARIABLES: -\/ dim1\_len, dim2\_len: The shape of the sub-\/grid (INTEGER).}}
\DoxyCodeLine{76 \textcolor{comment}{! -\/ overlap: The overlap required for the numerical scheme (INTEGER).}}
\DoxyCodeLine{77 \textcolor{comment}{! -\/ proc\_id: Processor ID (INTEGER).}}
\DoxyCodeLine{78 \textcolor{comment}{! -\/ proc\_count: Total number of processors (INTEGER).}}
\DoxyCodeLine{79 \textcolor{comment}{! -\/ dim2\_len\_raw: Dim2 length of the interior of the sub-\/grid (INTEGER).}}
\DoxyCodeLine{80 \textcolor{comment}{! -\/ dim2\_len\_total: Dim2 length of the grid (INTEGER).}}
\DoxyCodeLine{81 \textcolor{comment}{! -\/ dim2\_len\_pre: Dim2 length of all processors with lesser ID, i.e., the global}}
\DoxyCodeLine{82 \textcolor{comment}{! dim2 index for the non-\/overlap part of the sub-\/grid (INTEGER).}}
\DoxyCodeLine{83 \textcolor{comment}{! -\/ ierror: Integer for holding MPI error flag IDs (INTEGER).}}
\DoxyCodeLine{84 \textcolor{comment}{! -\/ i: Counting index used in DO loops (INTEGER).}}
\DoxyCodeLine{85 \textcolor{comment}{! -\/ dim2\_len\_list: Array of the dim2\_len for all processors (INTEGER,}}
\DoxyCodeLine{86 \textcolor{comment}{! DIMENSION(proc\_count)).}}
\DoxyCodeLine{87 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{88 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}(dim2\_len, dim2\_ref, dim2\_spc, overlap, proc\_id, proc\_count)}
\DoxyCodeLine{89 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{90 }
\DoxyCodeLine{91 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{92 }
\DoxyCodeLine{93 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{94 }
\DoxyCodeLine{95 \textcolor{keywordtype}{INTEGER} :: dim2\_len, \&}
\DoxyCodeLine{96 \& overlap, \&}
\DoxyCodeLine{97 \& dim2\_len\_raw, \&}
\DoxyCodeLine{98 \& dim2\_len\_total, \&}
\DoxyCodeLine{99 \& dim2\_len\_pre, \&}
\DoxyCodeLine{100 \& proc\_id, \&}
\DoxyCodeLine{101 \& proc\_count, \&}
\DoxyCodeLine{102 \& ierror, \&}
\DoxyCodeLine{103 \& i}
\DoxyCodeLine{104 \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(proc\_count)} :: dim2\_len\_list}
\DoxyCodeLine{105 \textcolor{keywordtype}{DOUBLE PRECISION} :: dim2\_ref, \&}
\DoxyCodeLine{106 \& dim2\_spc}
\DoxyCodeLine{107 }
\DoxyCodeLine{108 \textcolor{comment}{! Calculate dim2 of sub-\/grid to send along.}}
\DoxyCodeLine{109 \textcolor{keywordflow}{IF} (mod(proc\_id, proc\_count-\/1) .EQ. 0)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{110   \textcolor{comment}{! First or last processor processor.}}
\DoxyCodeLine{111   dim2\_len\_raw = dim2\_len -\/ overlap}
\DoxyCodeLine{112 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{113   \textcolor{comment}{! Middle processor.}}
\DoxyCodeLine{114   dim2\_len\_raw = dim2\_len -\/ 2 * overlap}
\DoxyCodeLine{115 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{116 }
\DoxyCodeLine{117 \textcolor{keyword}{CALL }mpi\_allreduce(dim2\_len\_raw, dim2\_len\_total, 1, mpi\_integer, mpi\_sum, \&}
\DoxyCodeLine{118 \& mpi\_comm\_world, ierror)}
\DoxyCodeLine{119 }
\DoxyCodeLine{120 \textcolor{comment}{! Calculate dim2\_len for each sub-\/grid, to avoid communication between processors.}}
\DoxyCodeLine{121   \textcolor{comment}{! Divide dim2\_len\_total as evenly as possible.}}
\DoxyCodeLine{122 dim2\_len\_raw = dim2\_len\_total/proc\_count}
\DoxyCodeLine{123   \textcolor{comment}{! Now check if sub-\/grid of a given processor needs to take additional dim2\_len,}}
\DoxyCodeLine{124   \textcolor{comment}{! i.e., dim2\_len\_total \% proc\_count != 0.}}
\DoxyCodeLine{125 \textcolor{keywordflow}{DO} i = 1, proc\_count}
\DoxyCodeLine{126   \textcolor{keywordflow}{IF} ((i-\/1) .LT. modulo(dim2\_len\_total, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{127     dim2\_len\_list(i) = dim2\_len\_raw + 1}
\DoxyCodeLine{128     \textcolor{comment}{! The indexing is weird here since processors start at index 0 but arrays}}
\DoxyCodeLine{129     \textcolor{comment}{! start at index 1. Thus, entry ii of this corresponds to processor (i-\/1).}}
\DoxyCodeLine{130   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{131     dim2\_len\_list(i) = dim2\_len\_raw}
\DoxyCodeLine{132 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{133 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{134 }
\DoxyCodeLine{135 \textcolor{comment}{! Calculate the lesser dim2 grid indices of the sub-\/grid (the global coordinate}}
\DoxyCodeLine{136 \textcolor{comment}{! of the sub-\/grid). All processors besides 0 need 1 more and to subtract the}}
\DoxyCodeLine{137 \textcolor{comment}{! overlap to get the correct index.}}
\DoxyCodeLine{138 dim2\_len\_pre = sum(dim2\_len\_list(1:proc\_id))}
\DoxyCodeLine{139 \textcolor{keywordflow}{IF} (proc\_id .NE. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{140   dim2\_len\_pre = dim2\_len\_pre -\/ overlap}
\DoxyCodeLine{141 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{142 }
\DoxyCodeLine{143 dim2\_ref = dim2\_ref + dim2\_len\_pre * dim2\_spc}
\DoxyCodeLine{144 }
\DoxyCodeLine{145 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}}
\DoxyCodeLine{146 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{147 }
\DoxyCodeLine{148 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{149 \textcolor{comment}{! ERROR\_HANDLING. Checks for input error and other possible complications.}}
\DoxyCodeLine{150 \textcolor{comment}{!}}
\DoxyCodeLine{151 \textcolor{comment}{! ERRORS TO CHECK: N/A. All possible errors checked by subroutines before this.}}
\DoxyCodeLine{152 \textcolor{comment}{!}}
\DoxyCodeLine{153 \textcolor{comment}{! VARIABLES: -\/ proc\_id: Processor ID (INTEGER).}}
\DoxyCodeLine{154 \textcolor{comment}{! -\/ proc\_err\_flag -\/ Flag is triggered if processor encounters an error}}
\DoxyCodeLine{155 \textcolor{comment}{! (LOGICAL).}}
\DoxyCodeLine{156 \textcolor{comment}{! -\/ global\_err\_flag -\/ Flag is triggered if any processor encouters an error}}
\DoxyCodeLine{157 \textcolor{comment}{! (LOGICAL).}}
\DoxyCodeLine{158 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{159 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}(proc\_id)}
\DoxyCodeLine{160 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{161 }
\DoxyCodeLine{162 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{163 }
\DoxyCodeLine{164 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{165 }
\DoxyCodeLine{166 \textcolor{keywordtype}{INTEGER} :: proc\_id}
\DoxyCodeLine{167 \textcolor{keywordtype}{LOGICAL} :: proc\_err\_flag, \&}
\DoxyCodeLine{168 \& global\_err\_flag}
\DoxyCodeLine{169 }
\DoxyCodeLine{170 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{171 }
\DoxyCodeLine{172 proc\_err\_flag = .false.}
\DoxyCodeLine{173 global\_err\_flag = .false.}
\DoxyCodeLine{174 }
\DoxyCodeLine{175 \textcolor{comment}{! STOP all processors if any encounter an error.}}
\DoxyCodeLine{176 \textcolor{keyword}{CALL }mpi\_allreduce(proc\_err\_flag, global\_err\_flag, 1, mpi\_logical, mpi\_lor, \&}
\DoxyCodeLine{177 \& mpi\_comm\_world, ierror)}
\DoxyCodeLine{178 }
\DoxyCodeLine{179 \textcolor{keywordflow}{IF} (global\_err\_flag) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{180   \textcolor{keyword}{CALL }mpi\_finalize(ierror)}
\DoxyCodeLine{181   stop}
\DoxyCodeLine{182 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{183 }
\DoxyCodeLine{184 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{185 }
\DoxyCodeLine{186 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}}
\DoxyCodeLine{187 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{188 }

\end{DoxyCode}
\mbox{\Hypertarget{identify__ref__point_8f_ad2a3956e40d76fa7a15063afc098055a}\label{identify__ref__point_8f_ad2a3956e40d76fa7a15063afc098055a}} 
\index{identify\_ref\_point.f@{identify\_ref\_point.f}!parallel@{parallel}}
\index{parallel@{parallel}!identify\_ref\_point.f@{identify\_ref\_point.f}}
\doxysubsubsection{\texorpdfstring{parallel()}{parallel()}}
{\footnotesize\ttfamily subroutine identify\+\_\+ref\+\_\+point\+\_\+ezp\+::parallel (\begin{DoxyParamCaption}\item[{integer}]{dim2\+\_\+len,  }\item[{double precision}]{dim2\+\_\+ref,  }\item[{double precision}]{dim2\+\_\+spc,  }\item[{integer}]{overlap,  }\item[{integer}]{proc\+\_\+id,  }\item[{integer}]{proc\+\_\+count }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{89 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{90 }
\DoxyCodeLine{91 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{92 }
\DoxyCodeLine{93 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{94 }
\DoxyCodeLine{95 \textcolor{keywordtype}{INTEGER} :: dim2\_len, \&}
\DoxyCodeLine{96 \& overlap, \&}
\DoxyCodeLine{97 \& dim2\_len\_raw, \&}
\DoxyCodeLine{98 \& dim2\_len\_total, \&}
\DoxyCodeLine{99 \& dim2\_len\_pre, \&}
\DoxyCodeLine{100 \& proc\_id, \&}
\DoxyCodeLine{101 \& proc\_count, \&}
\DoxyCodeLine{102 \& ierror, \&}
\DoxyCodeLine{103 \& i}
\DoxyCodeLine{104 \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(proc\_count)} :: dim2\_len\_list}
\DoxyCodeLine{105 \textcolor{keywordtype}{DOUBLE PRECISION} :: dim2\_ref, \&}
\DoxyCodeLine{106 \& dim2\_spc}
\DoxyCodeLine{107 }
\DoxyCodeLine{108 \textcolor{comment}{! Calculate dim2 of sub-\/grid to send along.}}
\DoxyCodeLine{109 \textcolor{keywordflow}{IF} (mod(proc\_id, proc\_count-\/1) .EQ. 0)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{110   \textcolor{comment}{! First or last processor processor.}}
\DoxyCodeLine{111   dim2\_len\_raw = dim2\_len -\/ overlap}
\DoxyCodeLine{112 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{113   \textcolor{comment}{! Middle processor.}}
\DoxyCodeLine{114   dim2\_len\_raw = dim2\_len -\/ 2 * overlap}
\DoxyCodeLine{115 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{116 }
\DoxyCodeLine{117 \textcolor{keyword}{CALL }mpi\_allreduce(dim2\_len\_raw, dim2\_len\_total, 1, mpi\_integer, mpi\_sum, \&}
\DoxyCodeLine{118 \& mpi\_comm\_world, ierror)}
\DoxyCodeLine{119 }
\DoxyCodeLine{120 \textcolor{comment}{! Calculate dim2\_len for each sub-\/grid, to avoid communication between processors.}}
\DoxyCodeLine{121   \textcolor{comment}{! Divide dim2\_len\_total as evenly as possible.}}
\DoxyCodeLine{122 dim2\_len\_raw = dim2\_len\_total/proc\_count}
\DoxyCodeLine{123   \textcolor{comment}{! Now check if sub-\/grid of a given processor needs to take additional dim2\_len,}}
\DoxyCodeLine{124   \textcolor{comment}{! i.e., dim2\_len\_total \% proc\_count != 0.}}
\DoxyCodeLine{125 \textcolor{keywordflow}{DO} i = 1, proc\_count}
\DoxyCodeLine{126   \textcolor{keywordflow}{IF} ((i-\/1) .LT. modulo(dim2\_len\_total, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{127     dim2\_len\_list(i) = dim2\_len\_raw + 1}
\DoxyCodeLine{128     \textcolor{comment}{! The indexing is weird here since processors start at index 0 but arrays}}
\DoxyCodeLine{129     \textcolor{comment}{! start at index 1. Thus, entry ii of this corresponds to processor (i-\/1).}}
\DoxyCodeLine{130   \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{131     dim2\_len\_list(i) = dim2\_len\_raw}
\DoxyCodeLine{132 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{133 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{134 }
\DoxyCodeLine{135 \textcolor{comment}{! Calculate the lesser dim2 grid indices of the sub-\/grid (the global coordinate}}
\DoxyCodeLine{136 \textcolor{comment}{! of the sub-\/grid). All processors besides 0 need 1 more and to subtract the}}
\DoxyCodeLine{137 \textcolor{comment}{! overlap to get the correct index.}}
\DoxyCodeLine{138 dim2\_len\_pre = sum(dim2\_len\_list(1:proc\_id))}
\DoxyCodeLine{139 \textcolor{keywordflow}{IF} (proc\_id .NE. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{140   dim2\_len\_pre = dim2\_len\_pre -\/ overlap}
\DoxyCodeLine{141 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{142 }
\DoxyCodeLine{143 dim2\_ref = dim2\_ref + dim2\_len\_pre * dim2\_spc}
\DoxyCodeLine{144 }

\end{DoxyCode}
\mbox{\Hypertarget{identify__ref__point_8f_a15cadecc3999cf2b1e7b7c95d30590c5}\label{identify__ref__point_8f_a15cadecc3999cf2b1e7b7c95d30590c5}} 
\index{identify\_ref\_point.f@{identify\_ref\_point.f}!serial@{serial}}
\index{serial@{serial}!identify\_ref\_point.f@{identify\_ref\_point.f}}
\doxysubsubsection{\texorpdfstring{serial()}{serial()}}
{\footnotesize\ttfamily subroutine identify\+\_\+ref\+\_\+point\+\_\+ezp\+::serial}


\begin{DoxyCode}{0}
\DoxyCodeLine{61 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{64 }
\DoxyCodeLine{65 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{66 }

\end{DoxyCode}
