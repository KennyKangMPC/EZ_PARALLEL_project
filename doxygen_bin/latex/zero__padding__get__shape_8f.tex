\hypertarget{zero__padding__get__shape_8f}{}\doxysection{C\+:/\+Users/\+Owner/\+Education and Research/\+Graduate School/\+Parallelization Module Project/\+E\+Z\+\_\+\+P\+A\+R\+A\+L\+L\+E\+L\+\_\+project/\+E\+Z\+\_\+\+P\+A\+R\+A\+L\+L\+E\+L/zero\+\_\+padding\+\_\+get\+\_\+shape.f File Reference}
\label{zero__padding__get__shape_8f}\index{C:/Users/Owner/Education and Research/Graduate School/Parallelization Module Project/EZ\_PARALLEL\_project/EZ\_PARALLEL/zero\_padding\_get\_shape.f@{C:/Users/Owner/Education and Research/Graduate School/Parallelization Module Project/EZ\_PARALLEL\_project/EZ\_PARALLEL/zero\_padding\_get\_shape.f}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{zero__padding__get__shape_8f_a756eae3edbe4a05a080a603f80e6641d}{zero\+\_\+padding\+\_\+get\+\_\+shape\+\_\+ezp}} (dim1\+\_\+len, dim2\+\_\+len, overlap, scl\+\_\+dim1\+\_\+len, scl\+\_\+dim2\+\_\+len)
\item 
subroutine \mbox{\hyperlink{zero__padding__get__shape_8f_a7f56303a9168e44712ea7cbad24d25bc}{serial}} (dim1\+\_\+len, dim2\+\_\+len, scl\+\_\+dim1\+\_\+len, scl\+\_\+dim2\+\_\+len)
\item 
subroutine \mbox{\hyperlink{zero__padding__get__shape_8f_ae09c360fc6c9de03a1f3b6a4e3a690de}{parallel}} (dim1\+\_\+len, dim2\+\_\+len, overlap, scl\+\_\+dim1\+\_\+len, scl\+\_\+dim2\+\_\+len, proc\+\_\+id, proc\+\_\+count)
\item 
subroutine \mbox{\hyperlink{zero__padding__get__shape_8f_aa63ce67b0d00e8efbd34a064fee32f03}{error\+\_\+handling}} (proc\+\_\+id)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{zero__padding__get__shape_8f_aa63ce67b0d00e8efbd34a064fee32f03}\label{zero__padding__get__shape_8f_aa63ce67b0d00e8efbd34a064fee32f03}} 
\index{zero\_padding\_get\_shape.f@{zero\_padding\_get\_shape.f}!error\_handling@{error\_handling}}
\index{error\_handling@{error\_handling}!zero\_padding\_get\_shape.f@{zero\_padding\_get\_shape.f}}
\doxysubsubsection{\texorpdfstring{error\_handling()}{error\_handling()}}
{\footnotesize\ttfamily subroutine zero\+\_\+padding\+\_\+get\+\_\+shape\+\_\+ezp\+::error\+\_\+handling (\begin{DoxyParamCaption}\item[{integer}]{proc\+\_\+id }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{158 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{159 }
\DoxyCodeLine{160 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{161 }
\DoxyCodeLine{162 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{163 }
\DoxyCodeLine{164 \textcolor{keywordtype}{INTEGER} :: proc\_id}
\DoxyCodeLine{165 \textcolor{keywordtype}{LOGICAL} :: proc\_err\_flag, \&}
\DoxyCodeLine{166 \& global\_err\_flag}
\DoxyCodeLine{167 }
\DoxyCodeLine{168 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{169 }
\DoxyCodeLine{170 proc\_err\_flag = .false.}
\DoxyCodeLine{171 global\_err\_flag = .false.}
\DoxyCodeLine{172 }
\DoxyCodeLine{173 \textcolor{comment}{! STOP all processors if any encounter an error.}}
\DoxyCodeLine{174 \textcolor{keyword}{CALL }mpi\_allreduce(proc\_err\_flag, global\_err\_flag, 1, mpi\_logical, mpi\_lor, \&}
\DoxyCodeLine{175 \& mpi\_comm\_world, ierror)}
\DoxyCodeLine{176 }
\DoxyCodeLine{177 \textcolor{keywordflow}{IF} (global\_err\_flag) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{178   \textcolor{keyword}{CALL }mpi\_finalize(ierror)}
\DoxyCodeLine{179   stop}
\DoxyCodeLine{180 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{181 }
\DoxyCodeLine{182 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{183 }

\end{DoxyCode}
\mbox{\Hypertarget{zero__padding__get__shape_8f_ae09c360fc6c9de03a1f3b6a4e3a690de}\label{zero__padding__get__shape_8f_ae09c360fc6c9de03a1f3b6a4e3a690de}} 
\index{zero\_padding\_get\_shape.f@{zero\_padding\_get\_shape.f}!parallel@{parallel}}
\index{parallel@{parallel}!zero\_padding\_get\_shape.f@{zero\_padding\_get\_shape.f}}
\doxysubsubsection{\texorpdfstring{parallel()}{parallel()}}
{\footnotesize\ttfamily subroutine zero\+\_\+padding\+\_\+get\+\_\+shape\+\_\+ezp\+::parallel (\begin{DoxyParamCaption}\item[{integer}]{dim1\+\_\+len,  }\item[{integer}]{dim2\+\_\+len,  }\item[{integer}]{overlap,  }\item[{integer}]{scl\+\_\+dim1\+\_\+len,  }\item[{integer}]{scl\+\_\+dim2\+\_\+len,  }\item[{integer}]{proc\+\_\+id,  }\item[{integer}]{proc\+\_\+count }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{97 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{98 }
\DoxyCodeLine{99 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{100 }
\DoxyCodeLine{101 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{102 }
\DoxyCodeLine{103 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{104 \& dim2\_len, \&}
\DoxyCodeLine{105 \& overlap, \&}
\DoxyCodeLine{106 \& scl\_dim1\_len, \&}
\DoxyCodeLine{107 \& scl\_dim2\_len, \&}
\DoxyCodeLine{108 \& dim2\_len\_total, \&}
\DoxyCodeLine{109 \& dim2\_len\_interior, \&}
\DoxyCodeLine{110 \& proc\_id, \&}
\DoxyCodeLine{111 \& proc\_count, \&}
\DoxyCodeLine{112 \& ierror, \&}
\DoxyCodeLine{113 \& i}
\DoxyCodeLine{114 }
\DoxyCodeLine{115 scl\_dim1\_len = (3 * dim1\_len)/2}
\DoxyCodeLine{116 }
\DoxyCodeLine{117 \textcolor{comment}{! Calculate the size of the sub-\/grid without the overlap region.}}
\DoxyCodeLine{118 \textcolor{keywordflow}{IF} (mod(proc\_id, proc\_count-\/1) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{119   dim2\_len\_interior = dim2\_len -\/ overlap}
\DoxyCodeLine{120 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{121   dim2\_len\_interior = dim2\_len -\/ 2 * overlap}
\DoxyCodeLine{122 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{123 }
\DoxyCodeLine{124 \textcolor{keyword}{CALL }mpi\_allreduce(dim2\_len\_interior, dim2\_len\_total, 1, mpi\_integer, mpi\_sum, \&}
\DoxyCodeLine{125   \& mpi\_comm\_world, ierror)}
\DoxyCodeLine{126 dim2\_len\_total = (3 * dim2\_len\_total)/2}
\DoxyCodeLine{127 }
\DoxyCodeLine{128 \textcolor{comment}{! Divide dim2\_len of total grid as evenly as possible.}}
\DoxyCodeLine{129 scl\_dim2\_len = dim2\_len\_total/proc\_count}
\DoxyCodeLine{130   \textcolor{comment}{! Now check if dim1\_slice of a given processor needs to take additional row,}}
\DoxyCodeLine{131   \textcolor{comment}{! i.e., dim2\_len \% proc\_count != 0.}}
\DoxyCodeLine{132 \textcolor{keywordflow}{IF} (proc\_id .LT. modulo(dim2\_len\_total, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{133   scl\_dim2\_len = scl\_dim2\_len + 1}
\DoxyCodeLine{134 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{135 }
\DoxyCodeLine{136 \textcolor{comment}{! Now add overlap.}}
\DoxyCodeLine{137 \textcolor{keywordflow}{IF} (mod(proc\_id, proc\_count-\/1) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{138   scl\_dim2\_len = scl\_dim2\_len + overlap}
\DoxyCodeLine{139 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{140   scl\_dim2\_len = scl\_dim2\_len + 2 * overlap}
\DoxyCodeLine{141 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{142 }

\end{DoxyCode}
\mbox{\Hypertarget{zero__padding__get__shape_8f_a7f56303a9168e44712ea7cbad24d25bc}\label{zero__padding__get__shape_8f_a7f56303a9168e44712ea7cbad24d25bc}} 
\index{zero\_padding\_get\_shape.f@{zero\_padding\_get\_shape.f}!serial@{serial}}
\index{serial@{serial}!zero\_padding\_get\_shape.f@{zero\_padding\_get\_shape.f}}
\doxysubsubsection{\texorpdfstring{serial()}{serial()}}
{\footnotesize\ttfamily subroutine zero\+\_\+padding\+\_\+get\+\_\+shape\+\_\+ezp\+::serial (\begin{DoxyParamCaption}\item[{integer}]{dim1\+\_\+len,  }\item[{integer}]{dim2\+\_\+len,  }\item[{integer}]{scl\+\_\+dim1\+\_\+len,  }\item[{integer}]{scl\+\_\+dim2\+\_\+len }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{61 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{64 }
\DoxyCodeLine{65 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{66 }
\DoxyCodeLine{67 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{68 \& dim2\_len,  \&}
\DoxyCodeLine{69 \& scl\_dim1\_len, \&}
\DoxyCodeLine{70 \& scl\_dim2\_len}
\DoxyCodeLine{71 }
\DoxyCodeLine{72 scl\_dim1\_len = (3 * dim1\_len)/2}
\DoxyCodeLine{73 scl\_dim2\_len = (3 * dim2\_len)/2}
\DoxyCodeLine{74 }

\end{DoxyCode}
\mbox{\Hypertarget{zero__padding__get__shape_8f_a756eae3edbe4a05a080a603f80e6641d}\label{zero__padding__get__shape_8f_a756eae3edbe4a05a080a603f80e6641d}} 
\index{zero\_padding\_get\_shape.f@{zero\_padding\_get\_shape.f}!zero\_padding\_get\_shape\_ezp@{zero\_padding\_get\_shape\_ezp}}
\index{zero\_padding\_get\_shape\_ezp@{zero\_padding\_get\_shape\_ezp}!zero\_padding\_get\_shape.f@{zero\_padding\_get\_shape.f}}
\doxysubsubsection{\texorpdfstring{zero\_padding\_get\_shape\_ezp()}{zero\_padding\_get\_shape\_ezp()}}
{\footnotesize\ttfamily subroutine zero\+\_\+padding\+\_\+get\+\_\+shape\+\_\+ezp (\begin{DoxyParamCaption}\item[{integer}]{dim1\+\_\+len,  }\item[{integer}]{dim2\+\_\+len,  }\item[{integer}]{overlap,  }\item[{integer}]{scl\+\_\+dim1\+\_\+len,  }\item[{integer}]{scl\+\_\+dim2\+\_\+len }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{18 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{25 \& dim2\_len, \&}
\DoxyCodeLine{26 \& overlap, \&}
\DoxyCodeLine{27 \& scl\_dim1\_len, \&}
\DoxyCodeLine{28 \& scl\_dim2\_len, \&}
\DoxyCodeLine{29 \& proc\_id, \&}
\DoxyCodeLine{30 \& proc\_count, \&}
\DoxyCodeLine{31 \& ierror}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{keyword}{CALL }mpi\_comm\_rank(mpi\_comm\_world, proc\_id, ierror)}
\DoxyCodeLine{34 \textcolor{keyword}{CALL }mpi\_comm\_size(mpi\_comm\_world, proc\_count, ierror)}
\DoxyCodeLine{35 }
\DoxyCodeLine{36 \textcolor{comment}{! Check for errors in user input.}}
\DoxyCodeLine{37 \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}(proc\_id)}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 \textcolor{comment}{! Run in serial if there is only one processor.}}
\DoxyCodeLine{40 \textcolor{keywordflow}{IF} (proc\_count .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{41   \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}(dim1\_len, dim2\_len, scl\_dim1\_len, scl\_dim2\_len)}
\DoxyCodeLine{42 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{43   \textcolor{keyword}{CALL }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}(dim1\_len, dim2\_len, overlap, scl\_dim1\_len, scl\_dim2\_len, \&}
\DoxyCodeLine{44   \& proc\_id, proc\_count)}
\DoxyCodeLine{45 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{46 }
\DoxyCodeLine{47 }
\DoxyCodeLine{48 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{49 \textcolor{keyword}{CONTAINS}}
\DoxyCodeLine{50 }
\DoxyCodeLine{51 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{52 \textcolor{comment}{! SERIAL. Handles the execution if there is only one processor.}}
\DoxyCodeLine{53 \textcolor{comment}{!}}
\DoxyCodeLine{54 \textcolor{comment}{! STRUCTURE: Scaled the dim1\_len and dim2\_len by 3/2.}}
\DoxyCodeLine{55 \textcolor{comment}{!}}
\DoxyCodeLine{56 \textcolor{comment}{! VARIABLES: -\/ dim1\_len, dim2\_len: The shape of the matrix (INTEGER).}}
\DoxyCodeLine{57 \textcolor{comment}{! -\/ scl\_dim1\_len, scl\_dim2\_len: The integers that will hold the dimensions}}
\DoxyCodeLine{58 \textcolor{comment}{! of the scaled grid (INTEGER).}}
\DoxyCodeLine{59 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{60 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}(dim1\_len, dim2\_len, scl\_dim1\_len, scl\_dim2\_len)}
\DoxyCodeLine{61 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{64 }
\DoxyCodeLine{65 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{66 }
\DoxyCodeLine{67 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{68 \& dim2\_len,  \&}
\DoxyCodeLine{69 \& scl\_dim1\_len, \&}
\DoxyCodeLine{70 \& scl\_dim2\_len}
\DoxyCodeLine{71 }
\DoxyCodeLine{72 scl\_dim1\_len = (3 * dim1\_len)/2}
\DoxyCodeLine{73 scl\_dim2\_len = (3 * dim2\_len)/2}
\DoxyCodeLine{74 }
\DoxyCodeLine{75 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_ab154587f08cd7f195f626481a7e73fa0}{serial}}}
\DoxyCodeLine{76 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{77 }
\DoxyCodeLine{78 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{79 \textcolor{comment}{! PARALLEL. Handles the execution if there is more than one processor.}}
\DoxyCodeLine{80 \textcolor{comment}{!}}
\DoxyCodeLine{81 \textcolor{comment}{! STRUCTURE: 1) Calculate what the sub-\/grid size would be if we were to divide}}
\DoxyCodeLine{82 \textcolor{comment}{! the scaled grid in the way that we divided the original grid.}}
\DoxyCodeLine{83 \textcolor{comment}{!}}
\DoxyCodeLine{84 \textcolor{comment}{!}}
\DoxyCodeLine{85 \textcolor{comment}{! VARIABLES: -\/ dim1\_len, dim2\_len: The shape of the matrix (INTEGER).}}
\DoxyCodeLine{86 \textcolor{comment}{! -\/ overlap: The overlap required for the numerical scheme (INTEGER).}}
\DoxyCodeLine{87 \textcolor{comment}{! -\/ scl\_dim1\_len, scl\_dim2\_len: The integers that will hold the dimensions}}
\DoxyCodeLine{88 \textcolor{comment}{! of the scaled grid (INTEGER).}}
\DoxyCodeLine{89 \textcolor{comment}{! -\/ proc\_id: Processor ID (INTEGER).}}
\DoxyCodeLine{90 \textcolor{comment}{! -\/ proc\_count: Number of processors (INTEGER).}}
\DoxyCodeLine{91 \textcolor{comment}{! -\/ dim2\_len\_interior: dim2\_len of sub-\/grid not counting the overlapping region}}
\DoxyCodeLine{92 \textcolor{comment}{! (INTEGER).}}
\DoxyCodeLine{93 \textcolor{comment}{! -\/ i: Counting index for DO loops (INTEGER).}}
\DoxyCodeLine{94 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{95 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}(dim1\_len, dim2\_len, overlap, scl\_dim1\_len, scl\_dim2\_len, \&}
\DoxyCodeLine{96 \& proc\_id, proc\_count)}
\DoxyCodeLine{97 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{98 }
\DoxyCodeLine{99 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{100 }
\DoxyCodeLine{101 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{102 }
\DoxyCodeLine{103 \textcolor{keywordtype}{INTEGER} :: dim1\_len, \&}
\DoxyCodeLine{104 \& dim2\_len, \&}
\DoxyCodeLine{105 \& overlap, \&}
\DoxyCodeLine{106 \& scl\_dim1\_len, \&}
\DoxyCodeLine{107 \& scl\_dim2\_len, \&}
\DoxyCodeLine{108 \& dim2\_len\_total, \&}
\DoxyCodeLine{109 \& dim2\_len\_interior, \&}
\DoxyCodeLine{110 \& proc\_id, \&}
\DoxyCodeLine{111 \& proc\_count, \&}
\DoxyCodeLine{112 \& ierror, \&}
\DoxyCodeLine{113 \& i}
\DoxyCodeLine{114 }
\DoxyCodeLine{115 scl\_dim1\_len = (3 * dim1\_len)/2}
\DoxyCodeLine{116 }
\DoxyCodeLine{117 \textcolor{comment}{! Calculate the size of the sub-\/grid without the overlap region.}}
\DoxyCodeLine{118 \textcolor{keywordflow}{IF} (mod(proc\_id, proc\_count-\/1) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{119   dim2\_len\_interior = dim2\_len -\/ overlap}
\DoxyCodeLine{120 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{121   dim2\_len\_interior = dim2\_len -\/ 2 * overlap}
\DoxyCodeLine{122 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{123 }
\DoxyCodeLine{124 \textcolor{keyword}{CALL }mpi\_allreduce(dim2\_len\_interior, dim2\_len\_total, 1, mpi\_integer, mpi\_sum, \&}
\DoxyCodeLine{125   \& mpi\_comm\_world, ierror)}
\DoxyCodeLine{126 dim2\_len\_total = (3 * dim2\_len\_total)/2}
\DoxyCodeLine{127 }
\DoxyCodeLine{128 \textcolor{comment}{! Divide dim2\_len of total grid as evenly as possible.}}
\DoxyCodeLine{129 scl\_dim2\_len = dim2\_len\_total/proc\_count}
\DoxyCodeLine{130   \textcolor{comment}{! Now check if dim1\_slice of a given processor needs to take additional row,}}
\DoxyCodeLine{131   \textcolor{comment}{! i.e., dim2\_len \% proc\_count != 0.}}
\DoxyCodeLine{132 \textcolor{keywordflow}{IF} (proc\_id .LT. modulo(dim2\_len\_total, proc\_count)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{133   scl\_dim2\_len = scl\_dim2\_len + 1}
\DoxyCodeLine{134 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{135 }
\DoxyCodeLine{136 \textcolor{comment}{! Now add overlap.}}
\DoxyCodeLine{137 \textcolor{keywordflow}{IF} (mod(proc\_id, proc\_count-\/1) .EQ. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{138   scl\_dim2\_len = scl\_dim2\_len + overlap}
\DoxyCodeLine{139 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{140   scl\_dim2\_len = scl\_dim2\_len + 2 * overlap}
\DoxyCodeLine{141 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{142 }
\DoxyCodeLine{143 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_a029e5f37aade02d3db47f37ddec68f56}{parallel}}}
\DoxyCodeLine{144 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{145 }
\DoxyCodeLine{146 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{147 \textcolor{comment}{! ERROR\_HANDLING. Checks for input error and other possible complications.}}
\DoxyCodeLine{148 \textcolor{comment}{!}}
\DoxyCodeLine{149 \textcolor{comment}{! ERRORS TO CHECK: N/A. Assume dim\_len are all positive.}}
\DoxyCodeLine{150 \textcolor{comment}{!}}
\DoxyCodeLine{151 \textcolor{comment}{! VARIABLES: -\/ proc\_id: Processor ID (INTEGER).}}
\DoxyCodeLine{152 \textcolor{comment}{! -\/ proc\_err\_flag -\/ Flag is triggered if processor encounters an error}}
\DoxyCodeLine{153 \textcolor{comment}{! (LOGICAL).}}
\DoxyCodeLine{154 \textcolor{comment}{! -\/ global\_err\_flag -\/ Flag is triggered if any processor encouters an error}}
\DoxyCodeLine{155 \textcolor{comment}{! (LOGICAL).}}
\DoxyCodeLine{156 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{157 \textcolor{keyword}{SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}(proc\_id)}
\DoxyCodeLine{158 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{159 }
\DoxyCodeLine{160 \textcolor{keywordtype}{USE }mpi}
\DoxyCodeLine{161 }
\DoxyCodeLine{162 \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{163 }
\DoxyCodeLine{164 \textcolor{keywordtype}{INTEGER} :: proc\_id}
\DoxyCodeLine{165 \textcolor{keywordtype}{LOGICAL} :: proc\_err\_flag, \&}
\DoxyCodeLine{166 \& global\_err\_flag}
\DoxyCodeLine{167 }
\DoxyCodeLine{168 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{169 }
\DoxyCodeLine{170 proc\_err\_flag = .false.}
\DoxyCodeLine{171 global\_err\_flag = .false.}
\DoxyCodeLine{172 }
\DoxyCodeLine{173 \textcolor{comment}{! STOP all processors if any encounter an error.}}
\DoxyCodeLine{174 \textcolor{keyword}{CALL }mpi\_allreduce(proc\_err\_flag, global\_err\_flag, 1, mpi\_logical, mpi\_lor, \&}
\DoxyCodeLine{175 \& mpi\_comm\_world, ierror)}
\DoxyCodeLine{176 }
\DoxyCodeLine{177 \textcolor{keywordflow}{IF} (global\_err\_flag) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{178   \textcolor{keyword}{CALL }mpi\_finalize(ierror)}
\DoxyCodeLine{179   stop}
\DoxyCodeLine{180 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{181 }
\DoxyCodeLine{182 \textcolor{keyword}{CALL }mpi\_barrier(mpi\_comm\_world, ierror)}
\DoxyCodeLine{183 }
\DoxyCodeLine{184 \textcolor{keyword}{END SUBROUTINE }\mbox{\hyperlink{cfft2db_8f_affb0dbcf8f28b8f5eace6c4d749168c7}{error\_handling}}}
\DoxyCodeLine{185 \textcolor{comment}{!\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{186 }

\end{DoxyCode}
